!
      MODULE INTERFACE_TELEMAC3D
!
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!
      USE BIEF_DEF
!
!-----------------------------------------------------------------------
!
!     DEFINITION OF INTERFACES
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE AIRWIK1
     &(LIHBOR,UBORF,VBORF,LIUBOF,LIVBOF,UBORL,VBORL,LIUBOL,LIVBOL,
     & UBORS,VBORS,LIUBOS,LIVBOS,U,V,UD,VD,DELWAQ,
     & U2D,V2D,XNEBOR,YNEBOR,NBOR,
     & UMOY,VMOY,TRA01,TRA02,TRA03,Z,NPTFR,NPLAN,NPOIN2,
     & KENT,KADH,KLOG,KDEB,OPTBAN,KP1BOR)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR, NPLAN, NPOIN2,OPTBAN
      INTEGER, INTENT(IN) :: KENT, KADH, KLOG, KDEB
      INTEGER, INTENT(IN) :: KP1BOR(NPTFR,2)
      INTEGER, INTENT(IN) :: LIUBOF(NPOIN2), LIUBOS(NPOIN2)
      INTEGER, INTENT(IN) :: LIUBOL(NPTFR,NPLAN)
      INTEGER, INTENT(IN) :: LIHBOR(NPTFR)
      INTEGER, INTENT(IN) :: LIVBOF(NPOIN2), LIVBOS(NPOIN2)
      INTEGER, INTENT(IN) :: LIVBOL(NPTFR,NPLAN)
      INTEGER, INTENT(IN) :: NBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN)    :: UBORF(NPOIN2),UBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: UBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: VBORF(NPOIN2),VBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: VBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: Z(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: XNEBOR(NPTFR),YNEBOR(NPTFR)
      DOUBLE PRECISION, INTENT(INOUT) :: U(NPOIN2,NPLAN),V(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: UD(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: VD(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: U2D(NPOIN2),V2D(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: UMOY(NPOIN2),VMOY(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA01(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA02(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA03(NPOIN2,NPLAN)
      LOGICAL, INTENT(IN)             :: DELWAQ
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE AIRWIK2
     &(LIHBOR,UBORF,VBORF,WBORF,LIUBOF,LIVBOF,LIWBOF,UBORL,VBORL,WBORL,
     & LIUBOL,LIVBOL,LIWBOL,
     & UBORS,VBORS,WBORS,LIUBOS,LIVBOS,LIWBOS,U,V,W,XNEBOR,YNEBOR,NBOR,
     & NPTFR,NPLAN,NPOIN2,KENT,KADH,KLOG,KDEB,VELPROLAT)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR, NPLAN, NPOIN2
      INTEGER, INTENT(IN) :: KENT, KADH, KLOG, KDEB
      INTEGER, INTENT(IN) :: LIUBOF(NPOIN2), LIUBOS(NPOIN2)
      INTEGER, INTENT(IN) :: LIUBOL(NPTFR,NPLAN),LIWBOF(NPOIN2)
      INTEGER, INTENT(IN) :: LIHBOR(NPTFR),LIWBOS(NPOIN2)
      INTEGER, INTENT(IN) :: LIVBOF(NPOIN2), LIVBOS(NPOIN2)
      INTEGER, INTENT(IN) :: LIVBOL(NPTFR,NPLAN),LIWBOL(NPTFR,NPLAN)
      INTEGER, INTENT(IN) :: NBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN)    :: UBORF(NPOIN2),UBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: WBORF(NPOIN2),WBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: UBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: WBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: VBORF(NPOIN2), VBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: VBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: XNEBOR(NPTFR),YNEBOR(NPTFR)
      DOUBLE PRECISION, INTENT(INOUT) :: U(NPOIN2,NPLAN),V(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: W(NPOIN2,NPLAN)
      LOGICAL, INTENT(IN)             :: VELPROLAT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE AMR_PLAN
     &(ZVALS,OBJSOL,REFTYPE,NPOIN2,NPLAN,NSEG2,GLOSEG,DIMGLO,
     & Z0,NEWZ,ZEXT,INTSOL,MONITOR,SSMONITOR,SMONITOR,NEXTR,SNNEIGH,
     & NNEIGH,MCOEFF,MESH2D,MESH3D)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER,          INTENT(IN)    :: NPLAN,NPOIN2,NSEG2,DIMGLO
      DOUBLE PRECISION, INTENT(IN)    :: OBJSOL(NPOIN2,NPLAN)
      CHARACTER,        INTENT(IN)    :: REFTYPE
      INTEGER,          INTENT(IN)    :: GLOSEG(DIMGLO,2)
      DOUBLE PRECISION, INTENT(INOUT) :: ZVALS(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: Z0(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: NEWZ(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: ZEXT(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: INTSOL(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: MONITOR(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: SMONITOR(NPOIN2,NPLAN)
      INTEGER,          INTENT(INOUT) :: NEXTR(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: NNEIGH(NPOIN2),MCOEFF(NPOIN2)
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: SNNEIGH,SSMONITOR
      TYPE(BIEF_MESH),  INTENT(INOUT) :: MESH2D,MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE AIRWIK3
     & (LIHBOR,U,V,XNEBOR,YNEBOR,NBOR,NPTFR,NPLAN,NPOIN2,KLOG)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR,NPLAN,NPOIN2,KLOG
      INTEGER, INTENT(IN) :: LIHBOR(NPTFR),NBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN)    :: XNEBOR(NPTFR),YNEBOR(NPTFR)
      DOUBLE PRECISION, INTENT(INOUT) :: U(NPOIN2,NPLAN),V(NPOIN2,NPLAN)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE BIL3D(LT,NIT,IKLBORL,NPTFR,NETAG)
      USE DECLARATIONS_TELEMAC3D, ONLY:NELEBX
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: LT,NIT
      INTEGER, INTENT(IN) :: NPTFR,NETAG
      INTEGER, INTENT(IN) :: IKLBORL(NELEBX,*)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TRID1D(X,AA,BB,CC,DD,GAM,IMAX)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: IMAX
          DOUBLE PRECISION, INTENT(INOUT) :: X(IMAX),DD(IMAX),GAM(IMAX)
          DOUBLE PRECISION, INTENT(INOUT) :: AA(IMAX),BB(IMAX),CC(IMAX)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE BORD3D(NFRLIQ)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER         , INTENT(IN)    :: NFRLIQ
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE BYPASS_CRUSHED_POINTS_EBE
     &(SVOLU,SVOLUN,FLUX,TRA01,MESH3,
     & NELEM2,NELEM3,NELMAX,NPLAN,IKLE)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NELEM3,NELEM2,NPLAN
      INTEGER, INTENT(IN)             :: NELMAX
      INTEGER, INTENT(IN)             :: IKLE(NELMAX,6)
      TYPE(BIEF_OBJ), INTENT(IN)      :: SVOLU,SVOLUN
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: TRA01
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3
      DOUBLE PRECISION, INTENT(INOUT) :: FLUX(30,NELEM3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE BYPASS_CRUSHED_POINTS_SEG
     &(SVOLU,SVOLUN,FLUX,TRA01,MESH3,
     & SCHCF,NPOIN2,GLOSEG,DIMGLO,NSEG,NPLAN)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: SCHCF,NPOIN2
      INTEGER, INTENT(IN)             :: NSEG,NPLAN,DIMGLO
      INTEGER, INTENT(IN)             :: GLOSEG(DIMGLO,2)
      TYPE(BIEF_OBJ), INTENT(IN)      :: SVOLU,SVOLUN
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: TRA01
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3
      DOUBLE PRECISION, INTENT(INOUT) :: FLUX(*)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CALCG(TRAV2,TRAV3,UETCAR,NPOIN2,NPLAN)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER         , INTENT(IN)    :: NPOIN2,NPLAN
          DOUBLE PRECISION, INTENT(IN)    :: UETCAR(NPOIN2)
          DOUBLE PRECISION, INTENT(IN)    :: TRAV2(NPOIN2*NPLAN)
          DOUBLE PRECISION, INTENT(INOUT) :: TRAV3(NPOIN2*NPLAN)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CALCOT(ZZ,HH)
          USE DECLARATIONS_TELEMAC3D
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          DOUBLE PRECISION, INTENT(IN)    :: HH(NPOIN2)
          DOUBLE PRECISION, INTENT(INOUT) :: ZZ(NPOIN2,NPLAN)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CHECK
     &(IKLE2,NBOR,NELBOR,IKLBOR,NELEB,NELEBX,IKLE3,NELBO3,NULONE,
     & DIM1NUL,DIM2NUL,NBOR3,NELEM2,NPTFR,NELEM3,NPTFR3,INFO)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NELEM2,NPTFR,NELEM3
      INTEGER, INTENT(IN) :: NPTFR3,NELEB,NELEBX,DIM1NUL,DIM2NUL
      INTEGER, INTENT(IN) :: NELBOR(NPTFR),NBOR(NPTFR)
      INTEGER, INTENT(IN) :: IKLE2(NELEM2,3)
      INTEGER, INTENT(IN) :: IKLBOR(NELEBX,*),IKLE3(NELEM3,*)
      INTEGER, INTENT(IN) :: NELBO3(NELEBX)
      INTEGER, INTENT(IN) :: NULONE(DIM1NUL,DIM2NUL)
      INTEGER, INTENT(IN) :: NBOR3(NPTFR3)
      LOGICAL, INTENT(IN) :: INFO
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CLSEDI
     &( ATABOF , BTABOF  ,
     &  WC     ,
     &  Z      , HN      , DELTAR ,
     &  TOB    , DENSI   , S3D_EPAI, S3D_CFDEP,
     &  S3D_CONC, S3D_HDEP, S3D_FLUER, S3D_FLUDPT, LITABF ,
     &  KLOG    , NPOIN3 , NPOIN2  , NPLAN  ,
     &  S3D_NCOUCH, DT     , RHO0    ,  S3D_RHOS,
     &  S3D_TOCD, S3D_MPART, S3D_TOCE, UETCAR  , GRAV   ,
     &  S3D_SEDCO, S3D_DMOY, S3D_CREF, ZREF    , CF     ,
     &  S3D_AC , S3D_KSPRATIO, S3D_ICR, S3D_ICQ , RUGOF  ,
     &  S3D_SETDEP, HMIN    , S3D_WCS, S3D_EPAICO, S3D_EPAINCO,
     &  S3D_MIXTE, S3D_SEDNCO, S3D_FLUDPTC, S3D_FLUDPTNC, S3D_FLUERC,
     &  S3D_FLUERNC, NTRAC   , ITRAC)
      USE BIEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN2,NPOIN3,KLOG,S3D_ICQ, ITRAC, NTRAC
      INTEGER, INTENT(IN) :: S3D_NCOUCH,NPLAN,S3D_ICR
      DOUBLE PRECISION, INTENT(INOUT) :: ATABOF(NPOIN2), BTABOF(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)  :: Z(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)  :: S3D_CFDEP
      DOUBLE PRECISION, INTENT(IN)  :: WC(NPOIN3), DELTAR(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)  :: S3D_WCS(*)
      TYPE(BIEF_OBJ), INTENT(INOUT) :: TOB,S3D_CREF,ZREF,RUGOF
      TYPE(BIEF_OBJ), INTENT(IN)    :: S3D_DMOY,HN,CF
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_EPAI(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_EPAICO(*), S3D_EPAINCO(*)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_CONC(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(INOUT) :: DENSI(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: UETCAR(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_HDEP(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUER(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUERC(*), S3D_FLUERNC(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDPT(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDPTC(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDPTNC(*)
      DOUBLE PRECISION, INTENT(IN) :: DT, RHO0, S3D_RHOS, HMIN
      DOUBLE PRECISION, INTENT(IN) :: S3D_TOCD, GRAV
      DOUBLE PRECISION, INTENT(IN) :: S3D_MPART
      DOUBLE PRECISION, INTENT(IN) :: S3D_TOCE(NPOIN2,S3D_NCOUCH)
      INTEGER, INTENT(INOUT)       :: LITABF(NPOIN2)
      LOGICAL, INTENT(IN)          :: S3D_SEDCO, S3D_MIXTE, S3D_SEDNCO
      INTEGER, INTENT(IN)          :: S3D_SETDEP
      DOUBLE PRECISION, INTENT(IN) :: S3D_AC, S3D_KSPRATIO
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE COEF
     &  (S3D_IVIDE, S3D_EPAI, TRA01 ,
     &   S3D_NPFMAX, IMAX , NDEB  ,
     &   S3D_RHOS, GRAV , S3D_DTC, DSIG1    )
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) ::  S3D_NPFMAX, IMAX,NDEB
      DOUBLE PRECISION, INTENT(INOUT) :: TRA01(S3D_NPFMAX,6)
      DOUBLE PRECISION, INTENT(IN) :: S3D_EPAI(S3D_NPFMAX-1)
      DOUBLE PRECISION, INTENT(IN) :: S3D_IVIDE(S3D_NPFMAX)
      DOUBLE PRECISION, INTENT(IN) :: S3D_RHOS, GRAV ,S3D_DTC, DSIG1
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CONDIM
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_MESH_TRANSF
          USE DECLARATIONS_TELEMAC3D
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_CONDI3D_H
          USE BIEF
          USE DECLARATIONS_TELEMAC
          USE DECLARATIONS_TELEMAC3D
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_CONDI3D_UVW
          USE BIEF
          USE DECLARATIONS_TELEMAC3D
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_CONDI3D_TRAC
          USE BIEF
          USE DECLARATIONS_TELEMAC3D
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_CONDI3D_KEP
          USE DECLARATIONS_TELEMAC3D
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_CONDI3D_P
          USE DECLARATIONS_TELEMAC3D
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CONDIS
     &(S3D_IVIDE, S3D_EPAI, S3D_TREST, S3D_CONC, S3D_TEMP  , S3D_HDEP  ,
     & ZR      , ZF    , X     , Y     , NPOIN2    ,
     & NPF     , S3D_NCOUCH, S3D_TASSE, S3D_ITASS, S3D_RHOS  , S3D_XKV ,
     & S3D_CFDEP, S3D_ESOMT, S3D_TOCE, S3D_SEDCO, S3D_CONC_LAYER,
     & S3D_TOCE_LAYER, S3D_ES_LAYER, S3D_SEDNCO, S3D_MIXTE, S3D_EPAICO,
     & S3D_EPAINCO, S3D_PVSCO ,
     & S3D_PVSNCO, S3D_PVSNCO0)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN2,S3D_NCOUCH
      DOUBLE PRECISION, INTENT(OUT)   :: S3D_IVIDE(*), S3D_CFDEP
!
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_EPAI(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_EPAICO(*), S3D_EPAINCO(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_PVSCO(*), S3D_PVSNCO(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_CONC(NPOIN2,S3D_NCOUCH)
!
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_TEMP(*)
!
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_HDEP(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: ZR(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: ZF(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: X(NPOIN2),Y(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_TREST(S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_TOCE(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_CONC_LAYER(S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_ES_LAYER(S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_TOCE_LAYER(S3D_NCOUCH)
      INTEGER, INTENT(INOUT)          :: NPF(NPOIN2)
      TYPE(BIEF_OBJ), INTENT (INOUT)  :: S3D_ESOMT
      LOGICAL, INTENT(IN)             :: S3D_TASSE
      LOGICAL, INTENT(IN)             :: S3D_SEDCO, S3D_SEDNCO
      LOGICAL, INTENT(IN)             :: S3D_MIXTE
      INTEGER, INTENT(IN)             :: S3D_ITASS
      DOUBLE PRECISION, INTENT(IN)    :: S3D_RHOS,S3D_XKV, S3D_PVSNCO0
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE T3D_CORFON
     &(SZF, ST1, ST2, ZF, T1, T2, X, Y, PRIVE, NPOIN2,
     & LISFON, LISFON_AFTER, MSK, MASKEL, MATR2D, MESH2D, S)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN2, LISFON
      LOGICAL, INTENT(IN) :: LISFON_AFTER,MSK
      TYPE (BIEF_OBJ), INTENT(INOUT) :: SZF, ST1, ST2
      DOUBLE PRECISION, DIMENSION(NPOIN2), INTENT(INOUT) :: ZF, T1, T2
      DOUBLE PRECISION, DIMENSION(NPOIN2), INTENT(IN) :: X,Y
      TYPE (BIEF_OBJ),  INTENT(INOUT) :: PRIVE
      TYPE (BIEF_OBJ),  INTENT(IN)    :: MASKEL
      TYPE (BIEF_OBJ),  INTENT(INOUT) :: MATR2D
      TYPE (BIEF_MESH), INTENT(INOUT) :: MESH2D
      TYPE (BIEF_OBJ),  INTENT(IN)    :: S
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CORRECTION_DEPTH_3D(GLOSEG,DIMGLO)
        USE DECLARATIONS_TELEMAC3D
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: DIMGLO
      INTEGER, INTENT(IN)             :: GLOSEG(DIMGLO,2)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CSTKEP
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE CVDF3D
     &(FD,FC,FN,VISCF,SIGMAF,S0F,YAS0F,S1F,YAS1F,
     & FBORL,FBORF,FBORS,AFBORL,AFBORF,AFBORS,
     & BFBORL,BFBORF,BFBORS,LIFBOL,LIFBOF,LIFBOS,
     & FLUXB,FLUXF,FLUEXT,FLUEXTPAR,FMIN,CLIMIN,FMAX,CLIMAX,
     & SCHCF,SCHDF,SLVDIF,TRBAF,INFOR,NEWDIF,CALFLU,
     & T2_01,T2_03,
     & T3_01,T3_02,T3_03,T3_04,MESH3D,IKLE3,MASKEL,MTRA1,
     & NPTFR3,MMURD,MURD_TF,VOLU,VOLUPAR,VOLUN,VOLUNPAR,
     & NBOR3,NPOIN3,NPOIN2,DT,MSK,NELEM3,
     & NPLAN,IELM3,MSUPG,IELM2H,IELM2V,MDIFF,MTRA2,
     & INCHYD,MASKBR,MASKPT,SEM3D,YASEM3D,SVIDE,IT1,
     & TRAV3,MESH2D,OPTBAN,TETADI,
     & YAWCHU,WCHU,S3D_WCHU,AGGLOD,NSCE,SOURCES,FSCE,NUMLIQ,DIRFLU,
     & NFRLIQ,VOLUT,ZT,ZPROP,RAIN,PLUIE,PARAPLUIE,TRAIN,
     & FLODEL,FLOPAR,SIGMAG,IPBOT,MAXADV,FLUDPT,FLUDP,FLUER,
     & VOLU2D,V2DPAR,SETDEP,S3D_FLUDPT,S3D_FLUDP,S3D_FLUER,
     & S3D_SETDEP,OPTSOU,ZN,OPTADV,NCO_DIST,
     & NSP_DIST,TB2)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: FD, FC, FN
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: S1F, VISCF
      TYPE(BIEF_OBJ), TARGET, INTENT(INOUT)   :: S0F
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: LIFBOL, LIFBOF, LIFBOS
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: FBORL, FBORF, FBORS
      TYPE(BIEF_OBJ), INTENT(IN)      :: AFBORL, AFBORF, AFBORS
      TYPE(BIEF_OBJ), INTENT(IN)      :: BFBORL, BFBORF, BFBORS
      TYPE(BIEF_OBJ), INTENT(IN)      :: FLUEXT,PLUIE,PARAPLUIE
      TYPE(BIEF_OBJ), INTENT(IN)      :: FLUEXTPAR
      DOUBLE PRECISION, INTENT(IN)    :: SIGMAF,FMIN,FMAX,DT,TRAIN
      DOUBLE PRECISION, INTENT(IN)    :: AGGLOD
      DOUBLE PRECISION, INTENT(INOUT) :: FLUXB(*)
      DOUBLE PRECISION, INTENT(INOUT) :: FLUXF,TETADI
      INTEGER, INTENT(IN)             :: SCHCF,SCHDF,TRBAF,NPTFR3,NFRLIQ
      INTEGER, INTENT(IN)             :: NUMLIQ(*),DIRFLU(0:NFRLIQ)
      INTEGER, INTENT(IN)             :: OPTSOU,OPTADV,NCO_DIST,NSP_DIST
      LOGICAL, INTENT(IN)             :: CLIMIN,CLIMAX,RAIN,YAS0F,YAS1F
      LOGICAL, INTENT(IN)             :: INFOR,NEWDIF,CALFLU,MSK,SIGMAG
      TYPE(SLVCFG)                    :: SLVDIF
      TYPE(BIEF_OBJ), INTENT(IN)      :: MASKEL,IKLE3,FLODEL,FLOPAR
      TYPE(BIEF_OBJ), INTENT(IN)      :: NBOR3,WCHU,SOURCES,ZPROP
      TYPE(BIEF_OBJ), INTENT(IN)      :: S3D_WCHU
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: T3_01,T3_02,T3_03,T3_04
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: T2_01,T2_03,ZT,TB2
      TYPE(BIEF_OBJ), TARGET, INTENT(INOUT) :: VOLUT
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3D
      INTEGER, INTENT(IN)             :: NPOIN3,NPOIN2,MAXADV
      INTEGER, INTENT(IN)             :: IPBOT(NPOIN2)
      INTEGER, INTENT(IN)             :: NPLAN,NELEM3
      INTEGER, INTENT(IN)             :: OPTBAN
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: MMURD,MURD_TF,MTRA1
      TYPE(BIEF_OBJ), INTENT(IN)      :: VOLUN,VOLUNPAR,VOLUPAR
      TYPE(BIEF_OBJ), TARGET, INTENT(INOUT) :: VOLU
      LOGICAL, INTENT(IN)             :: INCHYD,YASEM3D
      LOGICAL, INTENT(INOUT)          :: YAWCHU
      TYPE(BIEF_OBJ), INTENT(IN)      :: MASKPT,MASKBR,SVIDE
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH2D
      INTEGER, INTENT(IN)             :: IELM3,IELM2H,IELM2V,NSCE
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: SEM3D,IT1,TRAV3,MTRA2
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: MSUPG,MDIFF
      DOUBLE PRECISION, INTENT(IN)    :: FSCE(NSCE)
      TYPE(BIEF_OBJ), INTENT(IN)      :: VOLU2D,V2DPAR
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: S3D_FLUDPT,S3D_FLUDP,S3D_FLUER
      INTEGER, INTENT(IN)             :: S3D_SETDEP
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: FLUDPT,FLUDP,FLUER
      INTEGER, INTENT(IN)             :: SETDEP
      DOUBLE PRECISION, INTENT(IN)    :: ZN(NPOIN3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DEBIMP3D
     &(Q,UBOR,VBOR,WBOR,U,V,H,NUMLIQ,IFRLIQ,
     & T3_01,T3_02,T3_03,
     & NPTFR,NETAGE,MASK,MESH,FORMUL,NPOIN2,
     & IELM2V,SIGMAG,SVIDE,MASKBR,ZPROP)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR,NETAGE,NPOIN2,IFRLIQ
      INTEGER, INTENT(IN) :: NUMLIQ(NPTFR)
      DOUBLE PRECISION, INTENT(INOUT) :: UBOR(*),VBOR(*),WBOR(*)
      DOUBLE PRECISION, INTENT(IN) :: MASK(*)
      DOUBLE PRECISION, INTENT(IN) :: Q
      CHARACTER(LEN=16) FORMUL
      INTEGER, INTENT(IN) :: IELM2V
      LOGICAL, INTENT(IN) :: SIGMAG
      TYPE(BIEF_MESH) :: MESH
      TYPE(BIEF_OBJ), INTENT(INOUT) :: MASKBR
      TYPE(BIEF_OBJ) , INTENT(INOUT):: H,U,V
      TYPE(BIEF_OBJ) , INTENT(INOUT):: T3_01,T3_02,T3_03
      TYPE(BIEF_OBJ) , INTENT(INOUT) :: ZPROP
      TYPE(BIEF_OBJ) , INTENT(INOUT) :: SVIDE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DEBIMP_3D
     &(Q,UBOR,VBOR,U,V,NUMLIQ,NUMLIQ_ELM,IFRLIQ,T3_02,
     & NPTFR,NETAGE,MASK,MESH,FORMUL,IELM2V,SVIDE,MASKBR,NELEB)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR,NETAGE,IFRLIQ,NELEB
      INTEGER, INTENT(IN) :: NUMLIQ(NPTFR),NUMLIQ_ELM(NELEB)
      DOUBLE PRECISION, INTENT(INOUT) :: UBOR(*),VBOR(*)
      DOUBLE PRECISION, INTENT(IN) :: Q
      CHARACTER(LEN=16) FORMUL
      INTEGER, INTENT(IN)            :: IELM2V
      TYPE(BIEF_MESH)                :: MESH
      TYPE(BIEF_OBJ), INTENT(IN)     :: MASK
      TYPE(BIEF_OBJ), INTENT(INOUT)  :: MASKBR
      TYPE(BIEF_OBJ) , INTENT(INOUT) :: U,V
      TYPE(BIEF_OBJ) , INTENT(INOUT) :: T3_02
      TYPE(BIEF_OBJ) , INTENT(INOUT) :: SVIDE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DESSED
     & (NPF,S3D_IVIDE,S3D_EPAI,S3D_HDEP,S3D_TEMP,ZR,NPOIN2,
     &  S3D_NPFMAX,S3D_NCOUCH, GRAPRD,LT,S3D_DTC,S3D_TASSE,
     &  S3D_GIBSON,NRSED,TITCAS,S3D_BIRSED,GRADEB)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)          :: NPOIN2, S3D_NPFMAX, NRSED
      INTEGER, INTENT(IN)          :: LT, S3D_NCOUCH
      INTEGER, INTENT(IN)          :: GRAPRD, GRADEB
      INTEGER, INTENT(IN)          :: NPF(NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: S3D_EPAI((S3D_NPFMAX-1)*NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: S3D_IVIDE(S3D_NPFMAX*NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: S3D_HDEP(NPOIN2), ZR(NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: S3D_TEMP(S3D_NCOUCH*NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: S3D_DTC
      LOGICAL, INTENT(IN)          :: S3D_TASSE,S3D_GIBSON
      CHARACTER(LEN=72), INTENT(IN):: TITCAS
      CHARACTER(LEN=3), INTENT(IN) :: S3D_BIRSED
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DIAG_MURD
     &(DIAG,XM,NELEM,NELMAX,NPOIN3,IKLE,IELM3,DIM1X)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NELEM,NELMAX,NPOIN3,IELM3,DIM1X
      INTEGER, INTENT(IN) :: IKLE(NELMAX,*)
      DOUBLE PRECISION, INTENT(INOUT) :: DIAG(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: XM(DIM1X,NELMAX)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DIFF3D
     &(FD,FC,FN,VISCF,SIGMAF,S0F,YAS0F,S1F,YAS1F,
     & FBORL,FBORF,FBORS,AFBORL,AFBORF,AFBORS,
     & BFBORL,BFBORF,BFBORS,LIFBOF,LIFBOL,LIFBOS,
     & FMIN,CLIMIN,FMAX,CLIMAX,SCHCF,SCHDF,SLVDIF,TRBAF,INFO,
     & NEWDIF,DT,T2_01,T2_03,T3_01,T3_02,T3_03,T3_04,
     & NPOIN2,NPOIN3,INCHYD,SEM3D,YASEM3D,IT1,NPTFR3,NBOR3,MASKPT,
     & TRAV3,MESH2D,MESH3D,MTRA1,MTRA2,IELM3,MSUPG,IELM2H,IELM2V,
     & MDIFF,MASKBR,SVIDE,MSK,MASKEL,
     & NPLAN,OPTBAN,TETADI,YAWCHU,WCHU,S3D_WCHU,AGGLOD,VOLU,
     & YASCE,NSCE,FSCE,SOURCES,TETASUPG,RAIN,PLUIE,TRAIN,
     & SIGMAG,IPBOT,S3D_SETDEP,OPTSOU,SETDEP)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: SCHCF,SCHDF,TRBAF,NSCE
      INTEGER, INTENT(IN)             :: NPOIN2,S3D_SETDEP,OPTSOU
      INTEGER, INTENT(IN)             :: SETDEP
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: FD,FC,FN,S0F,S1F,VISCF
      TYPE(BIEF_OBJ), INTENT(IN)      :: LIFBOL,LIFBOF,LIFBOS
      TYPE(BIEF_OBJ), INTENT(IN)      :: FBORL,FBORF,FBORS
      TYPE(BIEF_OBJ), INTENT(IN)      :: AFBORL,AFBORF,AFBORS
      TYPE(BIEF_OBJ), INTENT(IN)      :: BFBORL,BFBORF,BFBORS,WCHU
      TYPE(BIEF_OBJ), INTENT(IN)      :: S3D_WCHU
      DOUBLE PRECISION, INTENT(IN)    :: SIGMAF,FMIN,FMAX,DT,AGGLOD
      DOUBLE PRECISION, INTENT(IN)    :: FSCE(NSCE),TETASUPG
      DOUBLE PRECISION, INTENT(INOUT) :: TETADI
      LOGICAL, INTENT(IN)             :: CLIMIN,CLIMAX,YASCE,YAS0F
      LOGICAL, INTENT(IN)             :: INFO,NEWDIF,YASEM3D,YAS1F
      LOGICAL, INTENT(IN)             :: SIGMAG
      TYPE(SLVCFG)                    :: SLVDIF
      LOGICAL, INTENT(IN)             :: INCHYD,MSK,YAWCHU,RAIN
      TYPE(BIEF_OBJ), INTENT(IN)      :: MASKPT,MASKBR,MASKEL,VOLU
      TYPE(BIEF_OBJ), INTENT(IN)      :: NBOR3,SVIDE,SOURCES
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: T3_01,T3_02,T3_03,T3_04
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: T2_01,T2_03
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3D,MESH2D
      INTEGER, INTENT(IN)             :: NPOIN3,IELM3,IELM2H,IELM2V
      INTEGER, INTENT(IN)             :: NPTFR3,NPLAN,OPTBAN
      INTEGER, INTENT(IN)             :: IPBOT(NPOIN2)
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: SEM3D,IT1,TRAV3,MTRA1,MTRA2
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: MSUPG,MDIFF
      DOUBLE PRECISION, INTENT(IN)    :: PLUIE(*),TRAIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DRIALG(FRV,FRT,RI,NPOIN3)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER         , INTENT(IN)    :: NPOIN3
          DOUBLE PRECISION, INTENT(INOUT) :: FRV(NPOIN3), FRT(NPOIN3)
          DOUBLE PRECISION, INTENT(INOUT) :: RI(NPOIN3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DRICV(FRI,FRT,RI,NPOIN3)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)             :: NPOIN3
          DOUBLE PRECISION, INTENT(INOUT) :: FRI(NPOIN3),FRT(NPOIN3)
          DOUBLE PRECISION, INTENT(IN)    :: RI(NPOIN3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DRIUTI(FRI,RI,ITYP,ITRAC,NPOIN3)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: ITYP, ITRAC, NPOIN3
          DOUBLE PRECISION, INTENT(INOUT) :: FRI(NPOIN3)
          DOUBLE PRECISION, INTENT(INOUT) :: RI(NPOIN3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_DRIUTI(FRI,RI,ITYP,ITRAC,NPOIN3)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: ITYP, ITRAC, NPOIN3
          DOUBLE PRECISION, INTENT(INOUT) :: FRI(NPOIN3)
          DOUBLE PRECISION, INTENT(INOUT) :: RI(NPOIN3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE DRSURR
     &( DELTAR,TA,BETAC,T0AC,RHO,RHO0,XMVS0,S3D_RHOS,DENLAW,S3D_SEDI,
     &  NTRAC,IND_T,IND_S, IND_SED, NSUSP_TEL,S3D_MIXTE,
     &  NUM_ISUSP_ICLA,NSICLA)
        USE BIEF_DEF
        USE DECLARATIONS_SPECIAL
        IMPLICIT NONE
        INTEGER, INTENT(IN)           :: NTRAC, DENLAW,IND_T,IND_S
        INTEGER, INTENT(IN)           :: IND_SED,NSUSP_TEL
        INTEGER, INTENT(IN)           :: NSICLA
        DOUBLE PRECISION, INTENT(IN)  :: RHO0,XMVS0(NSICLA),S3D_RHOS
        DOUBLE PRECISION, INTENT(IN)  :: BETAC(NTRAC),T0AC(NTRAC)
        TYPE(BIEF_OBJ), INTENT(INOUT) :: DELTAR
        TYPE(BIEF_OBJ), INTENT(IN)    :: TA
        TYPE(BIEF_OBJ), INTENT(INOUT) :: RHO
        LOGICAL, INTENT(IN)           :: S3D_SEDI,S3D_MIXTE
        INTEGER, INTENT(IN)           :: NUM_ISUSP_ICLA(NSICLA)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE ERODC
     &( S3D_CONC, S3D_EPAI, S3D_FLUER, TOB    ,
     &  S3D_MPART, DT     , NPOIN2 , S3D_NCOUCH,S3D_TOCE, HN, HMIN,
     &  S3D_MIXTE, S3D_EPAICO)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN2, S3D_NCOUCH
      DOUBLE PRECISION, INTENT(IN)    :: S3D_CONC(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: HN(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_TOCE(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_EPAI(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_EPAICO(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUER(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: TOB(NPOIN2)
      LOGICAL, INTENT(IN)             :: S3D_MIXTE
      DOUBLE PRECISION, INTENT(IN)    :: S3D_MPART, DT, HMIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE ERODNC
     &(S3D_CFDEP, S3D_WCS, S3D_HDEP , S3D_FLUER, TOB   , DT    ,
     & NPOIN2 , NPOIN3 , S3D_AC , S3D_RHOS, RHO0  , HN ,
     & GRAV   , S3D_DMOY, S3D_CREF , ZREF   , S3D_ICQ, RUGOF,
     & Z      , UETCAR , S3D_SETDEP, S3D_EPAINCO, S3D_MIXTE)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN2,NPOIN3,S3D_ICQ
      INTEGER, INTENT(IN)             :: S3D_SETDEP
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_HDEP(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUER(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_EPAINCO(*)
      DOUBLE PRECISION, INTENT(IN)    :: DT,S3D_CFDEP,GRAV,S3D_RHOS,RHO0
      DOUBLE PRECISION, INTENT(IN)    :: S3D_AC
      TYPE(BIEF_OBJ)  , INTENT(IN)    :: S3D_DMOY,TOB,HN
      TYPE(BIEF_OBJ)  , INTENT(INOUT) :: S3D_CREF,ZREF,RUGOF
      DOUBLE PRECISION, INTENT(IN)    :: S3D_WCS(NPOIN3)
      LOGICAL, INTENT(IN)             :: S3D_MIXTE
      DOUBLE PRECISION, INTENT(IN)    :: Z(NPOIN3), UETCAR(NPOIN2)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE EXTMSK(MASKBR,MASK,NETAGE,NELEB)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NETAGE,NELEB
      DOUBLE PRECISION, INTENT(IN)  :: MASK(*)
      TYPE(BIEF_OBJ), INTENT(INOUT) :: MASKBR
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FINDKSCE(NPOIN2,NPLAN,Z,NSCE,ISCE,ZSCE,KSCE,INFO)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)    :: NPOIN2,NPLAN,NSCE
          INTEGER, INTENT(IN)    :: ISCE(NSCE)
          INTEGER, INTENT(INOUT) :: KSCE(NSCE)
          DOUBLE PRECISION, INTENT(IN) :: Z(NPOIN2,NPLAN)
          DOUBLE PRECISION, INTENT(IN) :: ZSCE(NSCE)
          LOGICAL, INTENT(IN) :: INFO
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FLOT3D
     &(XFLOT,YFLOT,ZFLOT,NFLOT,NFLOT_MAX,X,Y,Z,IKLE,NELEM,NELMAX,NPOIN,
     & NPLAN,TAGFLO,CLSFLO,SHPFLO,SHZFLO,ELTFLO,ETAFLO,MESH3D,LT,NIT,AT)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN,NIT,NFLOT_MAX,LT,NPLAN
      INTEGER, INTENT(IN)             :: NELEM,NELMAX
      INTEGER, INTENT(IN)             :: IKLE(NELMAX,*)
      INTEGER, INTENT(INOUT)          :: NFLOT
      INTEGER, INTENT(INOUT)          :: TAGFLO(NFLOT_MAX)
      INTEGER, INTENT(INOUT)          :: CLSFLO(NFLOT_MAX)
      INTEGER, INTENT(INOUT)          :: ELTFLO(NFLOT_MAX)
      INTEGER, INTENT(INOUT)          :: ETAFLO(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(IN)    :: X(NPOIN),Y(NPOIN),Z(NPOIN),AT
      DOUBLE PRECISION, INTENT(INOUT) :: XFLOT(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: YFLOT(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: ZFLOT(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: SHPFLO(3,NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: SHZFLO(NFLOT_MAX)
      TYPE(BIEF_MESH) , INTENT(INOUT) :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_FLOT3D
     &(XFLOT,YFLOT,ZFLOT,NFLOT,NFLOT_MAX,X,Y,Z,IKLE,NELEM,NELMAX,NPOIN,
     & NPLAN,TAGFLO,CLSFLO,SHPFLO,SHZFLO,ELTFLO,ETAFLO,MESH3D,LT,NIT,AT)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN,NIT,NFLOT_MAX,LT,NPLAN
      INTEGER, INTENT(IN)             :: NELEM,NELMAX
      INTEGER, INTENT(IN)             :: IKLE(NELMAX,*)
      INTEGER, INTENT(INOUT)          :: NFLOT
      INTEGER, INTENT(INOUT)          :: TAGFLO(NFLOT_MAX)
      INTEGER, INTENT(INOUT)          :: CLSFLO(NFLOT_MAX)
      INTEGER, INTENT(INOUT)          :: ELTFLO(NFLOT_MAX)
      INTEGER, INTENT(INOUT)          :: ETAFLO(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(IN)    :: X(NPOIN),Y(NPOIN),Z(NPOIN),AT
      DOUBLE PRECISION, INTENT(INOUT) :: XFLOT(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: YFLOT(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: ZFLOT(NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: SHPFLO(3,NFLOT_MAX)
      DOUBLE PRECISION, INTENT(INOUT) :: SHZFLO(NFLOT_MAX)
      TYPE(BIEF_MESH) , INTENT(INOUT) :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FLUSED
     &(ATABOF , BTABOF ,
     & LITABF , WC     ,
     & HN     ,
     & TOB    , S3D_FLUDPT, S3D_FLUER, S3D_TOCD,
     & NPOIN3 , NPOIN2 , NPLAN  , KLOG    ,
     & HMIN   , S3D_SEDCO, S3D_SETDEP, S3D_SEDNCO,
     & S3D_WCS, S3D_MIXTE, S3D_FLUDPTC, S3D_FLUDPTNC)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN3,NPOIN2,NPLAN,KLOG,S3D_SETDEP
      LOGICAL, INTENT(IN) :: S3D_SEDCO, S3D_SEDNCO, S3D_MIXTE
      INTEGER, INTENT(IN) :: LITABF(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: ATABOF(NPOIN2), BTABOF(NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: WC(NPOIN3)
      DOUBLE PRECISION, INTENT(IN) :: HN(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: TOB(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDPT(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUER(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDPTC(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDPTNC(*)
      DOUBLE PRECISION, INTENT(IN) :: S3D_TOCD
      DOUBLE PRECISION, INTENT(IN) :: S3D_WCS(*)
      DOUBLE PRECISION, INTENT(IN) :: HMIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FLUPRI(VEC,XMUL,U,V,W,X,Y,Z,IKLE,
     &                    NELMAX,NELEM2D,NPOIN2,NPOIN3,T1,T2,T3)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NELMAX,NELEM2D,NPOIN2,NPOIN3
      DOUBLE PRECISION, INTENT(INOUT) :: VEC(NPOIN3)
      INTEGER, INTENT(IN) :: IKLE(NELMAX,*)
      DOUBLE PRECISION, INTENT(IN)    :: X(NPOIN3),Y(NPOIN3),Z(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: XMUL
      DOUBLE PRECISION, INTENT(INOUT) :: T1(NELEM2D)
      DOUBLE PRECISION, INTENT(INOUT) :: T2(NELEM2D)
      DOUBLE PRECISION, INTENT(INOUT) :: T3(NELEM2D)
      DOUBLE PRECISION, INTENT(IN) :: U(*),V(*),W(*)
!
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FLUVER_2
     &(FLUVER2,UP,VP,WP,GRADZF,VOLU2D,DSSUDT,NPLAN,NPOIN2)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NPLAN,NPOIN2
      TYPE(BIEF_OBJ), INTENT(INOUT) :: FLUVER2
      TYPE(BIEF_OBJ), INTENT(IN)    :: UP,VP,WP,GRADZF,VOLU2D,DSSUDT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FLUX_COR
     &(FC,FINSUB,FI_I,ZSTART,ZEND,DFDT,XB,DIM1XB,TETA,IKLE3,
     & MESH3,NELEM3,NELMAX,NPOIN3,IELM3,SCHCF)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: SCHCF,NELEM3,NPOIN3
      INTEGER, INTENT(IN)             :: IELM3,DIM1XB,NELMAX
      INTEGER, INTENT(IN)             :: IKLE3(NELMAX,*)
      DOUBLE PRECISION, INTENT(IN)    :: FC(NPOIN3),FINSUB(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: FI_I(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: ZSTART(NPOIN3),ZEND(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: TETA
      DOUBLE PRECISION, INTENT(IN)    :: DFDT(NPOIN3)
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3
      DOUBLE PRECISION, INTENT(INOUT) :: XB(DIM1XB,NELEM3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FLUX_IMP3D
     &(NELEM3,NELMAX,ELTSEG,ORISEG,FXMATPAR,NSEG3,
     & IKLE,NPOIN3,FN,FI_I,SURFAC,DFDT,TETA,ZN,ZP,SUR2VOL)
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NELEM3,NPOIN3,NSEG3
      INTEGER, INTENT(IN)             :: NELMAX
      INTEGER, INTENT(IN)             :: IKLE(NELMAX,6)
      INTEGER, INTENT(IN)             :: ELTSEG(NELMAX,15)
      INTEGER, INTENT(IN)             :: ORISEG(NELMAX,15)
      DOUBLE PRECISION, INTENT(IN)    :: TETA(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FXMATPAR(NSEG3)
      DOUBLE PRECISION, INTENT(INOUT) :: FI_I(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: SURFAC(NELEM3),DFDT(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FN(NPOIN3),ZN(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: ZP(NPOIN3),SUR2VOL(NSEG3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FLUX3D
     &(FLUINT,FLUEXT,FLUEXTPAR,UCONV,VCONV,TRA02,
     & NPLAN,IELM3,IELM2V,SVIDE,MESH3,
     & MSK,MASKEL,MASK_3D,LIHBOR,KENT,NPTFR,DT,VOLU,VOLUN,
     & MESH2,SIGMAG,NPOIN2,NPOIN3,DM1,GRAZCO,
     & FLBOR,PLUIE,RAIN,FLODEL,OPT_HNEG,FLULIM,YACVVF,BYPASS,
     & N_ADV,WEL)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPLAN,NPOIN2,NPOIN3
      INTEGER, INTENT(IN) :: IELM3,IELM2V,OPT_HNEG
      INTEGER, INTENT(IN) :: KENT,NPTFR
      INTEGER, INTENT(IN) :: LIHBOR(NPTFR),N_ADV(0:15)
      TYPE(BIEF_OBJ), INTENT(INOUT) :: FLUINT,FLUEXT,FLUEXTPAR
      TYPE(BIEF_OBJ), INTENT(IN)    :: VOLU,VOLUN,DM1,GRAZCO
      TYPE(BIEF_OBJ), INTENT(IN)    :: UCONV,VCONV,PLUIE,MASK_3D
      TYPE(BIEF_OBJ), INTENT(INOUT) :: MASKEL,WEL
      TYPE(BIEF_OBJ), INTENT(INOUT) :: FLULIM
      TYPE(BIEF_OBJ), INTENT(INOUT), TARGET :: FLODEL
      TYPE(BIEF_OBJ), INTENT(INOUT) :: FLBOR
      TYPE(BIEF_OBJ), INTENT(INOUT) :: SVIDE,TRA02
      TYPE(BIEF_MESH), INTENT(INOUT):: MESH3, MESH2
      DOUBLE PRECISION, INTENT(IN)  :: DT
      LOGICAL, INTENT(IN)           :: MSK,SIGMAG,RAIN,YACVVF,BYPASS
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FONVAS
     &(S3D_EPAI, S3D_CONC, S3D_HDEP,
     & S3D_FLUDP, S3D_FLUDPT, S3D_FLUER, ZF    , TA     ,
     & NPOIN2, NPOIN3 ,
     & S3D_NCOUCH, DT    ,
     & S3D_ZF_S, S3D_ESOMT,
     & VOLU2D  , S3D_MASDEP, S3D_SETDEP, ZR    , TS     , S3D_FLUDPTC,
     & S3D_FLUDPTNC, S3D_FLUERC, S3D_FLUERNC, S3D_MIXTE, S3D_FLUDPC,
     & S3D_FLUDPNC, S3D_PVSCO, S3D_PVSNCO, S3D_CFDEP, S3D_EPAICO,
     & S3D_EPAINCO)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) ::  NPOIN2,NPOIN3
      INTEGER, INTENT(IN) ::  S3D_NCOUCH
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_HDEP(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_EPAI(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_EPAICO(*), S3D_EPAINCO(*)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_CONC(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: ZR(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: ZF(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: TA(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: TS(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_FLUDPT(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_FLUER(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_FLUDPTC(*),S3D_FLUERC(*)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_FLUDPTNC(*)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_FLUERNC(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDP(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_ZF_S(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_FLUDPC(*), S3D_FLUDPNC(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_PVSCO(*), S3D_PVSNCO(*)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_ESOMT(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: DT
      DOUBLE PRECISION, INTENT(IN)    :: S3D_CFDEP
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_MASDEP
      LOGICAL, INTENT(IN) :: S3D_MIXTE
      INTEGER, INTENT(IN) :: S3D_SETDEP
      TYPE(BIEF_OBJ), INTENT(IN) :: VOLU2D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE FSGRAD
     &(GRADZS,ZFLATS,Z,ZF,IELM2H,MESH2D,MSK,MASKEL,UNSV2D,T2_01,
     & NPOIN2,OPTBAN,S)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)                  :: IELM2H,NPOIN2,OPTBAN
      DOUBLE PRECISION, TARGET, INTENT(IN) :: Z(NPOIN2)
      LOGICAL, INTENT(IN)                  :: MSK
      TYPE(BIEF_OBJ), INTENT(INOUT)        :: GRADZS,ZFLATS,T2_01
      TYPE(BIEF_OBJ), INTENT(IN)           :: ZF,UNSV2D,S,MASKEL
      TYPE(BIEF_MESH), INTENT(INOUT)       :: MESH2D
!
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE GRAD2D
     &(DFDX,DFDY,FU,NPLAN,S,UNSV2D,FU2,FU3,FU4,IELM2,MESH2D,MSK,MASKEL)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(INOUT) :: DFDX, DFDY
      TYPE(BIEF_OBJ), INTENT(IN)    :: FU
      TYPE(BIEF_OBJ), INTENT(INOUT) :: UNSV2D,S
      TYPE(BIEF_OBJ), INTENT(IN)    :: MASKEL
      TYPE(BIEF_MESH), INTENT(INOUT):: MESH2D
      INTEGER, INTENT(IN)           :: NPLAN, IELM2
      LOGICAL, INTENT(IN)           :: MSK
!     FU2,3,4 MUST BE 2D WORK FIELD - NO CHECKING
      TYPE(BIEF_OBJ), INTENT(INOUT) :: FU2,FU3,FU4
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE IFAB3D
     &(IFABOR,LIUBOF,LIUBOL,LIUBOS,KP1BOR,NELBOR,NULONE,
     & IKLE2,NELEM2,NELMAX2,NPOIN2,NPTFR,NPLAN,NETAGE,KLOG,TRANSF)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)          :: NELEM2,NPOIN2,NETAGE,NPLAN,TRANSF
      INTEGER, INTENT(IN)          :: NPTFR,NELMAX2
      INTEGER, INTENT(INOUT)       :: IFABOR(NELEM2,5,NETAGE)
      INTEGER, INTENT(IN)          :: LIUBOF(NPOIN2),LIUBOS(NPOIN2)
      INTEGER, INTENT(IN)          :: LIUBOL(NPTFR,NPLAN)
      INTEGER, INTENT(IN)          :: IKLE2(NELMAX2,3)
      INTEGER, INTENT(IN)          :: NULONE(NPTFR,NETAGE,4)
      INTEGER, INTENT(IN)          :: KP1BOR(NPTFR), NELBOR(NPTFR)
      INTEGER, INTENT(IN)          :: KLOG
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE IFAB3DT
     &(IFABOR,LIUBOF,LIUBOS,
     & IKLE2,IKLE,NELEM2,NELMAX2,NELMAX,
     & NPOIN2,NETAGE,KLOG)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)          :: NELEM2,NPOIN2,NETAGE
      INTEGER, INTENT(IN)          :: KLOG,NELMAX,NELMAX2
      INTEGER, INTENT(INOUT)       :: IFABOR(NELMAX,4)
      INTEGER, INTENT(IN)          :: LIUBOF(NPOIN2),LIUBOS(NPOIN2)
      INTEGER, INTENT(IN)          :: IKLE2(NELMAX2,3),IKLE(NELMAX,4)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE IMPSED
     &(S3D_IVIDE, S3D_EPAI, S3D_CONC, S3D_TEMP, S3D_HDEP, PDEPOT,
     & S3D_FLUER, ZR    , ZF    , TA    , WC    , X     ,
     & Y     , NPOIN2, NPOIN3, S3D_NPFMAX, S3D_NCOUCH, NPF   ,
     & LT    , S3D_RHOS, S3D_CFMAX, S3D_CFDEP, S3D_EPAI0,
     & S3D_TASSE, S3D_GIBSON, PRIVE , LISPRD)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: NPOIN2,NPOIN3,S3D_NPFMAX,S3D_NCOUCH,LT
          INTEGER, INTENT(IN) :: LISPRD
          DOUBLE PRECISION, INTENT(IN)  :: S3D_EPAI(S3D_NCOUCH,NPOIN2)
          DOUBLE PRECISION, INTENT(IN)  :: S3D_IVIDE(S3D_NPFMAX,NPOIN2)
          DOUBLE PRECISION, INTENT(IN)  :: S3D_HDEP(NPOIN2)
          DOUBLE PRECISION, INTENT(IN)  :: PDEPOT(NPOIN2)
          DOUBLE PRECISION, INTENT(IN)  :: S3D_FLUER(NPOIN2)
          DOUBLE PRECISION, INTENT(IN)  :: S3D_CONC(S3D_NCOUCH)
          DOUBLE PRECISION, INTENT(IN)  :: S3D_TEMP(*)
          DOUBLE PRECISION, INTENT(IN)  :: ZR(NPOIN2), ZF(NPOIN2)
          DOUBLE PRECISION, INTENT(IN)  :: TA(NPOIN3)
          DOUBLE PRECISION, INTENT(IN)  :: WC(NPOIN3)
          DOUBLE PRECISION, INTENT(IN)  :: X(NPOIN3), Y(NPOIN3)
          TYPE(BIEF_OBJ), INTENT(INOUT) :: PRIVE
          DOUBLE PRECISION, INTENT(IN)  :: S3D_RHOS,S3D_CFMAX,S3D_CFDEP
          DOUBLE PRECISION, INTENT(IN)  :: S3D_EPAI0
          INTEGER, INTENT(IN) :: NPF(NPOIN2)
          LOGICAL, INTENT(IN) :: S3D_TASSE, S3D_GIBSON
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_IMPSED
     &(S3D_IVIDE, S3D_EPAI, S3D_CONC, S3D_TEMP, S3D_HDEP, PDEPOT,
     & S3D_FLUER, ZR    , ZF    , TA    , WC    , X     ,
     & Y     , NPOIN2, NPOIN3, S3D_NPFMAX, S3D_NCOUCH, NPF   ,
     & LT    , S3D_RHOS, S3D_CFMAX, S3D_CFDEP, S3D_EPAI0,
     & S3D_TASSE, S3D_GIBSON, PRIVE, LISPRD)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: NPOIN2,NPOIN3,S3D_NPFMAX,S3D_NCOUCH,LT
          INTEGER, INTENT(IN) :: LISPRD
          DOUBLE PRECISION, INTENT(IN) :: S3D_EPAI(S3D_NCOUCH,NPOIN2)
          DOUBLE PRECISION, INTENT(IN) :: S3D_IVIDE(S3D_NPFMAX,NPOIN2)
          DOUBLE PRECISION, INTENT(IN) :: S3D_HDEP(NPOIN2)
          DOUBLE PRECISION, INTENT(IN) :: PDEPOT(NPOIN2)
          DOUBLE PRECISION, INTENT(IN) :: S3D_FLUER(NPOIN2)
          DOUBLE PRECISION, INTENT(IN) :: S3D_CONC(S3D_NCOUCH)
          DOUBLE PRECISION, INTENT(IN) :: S3D_TEMP(*)
          DOUBLE PRECISION, INTENT(IN) :: ZR(NPOIN2), ZF(NPOIN2)
          DOUBLE PRECISION, INTENT(IN) :: TA(NPOIN3)
          DOUBLE PRECISION, INTENT(IN) :: WC(NPOIN3)
          DOUBLE PRECISION, INTENT(IN) :: X(NPOIN3), Y(NPOIN3)
          TYPE(BIEF_OBJ), INTENT(INOUT) :: PRIVE
          DOUBLE PRECISION, INTENT(IN) :: S3D_RHOS,S3D_CFMAX,S3D_CFDEP
          DOUBLE PRECISION, INTENT(IN) :: S3D_EPAI0
          INTEGER, INTENT(IN) :: NPF(NPOIN2)
          LOGICAL, INTENT(IN) :: S3D_TASSE, S3D_GIBSON
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE KEPCL3
     & (KBORF,EBORF,LIKBOF,LIEBOF,
     &  KBORL,EBORL,LIKBOL,LIEBOL,LIUBOL,
     &  KBORS,EBORS,LIKBOS,LIEBOS,
     &  DISBOR,AK,H,Z,NBOR,NPOIN2,NPLAN,NPTFR,
     &  KARMAN,CMU,
     &  KMIN,EMIN,KENT,KENTU,KSORT,KADH,KLOG,
     &  UETCAR,FICTIF)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR, NPLAN, NPOIN2,KENTU
      INTEGER, INTENT(IN) :: KENT,KSORT,KADH,KLOG
      INTEGER, INTENT(INOUT) :: LIKBOF(NPOIN2), LIKBOS(NPOIN2)
      INTEGER, INTENT(INOUT) :: LIKBOL(NPTFR,NPLAN)
      INTEGER, INTENT(INOUT) :: LIEBOF(NPOIN2), LIEBOS(NPOIN2)
      INTEGER, INTENT(INOUT) :: LIEBOL(NPTFR,NPLAN)
      INTEGER, INTENT(INOUT) :: LIUBOL(NPTFR,NPLAN)
      INTEGER, INTENT(IN) :: NBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN) :: Z(NPOIN2,NPLAN),AK(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: H(NPOIN2) , UETCAR(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: KBORF(NPOIN2), KBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: KBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: EBORF(NPOIN2), EBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: EBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: DISBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN) :: KARMAN
      DOUBLE PRECISION, INTENT(IN) :: CMU
      DOUBLE PRECISION, INTENT(IN) :: KMIN, EMIN
      DOUBLE PRECISION, INTENT(IN) :: FICTIF
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE KEPICL
     & (LIKBOF,LIEBOF,LIUBOF,LIKBOL,LIEBOL,LIUBOL,LIKBOS,LIEBOS,
     &  NPTFR,NPLAN,NPOIN2,KENT,KSORT,KENTU)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)    :: NPTFR, NPLAN, NPOIN2
          INTEGER, INTENT(IN)    :: KENT, KSORT, KENTU
          INTEGER, INTENT(IN)    :: LIUBOF(NPOIN2)
          INTEGER, INTENT(IN)    :: LIUBOL(NPTFR,NPLAN)
          INTEGER, INTENT(INOUT) :: LIKBOF(NPOIN2), LIKBOS(NPOIN2)
          INTEGER, INTENT(INOUT) :: LIKBOL(NPTFR,NPLAN)
          INTEGER, INTENT(INOUT) :: LIEBOF(NPOIN2), LIEBOS(NPOIN2)
          INTEGER, INTENT(INOUT) :: LIEBOL(NPTFR,NPLAN)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE KEPINI
     &(AK,EP,U,V,Z,ZF,NPOIN2,NPLAN,DNUVIH,DNUVIV,KARMAN,CMU,KMIN,EMIN)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: NPOIN2,NPLAN
      DOUBLE PRECISION, INTENT(INOUT):: AK(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT):: EP(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)   :: U(NPOIN2,NPLAN), V(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)   :: Z(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)   :: ZF(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)   :: KARMAN, DNUVIH, DNUVIV
      DOUBLE PRECISION, INTENT(IN)   :: CMU
      DOUBLE PRECISION, INTENT(IN)   :: KMIN, EMIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_KEPINI
     &(AK,EP,U,V,Z,ZF,NPOIN2,NPLAN,DNUVIH,DNUVIV,KARMAN,CMU,KMIN,EMIN)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: NPOIN2,NPLAN
      DOUBLE PRECISION, INTENT(INOUT):: AK(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT):: EP(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)   :: U(NPOIN2,NPLAN), V(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)   :: Z(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)   :: ZF(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)   :: KARMAN, DNUVIH, DNUVIV
      DOUBLE PRECISION, INTENT(IN)   :: CMU
      DOUBLE PRECISION, INTENT(IN)   :: KMIN, EMIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE KOMCL3
     & (KBORF,EBORF,LIKBOF,LIEBOF,LIUBOF,
     &  KBORL,EBORL,LIKBOL,LIEBOL,LIUBOL,
     &  EBORS,LIEBOS,
     &  DISBOR,AK,U,V,H,Z,NBOR,NPOIN2,NPLAN,NPTFR,
     &  KARMAN,BETAS,OMSTAR,
     &  KMIN,EMIN,KENTU,KENT,KADH,KLOG,
     &  UETCAR,UETCAL)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR, NPLAN, NPOIN2
      INTEGER, INTENT(IN) :: KENTU,KENT,KADH,KLOG
      INTEGER, INTENT(INOUT) :: LIKBOF(NPOIN2)
      INTEGER, INTENT(INOUT) :: LIKBOL(NPTFR,NPLAN)
      INTEGER, INTENT(INOUT) :: LIEBOF(NPOIN2), LIEBOS(NPOIN2)
      INTEGER, INTENT(INOUT) :: LIEBOL(NPTFR,NPLAN)
      INTEGER, INTENT(INOUT) :: LIUBOF(NPOIN2)
      INTEGER, INTENT(INOUT) :: LIUBOL(NPTFR,NPLAN)
      INTEGER, INTENT(IN) :: NBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN) :: U(NPOIN2,NPLAN), V(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: Z(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: AK(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: H(NPOIN2),UETCAR(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: KBORF(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: KBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: EBORF(NPOIN2), EBORS(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: EBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: UETCAL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: DISBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN) :: KARMAN
      DOUBLE PRECISION, INTENT(IN) :: BETAS,OMSTAR
      DOUBLE PRECISION, INTENT(IN) :: KMIN, EMIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE LECDON_TELEMAC3D(MOTCAR,FILE_DESC,PATH,NCAR,
     & CAS_FILE,DICO_FILE,GAIA_CAS_FILE,GAIA_DICO_FILE)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      CHARACTER(LEN=PATH_LEN), INTENT(INOUT) :: MOTCAR(MAXKEYWORD)
      CHARACTER(LEN=PATH_LEN), INTENT(INOUT) ::
     &           FILE_DESC(4,MAXKEYWORD)
      CHARACTER(LEN=PATH_LEN), INTENT(IN) :: PATH
      INTEGER, INTENT(IN) :: NCAR
      CHARACTER(LEN=PATH_LEN), INTENT(IN)    :: CAS_FILE
      CHARACTER(LEN=PATH_LEN), INTENT(IN)    :: DICO_FILE
      CHARACTER(LEN=PATH_LEN), OPTIONAL, INTENT(IN)    :: GAIA_CAS_FILE
      CHARACTER(LEN=PATH_LEN), OPTIONAL, INTENT(IN)    :: GAIA_DICO_FILE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE LICHEK(LIMPRP,NPTFR,IKLBOR,NELEB2,NELEBX2)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)    :: NPTFR,NELEB2,NELEBX2
      INTEGER, INTENT(INOUT) :: IKLBOR(NELEBX2,2),LIMPRP(NELEBX2,6)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE LONGMB
     &(LM,Z,HN,NPOIN3,NPOIN2,NPLAN,U,V,X,Y,P1,P2,P3,NTRAC,TA,KARMAN,ZF)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN3, NPOIN2, NPLAN, NTRAC
      DOUBLE PRECISION, INTENT(INOUT) :: LM(NPOIN3) ! POINTER
      DOUBLE PRECISION, INTENT(IN)    :: Z(NPOIN3), HN(NPOIN2),KARMAN
      DOUBLE PRECISION, INTENT(IN)    :: U(NPOIN3), V(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: X(NPOIN3), Y(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: P1(NPOIN3), P2(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: P3(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: TA(NPOIN3),ZF(NPOIN2)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE LONGML
     & (LM2,Z,HN,NPOIN3,NPOIN2,NPLAN,MIXING,KARMAN)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN3,NPOIN2,NPLAN,MIXING
      DOUBLE PRECISION, INTENT(INOUT) :: LM2(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: Z(NPOIN3),HN(NPOIN2),KARMAN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MAKE_ZCONV
     &(ZCONV,GRAZCO,ZFLATS,DH,HN,ZF,TETAZCOMP,TETAH,NELEM2,NELMAX2,
     & OPTBAN,IKLE2,MESH2D)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: NELEM2,OPTBAN,NELMAX2
      INTEGER, INTENT(IN)            :: IKLE2(NELMAX2,3)
      DOUBLE PRECISION, INTENT(IN)   :: TETAH,TETAZCOMP
      TYPE(BIEF_OBJ), INTENT(INOUT)  :: ZCONV,GRAZCO
      TYPE(BIEF_OBJ), INTENT(IN)     :: DH,ZFLATS,HN,ZF
      TYPE(BIEF_MESH), INTENT(INOUT) :: MESH2D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MASK3D
     &(IFABOR3D,MASKEL,MASKPT,MASKBR,
     & X,Y,ZF,ZFE,H,HMIN,AT,LT,ITRA01,NELBO3,
     & NELMA2,NELEM2,NPOIN2,NPTFR,NPLAN,NETAGE,IELM3,MESH2D)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NELEM2, NPOIN2, NETAGE, NPLAN
      INTEGER, INTENT(IN)             :: NELMA2, NPTFR
      INTEGER, INTENT(INOUT)          :: IFABOR3D(NELEM2,5,NETAGE)
      DOUBLE PRECISION, INTENT(INOUT) :: MASKEL(NELEM2,NETAGE)
      DOUBLE PRECISION, INTENT(INOUT) :: MASKBR(NPTFR,NETAGE)
      DOUBLE PRECISION, INTENT(IN)    :: X(NPOIN2), Y(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: ZF(NPOIN2), H(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: ZFE(NELEM2)
      INTEGER, INTENT(IN)             :: NELBO3(NPTFR,NETAGE)
      INTEGER, INTENT(INOUT)          :: ITRA01(NELEM2)
      INTEGER, INTENT(IN)             :: LT, IELM3
      DOUBLE PRECISION, INTENT(IN)    :: HMIN, AT
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH2D
      TYPE(BIEF_OBJ) , INTENT(INOUT)  :: MASKPT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MASS3D(INFO)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          LOGICAL, INTENT(IN) :: INFO
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MASSED
     &(S3D_MASBED,S3D_EPAI,S3D_CONC,TRA02,NPOIN2,
     & S3D_NCOUCH,VOLU2D,
     & S3D_CFDEP,S3D_EPAICO,S3D_EPAINCO,S3D_MIXTE)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN2,S3D_NCOUCH
      DOUBLE PRECISION, INTENT(IN)    :: S3D_CFDEP
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_MASBED
      DOUBLE PRECISION, INTENT(IN)    :: S3D_EPAI(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_EPAICO(*), S3D_EPAINCO(*)
      DOUBLE PRECISION, INTENT(IN)    :: VOLU2D(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: S3D_CONC(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA02(NPOIN2)
      LOGICAL, INTENT(IN)             :: S3D_MIXTE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MESH_PROP
     &(HPROP ,HN,H,PROLIN,HAULIN,TETA,NSOUSI,ZPROP,
     & IPBOT,NPOIN2,NPLAN,OPTBAN,SIGMAG,OPT_HNEG,
     & MESH3D,VOLU3D,VOLU3DPAR,UNSV3D,MASKEL,IELM3)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: NSOUSI,NPOIN2,NPLAN,OPT_HNEG
      INTEGER, INTENT(IN)            :: OPTBAN,IELM3
      LOGICAL, INTENT(IN)            :: PROLIN,SIGMAG
      DOUBLE PRECISION, INTENT(IN)   :: TETA,HAULIN
      TYPE(BIEF_OBJ),   INTENT(IN)   :: HN,H,MASKEL
      TYPE(BIEF_OBJ),   INTENT(INOUT):: IPBOT
      TYPE(BIEF_OBJ),  INTENT(INOUT) :: HPROP,ZPROP,UNSV3D,VOLU3D
      TYPE(BIEF_OBJ),  INTENT(INOUT) :: VOLU3DPAR
      TYPE(BIEF_MESH), INTENT(INOUT) :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MITCL2
     & (H,LIHBOR,NBOR,HBOR,AT,NPOIN2,NPTFR,KENT,KSORT,KADH,KLOG,KDEB)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: KENT,KSORT,KADH,KDEB,KLOG,NPTFR,NPOIN2
      INTEGER, INTENT(IN) :: LIHBOR(NPTFR),NBOR(NPTFR)
      DOUBLE PRECISION, INTENT(INOUT) :: H(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: HBOR(NPTFR),AT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MITTIT(IETAPE,AT,LT)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: IETAPE,LT
          DOUBLE PRECISION, INTENT(IN) :: AT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MUDSTRESS3D
     &(NGEO,FFORMAT,S3D_LAYTOCE,S3D_NCOUCH,MESH)
      USE BIEF
      TYPE(BIEF_MESH), INTENT(IN)   :: MESH
      TYPE(BIEF_OBJ),  INTENT(INOUT):: S3D_LAYTOCE
      INTEGER, INTENT(IN)           :: NGEO
      INTEGER, INTENT(IN)           :: S3D_NCOUCH
      CHARACTER(LEN=8), INTENT(IN)  :: FFORMAT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MURD3D
     &(SFC,FC,FN,VOLU,VOLUN,VOLU2,SVOLU2,B,DB,XB,DIM1XB,
     & TRA01,TRA02,TRA03,STRA01,STRA02,STRA03,IKLE3,MESH2D,MESH3D,
     & NELEM3,NELMAX,NPOIN3,DT,SCHCF,INFOR,CALFLU,FLUXB,FLUX,
     & FLUEXT,S0F,NSCE,ISCE,KSCE,SOURCES,
     & FSCE,RAIN,PLUIE,PARAPLUIE,TRAIN,NPOIN2,MINFC,MAXFC,MASKPT,
     & OPTBAN,FLODEL,FLOPAR,GLOSEG,DIMGLO,NSEG,NPLAN,IELM3,OPTSOU,
     & NPTFR3,NBOR3,FLUEXTPAR,FBORL,ZN,FI_I,ZSTART,ZEND,FINSUB,
     & T2_01,BEDBOU,BEDFLU,OPTADV,NCO_DIST)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: SCHCF,NELEM3,NPOIN3,NPOIN2
      INTEGER, INTENT(IN)             :: IELM3,DIM1XB,OPTSOU,NPTFR3
      INTEGER, INTENT(IN)             :: NELMAX
      INTEGER, INTENT(IN)             :: IKLE3(NELMAX,*),NSCE,OPTBAN
      INTEGER, INTENT(IN)             :: NSEG,NPLAN,DIMGLO,NBOR3(NPTFR3)
      INTEGER, INTENT(IN)             :: GLOSEG(DIMGLO,2)
      INTEGER, INTENT(IN)             :: ISCE(NSCE),KSCE(NSCE)
      INTEGER, INTENT(IN)             :: OPTADV,NCO_DIST
      DOUBLE PRECISION, INTENT(INOUT) :: FC(NPOIN3),FBORL(NPTFR3)
      DOUBLE PRECISION, INTENT(IN)    :: FN(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXT(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXTPAR(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: VOLUN(NPOIN3),VOLU(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FSCE(NSCE),MASKPT(*)
      DOUBLE PRECISION, INTENT(IN)    :: DT,TRAIN
      DOUBLE PRECISION, INTENT(INOUT) :: VOLU2(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA01(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA02(NPOIN3),TRA03(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: FLUX
      DOUBLE PRECISION, INTENT(INOUT) :: FLUXB(*)
      DOUBLE PRECISION, INTENT(INOUT) :: FINSUB(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: ZSTART(NPOIN3),ZEND(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: DB(NPOIN3),XB(DIM1XB,NELEM3)
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: SVOLU2,MINFC,MAXFC,T2_01,B,SFC
      TYPE(BIEF_OBJ),  INTENT(IN)     :: SOURCES,S0F,PLUIE,PARAPLUIE
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: STRA01,STRA02,STRA03,FI_I
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: BEDFLU
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH2D,MESH3D
      DOUBLE PRECISION, INTENT(IN)    :: FLODEL(*),FLOPAR(*)
      DOUBLE PRECISION, INTENT(IN)    :: ZN(NPOIN3)
      LOGICAL, INTENT(IN)             :: INFOR,CALFLU,RAIN,BEDBOU
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MURD3D_LIPS
     &(SFC,FC,FN,VOLU,VOLUN,XB,DIM1XB,
     & FNSUB,TRA02,SFNSUB,STRA02,STRA03,IKLE3,MESH2D,MESH3D,
     & NELEM3,NELMAX,NPOIN3,DT,INFOR,CALFLU,FLUXB,FLUX,FLUEXT,S0F,NSCE,
     & ISCE,KSCE,SOURCES,FSCE,RAIN,PLUIE,TRAIN,NPOIN2,MINFC,MAXFC,
     & GLOSEG,DIMGLO,NSEG,NPLAN,IELM3,OPTSOU,
     & NPTFR3,NBOR3,FLUEXTPAR,FBORL,ZN,FI_I,TRAV10,
     & TETAF_VAR,BEDBOU,BEDFLU,NCO_DIST,NSP_DIST,
     & SLVDIF,ORISEG,MTRA1,ELTSEG,TB2,
     & VNP1MT,DENOM,VOLUN_SUB,VOLU_SUB,ZSUBN,ZSUBP)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NELEM3,NPOIN3,NPOIN2,DIM1XB
      INTEGER, INTENT(IN)             :: IELM3,OPTSOU,NPTFR3,NELMAX
      INTEGER, INTENT(IN)             :: IKLE3(NELMAX,*),NSCE
      INTEGER, INTENT(IN)             :: NSEG,NPLAN,DIMGLO,NBOR3(NPTFR3)
      INTEGER, INTENT(IN)             :: GLOSEG(DIMGLO,2)
      INTEGER, INTENT(IN)             :: ORISEG(NELMAX,15)
      INTEGER, INTENT(IN)             :: ELTSEG(NELMAX,15)
      INTEGER, INTENT(IN)             :: ISCE(NSCE),KSCE(NSCE)
      INTEGER, INTENT(IN)             :: NCO_DIST,NSP_DIST
      DOUBLE PRECISION, INTENT(INOUT) :: FC(NPOIN3),FBORL(NPTFR3)
      DOUBLE PRECISION, INTENT(IN)    :: FN(NPOIN3),PLUIE(*)
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXT(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXTPAR(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: VOLUN(NPOIN3),VOLU(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FSCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)    :: DT,TRAIN
      DOUBLE PRECISION, INTENT(INOUT) :: FNSUB(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA02(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: FLUX
      DOUBLE PRECISION, INTENT(INOUT) :: FLUXB(*)
      DOUBLE PRECISION, INTENT(INOUT) :: TETAF_VAR(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: XB(DIM1XB,NELEM3)
      DOUBLE PRECISION, INTENT(INOUT) :: ZSUBN(NPOIN3),ZSUBP(NPOIN3)
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: TRAV10,TB2
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: MTRA1
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: MINFC,MAXFC,SFC
      TYPE(BIEF_OBJ),  INTENT(IN)     :: SOURCES,S0F
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: SFNSUB,STRA02,STRA03,FI_I
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: BEDFLU,VNP1MT,DENOM
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: VOLUN_SUB,VOLU_SUB
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH2D,MESH3D
      TYPE(SLVCFG), INTENT(IN)        :: SLVDIF
      DOUBLE PRECISION, INTENT(IN)    :: ZN(NPOIN3)
      LOGICAL, INTENT(IN)             :: INFOR,CALFLU,RAIN,BEDBOU
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE MURD3D_POS
     &(FC,FN,VOLU,VOLUN,SVOLUN,VOLU2,SVOLU2,RMASS,
     & TRA01,TRA02,TRA03,STRA01,STRA02,STRA03,MESH2,MESH3,
     & NPOIN3,DT,SCHCF,INFOR,CALFLU,FLUXB,FLUX,FLUEXT,
     & FLUEXTPAR,FBORL,NPTFR3,NBOR3,
     & S0F,NSCE,SOURCES,FSCE,RAIN,PLUIE,TRAIN,NPOIN2,
     & FLOPAR,GLOSEG,DIMGLO,NSEG,NPLAN,
     & T5,FLUX_REMOVED,SAVED_VOLU2,SAVED_F,OPTION,IELM3,NITMAX,OPTSOU)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: SCHCF,NPOIN3,NPOIN2
      INTEGER, INTENT(IN)             :: NSCE,NSEG,NPLAN,DIMGLO
      INTEGER, INTENT(IN)             :: OPTION,IELM3
      INTEGER, INTENT(IN)             :: NITMAX,OPTSOU,NPTFR3
      INTEGER, INTENT(IN)             :: GLOSEG(DIMGLO,2),NBOR3(NPTFR3)
      DOUBLE PRECISION, INTENT(INOUT) :: FC(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FN(NPOIN3),PLUIE(*)
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXT(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXTPAR(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: VOLUN(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: VOLU(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: VOLU2(NPOIN3),FBORL(NPTFR3)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA01(NPOIN3),FLUX
      DOUBLE PRECISION, INTENT(INOUT) :: FLUXB(*)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA02(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA03(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: DT,TRAIN,FSCE(NSCE)
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: SVOLU2
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: FLUX_REMOVED
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: SAVED_VOLU2,SAVED_F,T5
      TYPE(BIEF_OBJ), INTENT(IN)      :: SOURCES,S0F,SVOLUN
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: STRA01,STRA02,STRA03
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH2,MESH3
      DOUBLE PRECISION, INTENT(IN)    :: FLOPAR(*)
      DOUBLE PRECISION, INTENT(INOUT) :: RMASS(*)
      LOGICAL, INTENT(IN)             :: INFOR,CALFLU,RAIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE NOMVAR_2D_IN_3D
     &(TEXTE,TEXTPR,MNEMO,NTRAC,MAXTRA,NAMETRAC,
     & N_NAMES_PRIV2D,NAMES_PRIVE2D)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NTRAC,N_NAMES_PRIV2D,MAXTRA
      CHARACTER(LEN=32), INTENT(INOUT) :: TEXTE(*),TEXTPR(*)
      CHARACTER(LEN=8) , INTENT(INOUT) :: MNEMO(*)
      CHARACTER(LEN=32), INTENT(IN)    :: NAMETRAC(MAXTRA)
      CHARACTER(LEN=32), INTENT(IN)    :: NAMES_PRIVE2D(4)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE NOMVAR_TELEMAC3D(TEXT3,TEXTP3,MNEMO,NTRAC,MAXTRA,
     &                              NAMETRAC)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
      INTEGER, INTENT(IN) :: NTRAC,MAXTRA
!                        100 = MAXVAR IN DECLARATIONS_TELEMAC3D
      CHARACTER(LEN=32), INTENT(INOUT) :: TEXT3(100),TEXTP3(100)
      CHARACTER(LEN=32), INTENT(IN)    :: NAMETRAC(MAXTRA)
      CHARACTER(LEN=8), INTENT(INOUT)  :: MNEMO(100)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE NUMLIQ_3D
     &(NUMLIQ,NUMLIQ_ELM,NPLAN,NPTFR2,IKLBOR,NELEB,NELEBX)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NPTFR2,NPLAN,NELEB,NELEBX
      INTEGER, INTENT(IN)           :: IKLBOR(NELEBX,2)
      INTEGER, INTENT(INOUT)        :: NUMLIQ(NPTFR2*NPLAN)
      TYPE(BIEF_OBJ), INTENT(INOUT) :: NUMLIQ_ELM
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE NUWAVE_P0
     &(NUWAVE,DM1,Z,DZ,IKLE,NPOIN2,NPLAN,NELEM,NELMAX,NELEM2,XMUL,IELM3,
     & X,Y,SURFAC)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER,          INTENT(IN)    :: NPOIN2,NPLAN,NELEM,NELMAX
      INTEGER,          INTENT(IN)    :: NELEM2,IELM3
      INTEGER,          INTENT(IN)    :: IKLE(NELMAX,*)
      DOUBLE PRECISION, INTENT(INOUT) :: NUWAVE(NELEM2),DZ(NPOIN2*NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: DM1(NPOIN2*NPLAN),XMUL
      DOUBLE PRECISION, INTENT(IN)    :: Z(NPOIN2*NPLAN),X(*),Y(*)
      DOUBLE PRECISION, INTENT(IN)    :: SURFAC(NELEM2)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE PHSTAT
     &   (PH, DELTAR, Z, TRA01, TRA02, RHO0, GRAV,
     &    NPOIN3, NPOIN2, NPLAN )
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN3, NPOIN2, NPLAN
      DOUBLE PRECISION, INTENT(INOUT) :: PH(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: DELTAR(NPOIN3), Z(NPOIN3)
      DOUBLE PRECISION,INTENT(INOUT)  :: TRA01(NPOIN3), TRA02(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: RHO0, GRAV
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE PLANE_BOTTOM(IPBOT,Z,NPOIN2,NPLAN,SIGMAG,OPTBAN)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)          :: NPOIN2,NPLAN,OPTBAN
      INTEGER, INTENT(INOUT)       :: IPBOT(NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: Z(NPOIN2,NPLAN)
      LOGICAL, INTENT(IN)          :: SIGMAG
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE PREADV(W,WS,ZPROP,ISOUSI,LT,VOLU,VOLUN)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(INOUT)         :: WS,ZPROP
      TYPE(BIEF_OBJ), INTENT(IN)            :: VOLU,VOLUN
      TYPE(BIEF_OBJ), INTENT(INOUT), TARGET :: W
      INTEGER, INTENT(IN) :: ISOUSI,LT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE PREDIV(PD,UP,VP,WP,INFO,BC,OPT,DIRSUR,DIRBOT,DIRLAT)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)             :: OPT
          TYPE(BIEF_OBJ), INTENT(INOUT)   :: PD
          TYPE(BIEF_OBJ), INTENT(IN)      :: UP,VP,WP
          LOGICAL, INTENT(IN)             :: INFO,BC
          LOGICAL, INTENT(IN)             :: DIRSUR,DIRBOT,DIRLAT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE PREPARE_ADVECTION(FN,S0F,FBORL,LIFBOL,FLUXF,
     &  SCHCF,CALFLU,MESH3D,MASKEL,NPTFR3,VOLUNPAR,FLUEXT,FLUEXTPAR,
     &  NBOR3,DT,MSK,IELM3,NUMLIQ,DIRFLU,NFRLIQ)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: FN,S0F,LIFBOL,FBORL
      TYPE(BIEF_OBJ), INTENT(IN)      :: FLUEXT,FLUEXTPAR
      DOUBLE PRECISION, INTENT(IN)    :: DT
      DOUBLE PRECISION, INTENT(INOUT) :: FLUXF
      INTEGER, INTENT(IN)             :: SCHCF,NPTFR3,NFRLIQ,IELM3
      INTEGER, INTENT(IN)             :: NUMLIQ(*),DIRFLU(0:NFRLIQ)
      LOGICAL, INTENT(IN)             :: CALFLU,MSK
      TYPE(BIEF_OBJ), INTENT(IN)      :: MASKEL,NBOR3,VOLUNPAR
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE PRERES_TELEMAC3D()
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE PRERES_TELEMAC3D_KHIONE()
          USE BIEF
          USE DECLARATIONS_KHIONE
          USE DECLARATIONS_TELEMAC3D, ONLY:TA,Z,OPTBAN,T3_01,T3_02,
     & T3_03,NPOIN2,NPLAN,LT
          IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_PRERES_TELEMAC3D(LEO)
          IMPLICIT NONE
          LOGICAL, INTENT(IN) :: LEO
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION Q3( I , AT , INFOGR )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER          , INTENT(IN) :: I
          DOUBLE PRECISION , INTENT(IN) :: AT
          LOGICAL          , INTENT(IN) :: INFOGR
        END FUNCTION
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_Q3( Q3, I , AT , INFOGR )
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      DOUBLE PRECISION , INTENT(INOUT) :: Q3
      INTEGER          , INTENT(IN)    :: I
      DOUBLE PRECISION , INTENT(IN)    :: AT
      LOGICAL          , INTENT(IN)    :: INFOGR
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE RHS_PRESSURE
     &(DIVU,UP,VP,WP,IELM3,DM1,ZCONV,SVIDE,MESH3D,MSK,MASKEL,FLUEXT,
     & NSCE,RAIN,PLUIE,SOURCES,GRADZF,VOLU2D,DSSUDT,NPOIN2,NPOIN3,NPLAN,
     & OPTSOU)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER,         INTENT(IN)    :: IELM3,NSCE,NPOIN2,NPOIN3,NPLAN
      INTEGER,         INTENT(IN)    :: OPTSOU
      LOGICAL,         INTENT(IN)    :: MSK,RAIN
      TYPE(BIEF_OBJ),  INTENT(INOUT) :: DIVU
      TYPE(BIEF_OBJ),  INTENT(IN)    :: UP,VP,WP,PLUIE,SOURCES,GRADZF
      TYPE(BIEF_OBJ),  INTENT(IN)    :: DM1,ZCONV,SVIDE,MASKEL,FLUEXT
      TYPE(BIEF_OBJ),  INTENT(IN)    :: VOLU2D,DSSUDT
      TYPE(BIEF_MESH), INTENT(INOUT) :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SACL3
     &(NUBORF,LINUBOF,
     & NUBORL,LINUBOL,LIUBOL,
     & H,Z,NBOR,NPOIN2,NPLAN,NPTFR,
     & KARMAN,UETCAR,
     & NUMIN,KENT,KENTU,KSORT,KADH,KLOG,FICTIF)
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR, NPLAN, NPOIN2,KENTU
      INTEGER, INTENT(IN) :: KENT,KSORT,KADH,KLOG
      INTEGER, INTENT(INOUT) :: LINUBOF(NPOIN2)
      INTEGER, INTENT(INOUT) :: LINUBOL(NPTFR,NPLAN)
      INTEGER, INTENT(INOUT) :: LIUBOL(NPTFR,NPLAN)
      INTEGER, INTENT(IN) :: NBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN) :: Z(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: H(NPOIN2) ,UETCAR(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: NUBORF(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: NUBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: NUMIN, KARMAN, FICTIF
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SAINI
     &(NU,U,V,W,Z,NPOIN2,NPLAN,KARMAN,NUMIN,
     & UETCAR,H,KFROT,ITURB,STRAIN,MSK,MASKEL,S,MESH3D)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      LOGICAL, INTENT(IN)            :: MSK
      INTEGER, INTENT(IN)            :: NPOIN2,NPLAN,KFROT,ITURB
      DOUBLE PRECISION, INTENT(INOUT):: NU(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)   :: Z(NPOIN2,NPLAN),H(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)   :: UETCAR(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)   :: KARMAN
      DOUBLE PRECISION, INTENT(IN)   :: NUMIN
      TYPE(BIEF_OBJ)  , INTENT(IN   ):: S,MASKEL,U,V,W
      TYPE(BIEF_OBJ)  , INTENT(INOUT):: STRAIN
      TYPE (BIEF_MESH), INTENT(INOUT) :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SED3D
     &(S3D_MASBED, S3D_MASBED0, S3D_MASDEP,S3D_EPAI,
     & S3D_CONC,TRA02,
     & NPOIN2,S3D_NCOUCH,
     & AT,VOLU2D,
     & S3D_CFDEP,S3D_EPAICO,S3D_EPAINCO,S3D_MIXTE)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: S3D_NCOUCH,NPOIN2
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_MASBED,S3D_MASDEP
      DOUBLE PRECISION, INTENT(IN) :: VOLU2D(NPOIN2)
      DOUBLE PRECISION, INTENT(IN) :: S3D_EPAI(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(IN) :: S3D_EPAICO(*), S3D_EPAINCO(*)
      DOUBLE PRECISION, INTENT(IN) :: S3D_CONC(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA02(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: AT,S3D_CFDEP
      DOUBLE PRECISION, INTENT(IN)    :: S3D_MASBED0
      LOGICAL, INTENT(IN)             :: S3D_MIXTE
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SET_DIF
     &(FC,VOLU2D,Z,NPOIN2,NPOIN3,DT,FLUX,
     & NPLAN,WCHU,FLUDPT,FLUDP,FLUER,IPBOT,VISCTA)
!
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN3,NPOIN2
      INTEGER, INTENT(IN)             :: NPLAN
      INTEGER, INTENT(IN)             :: IPBOT(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: FC(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: FLUX
      DOUBLE PRECISION, INTENT(IN)    :: DT,Z(NPOIN3)
      TYPE(BIEF_OBJ), INTENT(IN)      :: WCHU,FLUDPT,VOLU2D
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: FLUDP,FLUER
      TYPE(BIEF_OBJ), INTENT(IN)      :: VISCTA
!
        END SUBROUTINE
      END INTERFACE
!-----------------------------------------------------------------------
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SED_FALL
     &(FC,FN,WCC,MESH3D,DT,VOLU,NPOIN2,NPOIN3,NPLAN,T1)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER         , INTENT(IN)    :: NPOIN2,NPOIN3,NPLAN
      DOUBLE PRECISION, INTENT(IN)    :: DT
      TYPE(BIEF_OBJ)  , INTENT(IN)    :: FN,WCC,VOLU
      TYPE(BIEF_OBJ)  , INTENT(INOUT) :: FC,T1
      TYPE(BIEF_MESH) , INTENT(INOUT) :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION SL3( I , AT , N , INFOGR )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER          , INTENT(IN) :: I,N
          DOUBLE PRECISION , INTENT(IN) :: AT
          LOGICAL          , INTENT(IN) :: INFOGR
        END FUNCTION
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SMAGO3D
     &(U,V,W,TRAV1,TRAV2,TRAV3,TRAV4,TRAV5,TRAV6,
     & SVIDE,MESH3,IELM3,MSK,MASKEL)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: IELM3
      LOGICAL, INTENT(IN)            :: MSK
      TYPE (BIEF_OBJ), INTENT(IN)    :: U, V, W
      TYPE (BIEF_OBJ), INTENT(INOUT) :: TRAV1, TRAV2, TRAV3, TRAV4,TRAV6
      TYPE (BIEF_OBJ), INTENT(INOUT) :: TRAV5
      TYPE (BIEF_OBJ), INTENT(IN)    :: MASKEL
      TYPE (BIEF_OBJ), INTENT(INOUT) :: SVIDE
      TYPE (BIEF_MESH)               :: MESH3
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SMAGO(U,V,T1,T2,T3,T4,NUSMAG,MESH3,IELM3,MSK,MASKEL)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)            :: IELM3
          LOGICAL, INTENT(IN)            :: MSK
          TYPE (BIEF_OBJ), INTENT(IN)    :: U, V
          TYPE (BIEF_OBJ), INTENT(INOUT) :: T1,T2,T3,T4
          TYPE (BIEF_OBJ), INTENT(INOUT) :: NUSMAG
          TYPE (BIEF_OBJ), INTENT(IN)    :: MASKEL
          TYPE (BIEF_MESH), INTENT(INOUT):: MESH3
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SOUKEP
     &(CV1,CV2,S1K,S1E,U,V,W,DELTAR,RI,
     & DUDX,DUDY,DUDZ,DVDX,DVDY,DVDZ,DWDX,DWDY,DWDZ,DTADZ,
     & AK,EP,C1,C2,CMU,GRAV,NPOIN3,MSK,MASKEL,MESH3D,IELM3,S,
     & VENT,WINDX,WINDY,NPOIN2,KMIN,PRANDTL)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN3,IELM3,NPOIN2
      DOUBLE PRECISION, INTENT(INOUT) :: CV1(NPOIN3),CV2(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: S1K(NPOIN3),S1E(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: AK(NPOIN3),EP(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: RI(NPOIN3)
      TYPE (BIEF_OBJ), INTENT(INOUT), TARGET :: DUDX,DUDY,DUDZ
      TYPE (BIEF_OBJ), INTENT(INOUT), TARGET :: DVDX,DVDY,DVDZ
      TYPE (BIEF_OBJ), INTENT(INOUT), TARGET :: DWDX,DWDY,DWDZ,DTADZ
      TYPE (BIEF_OBJ), INTENT(IN)     :: MASKEL,U,V,W,DELTAR,S
      TYPE (BIEF_OBJ), INTENT(IN)     :: WINDX,WINDY
      DOUBLE PRECISION, INTENT(IN)    :: C1,C2,CMU,GRAV,KMIN
      DOUBLE PRECISION, INTENT(IN)    :: PRANDTL
      LOGICAL, INTENT(IN)             :: MSK,VENT
      TYPE (BIEF_MESH), INTENT(INOUT) :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SOUKOM(CV1,CV2,S1K,S1E,U,V,W,DELTAR,
     & DUDX,DUDY,DUDZ,DVDX,DVDY,DVDZ,DWDX,DWDY,DWDZ,DTADZ,
     & DKDX,DKDY,DKDZ,DODX,DODY,DODZ,ROTAT,
     & AK,EP,ALPHA,BETA,BETAS,GRAV,TR,NPOIN3,MSK,MASKEL,MESH3D,IELM3,S,
     & PRANDTL)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NPOIN3,IELM3
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: CV1,CV2,S1K,S1E
      TYPE(BIEF_OBJ), INTENT(IN)      :: AK,EP
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: ROTAT
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: DUDX,DUDY,DUDZ
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: DVDX,DVDY,DVDZ
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: DWDX,DWDY,DWDZ
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: DKDX,DKDY,DKDZ
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: DODX,DODY,DODZ
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: DTADZ,TR
      TYPE(BIEF_OBJ), INTENT(IN)      :: MASKEL,U,V,W,DELTAR,S
      DOUBLE PRECISION, INTENT(IN)    :: GRAV,ALPHA,BETA,BETAS,PRANDTL
      LOGICAL, INTENT(IN)             :: MSK
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SOULSBYFLOC3D
     &(WCHU, FC, MESH3, NPOIN2, NPOIN3, NPLAN, HN, UETCAR)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(INOUT) :: WCHU
      TYPE(BIEF_MESH), INTENT(INOUT):: MESH3
      TYPE(BIEF_OBJ), INTENT(IN)    :: HN
      INTEGER, INTENT(IN)           :: NPOIN2,NPOIN3,NPLAN
      DOUBLE PRECISION, INTENT(IN)  :: UETCAR(NPOIN2),FC(NPOIN3)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SOURCE
     & (S0U,S0V,S0W,S1U,S1V,S1W,
     &  UN3,VN3,WSN3,WN3,
     &  VOLU,VOLUN,T3,NPOIN3,NTRAC,LT,AT,DT,PRIVE,NONHYD,
     &  NPOIN2,NSCE,ISCE,KSCE,QSCE,USCE,VSCE,MAXSCE)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NPOIN3, NTRAC, LT, MAXSCE
      TYPE(BIEF_OBJ), INTENT(IN)    :: UN3, VN3, WSN3, WN3
      TYPE(BIEF_OBJ), INTENT(INOUT) :: S0U,S0V,S1U,S1V,S0W,S1W
      TYPE(BIEF_OBJ), INTENT(INOUT) :: T3
      TYPE(BIEF_OBJ), INTENT(IN)    :: VOLU, VOLUN,PRIVE
      DOUBLE PRECISION, INTENT(IN)  :: AT,DT
      LOGICAL, INTENT(IN)           :: NONHYD
      INTEGER, INTENT(IN)           :: NPOIN2
      INTEGER, INTENT(IN)           :: NSCE
      INTEGER, INTENT(IN)           :: ISCE(NSCE)
      INTEGER, INTENT(IN)           :: KSCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)  :: QSCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)  :: USCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)  :: VSCE(NSCE)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_SOURCE
     & (S0U,S0V,S0W,S1U,S1V,S1W,
     &  UN3,VN3,WSN3,WN3,
     &  VOLU,VOLUN,T3,NPOIN3,NTRAC,LT,AT,DT,PRIVE,NONHYD,
     &  NPOIN2,NSCE,ISCE,KSCE,QSCE,USCE,VSCE,MAXSCE)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NPOIN3, NTRAC, LT, MAXSCE
      TYPE(BIEF_OBJ), INTENT(IN)    :: UN3, VN3, WSN3, WN3
      TYPE(BIEF_OBJ), INTENT(INOUT) :: S0U,S0V,S1U,S1V,S0W,S1W
      TYPE(BIEF_OBJ), INTENT(INOUT) :: T3
      TYPE(BIEF_OBJ), INTENT(IN)    :: VOLU,VOLUN,PRIVE
      DOUBLE PRECISION, INTENT(IN)  :: AT,DT
      LOGICAL, INTENT(IN)           :: NONHYD
      INTEGER, INTENT(IN)           :: NPOIN2
      INTEGER, INTENT(IN)           :: NSCE
      INTEGER, INTENT(IN)           :: ISCE(NSCE)
      INTEGER, INTENT(IN)           :: KSCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)  :: QSCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)  :: USCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)  :: VSCE(NSCE)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SOURCE_TRAC()
      IMPLICIT NONE
      END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SOUSA(S0NU,S1NU,U,V,W,ROTAN,STRAIN,TRNU,
     & NU,NPOIN3,MSK,MASKEL,MESH3D,IELM3,S,WDIST,
     &       NPOIN2,ITURB)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN3,IELM3,NPOIN2,ITURB
      DOUBLE PRECISION, INTENT(INOUT) :: S0NU(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: S1NU(NPOIN3)
      TYPE (BIEF_OBJ), INTENT(INOUT) :: NU,ROTAN,STRAIN,TRNU
      TYPE (BIEF_OBJ), INTENT(IN)    :: MASKEL,U,V,W,S
      TYPE (BIEF_OBJ), INTENT(IN)    :: WDIST
      LOGICAL, INTENT(IN)             :: MSK
      TYPE (BIEF_MESH), INTENT(INOUT) :: MESH3D
      END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SUISED
     &(S3D_EPAI,S3D_HDEP,ZR,ZF,T2,NPOIN2,S3D_NCOUCH,S3D_ITASS,
     & NSUIS,FFORMAT)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: T2
      INTEGER, INTENT(IN)             :: NPOIN2,S3D_NCOUCH
      INTEGER, INTENT(IN)             :: S3D_ITASS, NSUIS
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_EPAI(NPOIN2,S3D_NCOUCH)
      DOUBLE PRECISION, INTENT(OUT)   :: ZR(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: ZF(NPOIN2)
      DOUBLE PRECISION, INTENT(INOUT) :: S3D_HDEP(NPOIN2)
      CHARACTER(LEN=8), INTENT(IN)  :: FFORMAT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE SUMVER(FINT,F,NPLAN,NPTFR)
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: NPLAN,NPTFR
          DOUBLE PRECISION, INTENT(INOUT) :: FINT(NPTFR)
          DOUBLE PRECISION, INTENT(IN)    :: F(NPTFR,NPLAN)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TBORD
     & (AUBORL,
     &  RUGOL,DISBOR,NELBOR,NULONE,IKLE,NELMAX2,
     &  U,V,W,NBOR,NPOIN2,NPLAN,NPTFR,
     &  DNUVIH,DNUVIV,KARMAN,LISRUL,KFROTL,
     &  UETCAL,NONHYD,UTANG,MESH2D)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPTFR,NPLAN,NPOIN2,NELMAX2
      INTEGER, INTENT(IN) :: LISRUL,KFROTL
      INTEGER, INTENT(IN) :: NBOR(NPTFR),NELBOR(NPTFR),NULONE(NPTFR)
      INTEGER, INTENT(IN) :: IKLE(NELMAX2,3)
      DOUBLE PRECISION, INTENT(IN) :: U(NPOIN2,NPLAN),V(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: W(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: UETCAL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: AUBORL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: UTANG(NPTFR)
      DOUBLE PRECISION, INTENT(IN) :: DISBOR(NPTFR)
      DOUBLE PRECISION, INTENT(IN) :: RUGOL(NPTFR,NPLAN)
      DOUBLE PRECISION, INTENT(IN) :: DNUVIH, DNUVIV, KARMAN
      LOGICAL, INTENT(IN) :: NONHYD
      TYPE(BIEF_MESH), INTENT(INOUT) :: MESH2D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TFOND
     &(AUBOR,CF,U2D,V2D,U3D,V3D,W3D,KARMAN,LISRUG,PROPNU,Z,NPOIN,KFROT,
     & RUGOF,UETCAR,NONHYD,OPTBAN,HN,GRAV,IPBOT,NPLAN)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: LISRUG,NPOIN,KFROT,OPTBAN,NPLAN
      INTEGER, INTENT(IN) :: IPBOT(NPOIN)
      DOUBLE PRECISION, INTENT(IN)    :: KARMAN,PROPNU,GRAV
      DOUBLE PRECISION, INTENT(INOUT) :: AUBOR(NPOIN),UETCAR(NPOIN)
      DOUBLE PRECISION, INTENT(IN)    :: HN(NPOIN)
      DOUBLE PRECISION, INTENT(IN) :: CF(*),U2D(*),V2D(*)
      DOUBLE PRECISION, INTENT(IN) :: RUGOF(*),U3D(*),V3D(*),W3D(*),Z(*)
      LOGICAL, INTENT(IN) :: NONHYD
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE THOMPS_BC(OPTION)
        USE DECLARATIONS_SPECIAL
        IMPLICIT NONE
        INTEGER, INTENT(IN) :: OPTION
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TRANSF_ZCHAR(TRANSF,ZCHAR,ZSTAR,TRANSF_PLANE,NPLAN)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NPLAN,TRANSF
      TYPE(BIEF_OBJ), INTENT(INOUT) :: ZCHAR,TRANSF_PLANE
      TYPE(BIEF_OBJ), INTENT(IN)    :: ZSTAR
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION TR3( I , ITRAC , N , AT , INFOGR )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)          :: I,ITRAC,N
          DOUBLE PRECISION, INTENT(IN) :: AT
          LOGICAL, INTENT(IN)          :: INFOGR
        END FUNCTION
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_TR3( TR3, I , ITRAC , N , AT , INFOGR )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          DOUBLE PRECISION, INTENT(INOUT) :: TR3
          INTEGER, INTENT(IN)          :: I,ITRAC,N
          DOUBLE PRECISION, INTENT(IN) :: AT
          LOGICAL, INTENT(IN)          :: INFOGR
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION TRA_PROF_Z
     &                          (I,IPOIN2,IPLAN,IOPT,ITRAC)
        USE DECLARATIONS_SPECIAL
        IMPLICIT NONE
        INTEGER          , INTENT(IN) :: I,IPOIN2,IPLAN,IOPT
        INTEGER          , INTENT(IN) :: ITRAC
        END FUNCTION
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_TRA_PROF_Z
     &          (TRA_PROF_Z,I,IPOIN2,IPLAN,IOPT,ITRAC)
        USE DECLARATIONS_SPECIAL
        IMPLICIT NONE
        DOUBLE PRECISION, INTENT(INOUT) :: TRA_PROF_Z
        INTEGER          , INTENT(IN) :: I,IPOIN2,IPLAN,IOPT
        INTEGER          , INTENT(IN) :: ITRAC
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TRIDW2
     &(WSCONV,VOLU,VOLUN,SEM2D,FLUINT,FLUEXT,SOURCES,NSCE,NETAGE,NPOIN2,
     & DT,UNSV2D,MESH2D,OPTSOU)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NSCE,NETAGE,NPOIN2,OPTSOU
      DOUBLE PRECISION, INTENT(IN)  :: DT
      TYPE(BIEF_OBJ), INTENT(INOUT) :: WSCONV,SEM2D
      TYPE(BIEF_OBJ), INTENT(IN)    :: VOLU,VOLUN,FLUINT,FLUEXT
      TYPE(BIEF_OBJ), INTENT(IN)    :: SOURCES,UNSV2D
      TYPE(BIEF_MESH), INTENT(INOUT):: MESH2D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TRIDW3
     &(WSCONV,FLUVER,SUMFLU,ERROR,PRESSURE,COR_INT,COR_VER,
     & VOLU,VOLUN,U,UCONV,VCONV,WCONV,DT,NPOIN3,
     & SIGMAG,OPTBAN,MESH3D,MTRA1,MASKEL,NPOIN2,T2_01,NPLAN,
     & FLUEXT,NSCE,SOURCES,RAIN,PLUIE,FLUINT,NETAGE,UNSV2D,SVIDE,
     & NELEM2,MSK,N_ADV,VOLU2D,INFOGR,DSSUDT,IELM3,DM1,
     & GRAZCO,MESH2D,SEM3D,NELEM3,GRADZF,OPTSOU)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NPOIN2,NPOIN3,IELM3,NELEM3,NETAGE
      INTEGER, INTENT(IN)           :: NPLAN,NSCE,OPTBAN,N_ADV(0:15)
      INTEGER, INTENT(IN)           :: NELEM2,OPTSOU
      LOGICAL, INTENT(IN)           :: RAIN,MSK,INFOGR,SIGMAG
      DOUBLE PRECISION, INTENT(IN)  :: DT
      TYPE(BIEF_OBJ), INTENT(INOUT) :: WSCONV,FLUVER,SUMFLU,ERROR
      TYPE(BIEF_OBJ), INTENT(INOUT) :: PRESSURE,MTRA1,SEM3D,UCONV,FLUINT
      TYPE(BIEF_OBJ), INTENT(IN)    :: U,VCONV,WCONV,MASKEL
      TYPE(BIEF_OBJ), INTENT(INOUT) :: COR_INT,COR_VER,T2_01
      TYPE(BIEF_OBJ), INTENT(IN)    :: VOLU,VOLUN,FLUEXT,SOURCES,DSSUDT
      TYPE(BIEF_OBJ), INTENT(IN)    :: DM1,GRAZCO,GRADZF,PLUIE
      TYPE(BIEF_OBJ), INTENT(IN)    :: UNSV2D,VOLU2D,SVIDE
      TYPE(BIEF_MESH), INTENT(INOUT):: MESH2D,MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TRISOU
     & (CV1, CV2, SCV1, SCV2, UN3, VN3, X, Y, Z, ZS,
     &  DELTAR,MESH3,FCOR,CORIOL,NTRAC,AT,SURFAC,
     &  T1,ST1, W1, W2, W3, GRAV, NPOIN3, NELEM3, NPOIN2,
     &  NELEM2, NPLAN, NETAGE, IKLE3, LV, MSK, MASKEL, INCHYD,
     &  SVOLU,SVIDE,IELM3,SMASKEL,NREJEU,ISCE,KSCE,QSCE,USCE,VSCE,
     &  GRADZSX,GRADZSY,MESH2D, ST2,T2,ST3,T3,
     &  LONGIT, YASEM3D,SCHCVI,DENLAW,FXH,FYH,
     &  COUROU,NPTH,T3D_FILES,T3DBI1)
      USE BIEF_DEF
      USE DECLARATIONS_TELEMAC
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN3,NELEM3,NPOIN2,NELEM2
      INTEGER, INTENT(IN) :: NPLAN,NETAGE,NTRAC,NPTH,T3DBI1
      INTEGER, INTENT(IN) :: LV,NREJEU,IELM3,SCHCVI,DENLAW
      INTEGER, INTENT(IN) :: IKLE3(NELEM3,*)
      DOUBLE PRECISION, INTENT(IN)    :: MASKEL(*)
      DOUBLE PRECISION, INTENT(IN)    :: LONGIT
      DOUBLE PRECISION, INTENT(INOUT) :: CV1(NPOIN3),CV2(NPOIN3)
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: SCV1,SCV2,FXH,FYH
      DOUBLE PRECISION, INTENT(IN)    :: UN3(NPOIN3), VN3(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: SURFAC(NELEM2)
      DOUBLE PRECISION, INTENT(IN)    :: X(NPOIN3), Y(NPOIN3), Z(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: ZS(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: W1(NELEM3,*), W2(NELEM3,*)
      DOUBLE PRECISION, INTENT(INOUT) :: W3(NELEM3,*)
      DOUBLE PRECISION, INTENT(INOUT) :: T1(NPOIN3)
      DOUBLE PRECISION, INTENT(INOUT) :: T2(NPOIN3), T3(NPOIN3)
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: ST1, ST2, ST3
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: DELTAR
      TYPE(BIEF_MESH),  INTENT(INOUT) :: MESH3
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: GRADZSX
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: GRADZSY
      TYPE(BIEF_MESH),  INTENT(INOUT) :: MESH2D
      TYPE(BIEF_OBJ),   INTENT(IN)    :: SMASKEL
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: SVIDE
      TYPE(BIEF_OBJ),   INTENT(INOUT) :: SVOLU
      INTEGER, INTENT(IN) :: ISCE(*),KSCE(*)
      DOUBLE PRECISION, INTENT(IN) :: QSCE(*),USCE(*),VSCE(*)
      DOUBLE PRECISION, INTENT(IN) :: GRAV, AT, FCOR
      LOGICAL, INTENT(IN) :: CORIOL, MSK, INCHYD,COUROU
      LOGICAL, INTENT(INOUT) :: YASEM3D
      TYPE(BIEF_FILE), INTENT(IN) :: T3D_FILES(*)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TVF_IMP_3D
     &(F,FC,FXMAT,FXMATPAR,DT,VOLUNP1MT,NSEG3,NPOIN3,FLUEXT,FLUEXTPAR,
     & NPTFR3,NBOR3,SIZGLO,GLOSEG,
     & TETAF,PSIEXP,FBOR,MESH3D,ICOR,NCOR,PREDICTOR,CORRECTOR,
     & INFOGT,SF,SM,AM2,SLVPSI,BB,RAIN,TRAIN,
     & PLUIE,NPOIN2,OPTSOU,NSCE,ISCE,KSCE,FSCE,SOURCES)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)             :: NSEG3,NPOIN3,NPTFR3,NPOIN2
      INTEGER, INTENT(IN)             :: SIZGLO,OPTSOU,NSCE
      INTEGER, INTENT(IN)             :: ICOR,NCOR
      INTEGER, INTENT(IN)             :: GLOSEG(SIZGLO,2),NBOR3(NPTFR3)
      INTEGER, INTENT(IN)             :: ISCE(NSCE),KSCE(NSCE)
      DOUBLE PRECISION, INTENT(IN)    :: VOLUNP1MT(NPOIN3),DT,TRAIN
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXT(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FLUEXTPAR(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: TETAF(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)    :: FXMAT(NSEG3),FXMATPAR(NSEG3)
      DOUBLE PRECISION, INTENT(IN)    :: PSIEXP(NPOIN3),FBOR(NPTFR3)
      DOUBLE PRECISION, INTENT(IN)    :: FC(NPOIN3),PLUIE(*)
      DOUBLE PRECISION, INTENT(IN)    :: FSCE(NSCE)
      DOUBLE PRECISION, INTENT(INOUT) :: F(NPOIN3)
      LOGICAL, INTENT(IN)             :: PREDICTOR,CORRECTOR,INFOGT,RAIN
      TYPE(BIEF_OBJ),  INTENT(INOUT)  :: SF,SM,AM2,BB
      TYPE(BIEF_OBJ),  INTENT(IN)     :: SOURCES
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH3D
      TYPE(SLVCFG),    INTENT(INOUT)  :: SLVPSI
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION T3D_DEBSCE( TIME , I , DISCE )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          DOUBLE PRECISION, INTENT(IN) :: TIME,DISCE(*)
          INTEGER         , INTENT(IN) :: I
        END FUNCTION
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_T3D_DEBSCE( T3D_DEBSCE, TIME , I , DISCE )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          DOUBLE PRECISION, INTENT(INOUT) :: T3D_DEBSCE
          DOUBLE PRECISION, INTENT(IN) :: TIME,DISCE(*)
          INTEGER         , INTENT(IN) :: I
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION T3D_TRSCE( TIME , I , ITRAC )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          DOUBLE PRECISION, INTENT(IN) :: TIME
          INTEGER         , INTENT(IN) :: I,ITRAC
        END FUNCTION
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_T3D_TRSCE( T3D_TRSCE, TIME , I , ITRAC )
          IMPLICIT NONE
          DOUBLE PRECISION, INTENT(INOUT) :: T3D_TRSCE
          DOUBLE PRECISION, INTENT(IN) :: TIME
          INTEGER         , INTENT(IN) :: I,ITRAC
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE T3D_STRESS
     &(SEM3D,OP,T2,T3,BFBORL,BFBORF,BFBORS,NPOIN2,NPOIN3,MESH2D,
     & MESH3D,IELM2H,IELM2V,SV,MSK,MASKBR,MASKEL,IPBOT,SIGMAG,
     & OPTBAN,NPLAN)
      USE BIEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(IN)      :: BFBORL,BFBORF,BFBORS
      TYPE(BIEF_OBJ), INTENT(IN)      :: MASKBR,MASKEL,SV
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: T3,T2
      TYPE(BIEF_MESH), INTENT(INOUT)  :: MESH2D,MESH3D
      INTEGER, INTENT(IN)             :: NPOIN2,NPOIN3,OPTBAN
      INTEGER, INTENT(IN)             :: IELM2H,IELM2V,NPLAN
      INTEGER, INTENT(IN)             :: IPBOT(NPOIN2)
      TYPE(BIEF_OBJ), INTENT(INOUT)   :: SEM3D
      LOGICAL, INTENT(IN)             :: MSK,SIGMAG
      CHARACTER(LEN=8), INTENT(IN)    :: OP
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE UPWIND(M,WCC,DELTA,MESH2D,MESH3D,NPLAN)
        USE BIEF_DEF
        USE DECLARATIONS_SPECIAL
        IMPLICIT NONE
        TYPE(BIEF_OBJ), INTENT(INOUT)  :: M
        TYPE(BIEF_OBJ), INTENT(IN)     :: WCC
        DOUBLE PRECISION, INTENT(IN)   :: DELTA
        TYPE(BIEF_MESH), INTENT(IN)    :: MESH3D,MESH2D
        INTEGER, INTENT(IN)            :: NPLAN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE UPWINDEBE
     &    (D,X,IKLE,NELMAX,NELEM2,SURFAC,NPLAN,WCC,EXT,DELTA)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)             :: NELMAX,NELEM2,NPLAN
          INTEGER, INTENT(IN)             :: IKLE(NELMAX,6)
          DOUBLE PRECISION, INTENT(IN   ) :: SURFAC(NELMAX),WCC(*),DELTA
          DOUBLE PRECISION, INTENT(INOUT) :: D(*),X(NELMAX,30)
          CHARACTER(LEN=1), INTENT(IN)    :: EXT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE UPWINDSEG
     &  (D,X,IKLE,NELMAX,NELEM2,SURFAC,NPLAN,WCC,NSEG2D,NSEG3D,
     &   EXT,DELTA)
        USE BIEF_DEF
        USE DECLARATIONS_SPECIAL
        IMPLICIT NONE
        INTEGER, INTENT(IN)             :: NELMAX,NELEM2,NPLAN
        INTEGER, INTENT(IN)             :: IKLE(NELMAX,6),NSEG2D
        INTEGER, INTENT(IN)             :: NSEG3D
        DOUBLE PRECISION, INTENT(IN   ) :: SURFAC(NELMAX),WCC(*),DELTA
        DOUBLE PRECISION, INTENT(INOUT) :: D(*),X(*)
        CHARACTER(LEN=1), INTENT(IN)    :: EXT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE UTIMP(GRADEBL,GRAPRDL,LISDEBL,LISPRDL)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: GRADEBL,GRAPRDL,LISDEBL,LISPRDL
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION VEL_PROF_Z
     &( I , IPOIN2 , IPLAN , IOPT )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER          , INTENT(IN) :: I,IPOIN2,IPLAN,IOPT
        END FUNCTION
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE USER_VEL_PROF_Z
     &( VEL_PROF_Z, I , IPOIN2 , IPLAN , IOPT )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          DOUBLE PRECISION, INTENT(INOUT) :: VEL_PROF_Z
          INTEGER          , INTENT(IN) :: I,IPOIN2,IPLAN,IOPT
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VELRES
     &(U,V,W,DP,PX,PY,PZ,MSK,MASKEL,MESH3D,S,IELM3,OPTBAN,
     & UNSVOL,DO_UNSVOL,NPOIN3,NPOIN2,SIGMAG,IPBOT,AGGLOH,KSORT,NPTFR3,
     & LIUBOL,CONCOR)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: IELM3,OPTBAN,NPOIN3,NPOIN2
      INTEGER, INTENT(IN)            :: KSORT,NPTFR3
      DOUBLE PRECISION, INTENT(IN)   :: AGGLOH
      TYPE(BIEF_OBJ),  INTENT(IN)    :: S,DP,LIUBOL
      TYPE(BIEF_OBJ),  INTENT(INOUT) :: UNSVOL,PX,PY,PZ,U,V,W
      TYPE(BIEF_MESH), INTENT(INOUT) :: MESH3D
      INTEGER, INTENT(IN)            :: IPBOT(NPOIN2)
      LOGICAL, INTENT(IN)            :: MSK,SIGMAG,DO_UNSVOL,CONCOR
      TYPE(BIEF_OBJ), INTENT(INOUT)  :: MASKEL
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VERMOY
     & (FINT1,FINT2,F1,F2,NFONC,Z,TRA01,TRA02,TRA03,
     &  IPLAN1,IPLAN2,NPOIN2,NPLAN,OPTBAN)
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN) :: NPOIN2,NPLAN,NFONC,IPLAN1,IPLAN2,OPTBAN
      DOUBLE PRECISION, INTENT(INOUT) :: FINT1(NPOIN2),FINT2(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)    :: F1(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: F2(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(IN)    :: Z(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA01(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA02(NPOIN2,NPLAN)
      DOUBLE PRECISION, INTENT(INOUT) :: TRA03(NPOIN2,NPLAN)
        END SUBROUTINE
      END INTERFACE

!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VISCSA
     &(VISCVI,VISCNU,VISCTA,NU,NTRAC,
     & DNUVIH,DNUVIV,DNUTAH,DNUTAV,AK,EP,STRAIN,PRANDTL)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
      INTEGER, INTENT(IN)          :: NTRAC
      DOUBLE PRECISION, INTENT(IN) :: DNUVIH, DNUVIV,PRANDTL
      DOUBLE PRECISION, INTENT(IN) :: DNUTAH(NTRAC),DNUTAV(NTRAC)
      TYPE(BIEF_OBJ), INTENT(INOUT):: VISCVI,VISCNU,VISCTA,AK,EP
      TYPE(BIEF_OBJ), INTENT(IN)   :: NU,STRAIN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VISCKE
     & (VISCVI,VISCTA,AK,EP,NTRAC,CMU,
     &  DNUVIH,DNUVIV,DNUTAH,DNUTAV,EMIN,ITURBH,ITURBV,PRANDTL)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)          :: NTRAC,ITURBH,ITURBV
          DOUBLE PRECISION, INTENT(IN) :: CMU,PRANDTL
          DOUBLE PRECISION, INTENT(IN) :: DNUVIH,DNUVIV
          DOUBLE PRECISION, INTENT(IN) :: DNUTAH(NTRAC),DNUTAV(NTRAC)
          DOUBLE PRECISION, INTENT(IN) :: EMIN
          TYPE(BIEF_OBJ), INTENT(INOUT):: VISCVI,VISCTA
          TYPE(BIEF_OBJ), INTENT(IN)   :: AK,EP
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VISCKO
     &(VISCVI,VISCTA,ROTAT,AK,EP,NTRAC,DNUVIH,DNUVIV,DNUTAH,DNUTAV,
     & ITURBH,ITURBV,T1,T2,PRANDTL)
      USE BIEF_DEF
      IMPLICIT NONE
      INTEGER, INTENT(IN)          :: NTRAC,ITURBV,ITURBH
      DOUBLE PRECISION, INTENT(IN) :: DNUVIH, DNUVIV, PRANDTL
      DOUBLE PRECISION, INTENT(IN) :: DNUTAH(NTRAC),DNUTAV(NTRAC)
      TYPE(BIEF_OBJ), INTENT(INOUT):: VISCVI, VISCTA,T1,T2
      TYPE(BIEF_OBJ), INTENT(IN)   :: ROTAT, AK, EP
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VISCLIP
     & (VISCVI,VISCTA,H,NPLAN,NPOIN2,NTRAC,HLIM)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)            :: NPOIN2, NPLAN
          INTEGER, INTENT(IN)            :: NTRAC
          DOUBLE PRECISION, INTENT(IN)   :: HLIM
          TYPE (BIEF_OBJ), INTENT(INOUT) :: VISCVI, VISCTA
          TYPE (BIEF_OBJ), INTENT(IN)    :: H
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VISCLM
     &(VISCVI,VISCTA,RI,U,V,DELTAR,Z,HN,TRAV1,TRAV2,TRAV3,
     & TRAV4,TRAV5,TRAV7,MESH3D,IELM3,GRAV,
     & NPLAN,NPOIN3,NPOIN2,NTRAC,MSK,MASKEL,MIXING,
     & DAMPING,DNUVIV,DNUTAV,KARMAN,PRANDTL,KFROT,
     & RUGOF,ZF,LINLOG,IPBOT)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: NPOIN3,NPOIN2,NPLAN,KFROT
      INTEGER, INTENT(IN)            :: NTRAC,DAMPING,LINLOG
      INTEGER, INTENT(IN)            :: IELM3,MIXING
      INTEGER, INTENT(IN)            :: IPBOT(NPOIN2)
      DOUBLE PRECISION, INTENT(IN)   :: GRAV,DNUVIV,DNUTAV(NTRAC),KARMAN
      DOUBLE PRECISION, INTENT(IN)   :: PRANDTL
      LOGICAL, INTENT(IN)            :: MSK
      TYPE (BIEF_OBJ), INTENT(INOUT) :: VISCVI,VISCTA
      TYPE (BIEF_OBJ), INTENT(IN)    :: RUGOF,ZF
      TYPE (BIEF_OBJ), INTENT(INOUT) :: RI
      TYPE (BIEF_OBJ), INTENT(IN)    :: U,V,DELTAR,Z,HN
      TYPE (BIEF_OBJ), INTENT(INOUT) :: TRAV1,TRAV2,TRAV3,TRAV4
      TYPE (BIEF_OBJ), INTENT(INOUT) :: TRAV5,TRAV7
      TYPE (BIEF_OBJ), INTENT(IN)    :: MASKEL
      TYPE (BIEF_MESH)               :: MESH3D
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VISCOS
     &(VISCVI,VISCTA,DNUTAV,DNUTAH,DNUVIV,DNUVIH,
     & NTRAC,ITURBH,ITURBV)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN)            :: NTRAC
          INTEGER, INTENT(IN)            :: ITURBH,ITURBV
          TYPE (BIEF_OBJ), INTENT(INOUT) :: VISCVI, VISCTA
          DOUBLE PRECISION, INTENT(IN)   :: DNUVIH, DNUVIV
          DOUBLE PRECISION, INTENT(IN)   :: DNUTAH(NTRAC),DNUTAV(NTRAC)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VISSMA
     & (VISCVI,VISCTA,DNUTAH,DNUVIH,DNUVIV,DNUTAV,
     &  U,V,W,TRAV1,TRAV2,TRAV3,TRAV4,TRAV5,TRAV6,
     &  SVIDE,MESH3,IELM3,NTRAC,MSK,MASKEL,ITURBV,PRANDTL)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)            :: NTRAC,ITURBV
      INTEGER, INTENT(IN)            :: IELM3
      LOGICAL, INTENT(IN)            :: MSK
      TYPE (BIEF_OBJ), INTENT(IN)    :: U, V, W
      TYPE (BIEF_OBJ), INTENT(INOUT) :: VISCVI, VISCTA
      TYPE (BIEF_OBJ), INTENT(INOUT) :: TRAV1, TRAV2, TRAV3, TRAV4
      TYPE (BIEF_OBJ), INTENT(INOUT) :: TRAV5      !  NUSMAG
      TYPE (BIEF_OBJ), INTENT(INOUT) :: TRAV6
      TYPE (BIEF_OBJ), INTENT(IN)    :: MASKEL
      TYPE (BIEF_OBJ), INTENT(INOUT) :: SVIDE
      TYPE (BIEF_MESH)               :: MESH3
      DOUBLE PRECISION, INTENT(IN)   :: DNUVIH,DNUVIV,PRANDTL
      DOUBLE PRECISION, INTENT(IN)   :: DNUTAH(NTRAC),DNUTAV(NTRAC)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        DOUBLE PRECISION FUNCTION VIT3( I , AT , N , INFOGR )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER          , INTENT(IN) :: I,N
          DOUBLE PRECISION , INTENT(IN) :: AT
          LOGICAL          , INTENT(IN) :: INFOGR
        END FUNCTION
      END INTERFACE
      !
      !-----------------------------------------------------------------------
      !
      INTERFACE
        SUBROUTINE USER_VIT3( VIT3, I , AT , N , INFOGR )
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          DOUBLE PRECISION , INTENT(INOUT) :: VIT3
          INTEGER          , INTENT(IN)    :: I,N
          DOUBLE PRECISION , INTENT(IN)    :: AT
          LOGICAL          , INTENT(IN)    :: INFOGR
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE COMPUTE_SETTLING_VEL
     &(WCHU,U,V,
     & TRAV1,TRAV2,TRAV3,S,MESH3D,IELM3,NPOIN2,NPOIN3,NPLAN,
     & MSK,MASKEL,UETCAR,TA,HN)
      USE BIEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_MESH),INTENT(INOUT) :: MESH3D
      TYPE(BIEF_OBJ), INTENT(INOUT) :: WCHU,TRAV1,TRAV2,TRAV3
      TYPE(BIEF_OBJ), INTENT(IN)    :: MASKEL,S,HN,U,V
      TYPE(BIEF_OBJ), INTENT(IN)    :: TA,UETCAR
      LOGICAL, INTENT(IN)           :: MSK
      INTEGER, INTENT(IN)           :: NPOIN2,NPOIN3,NPLAN,IELM3
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE VITCHU
     &  (S3D_WCHU,S3D_WCHU0,U,V,S3D_TURBA,
     &   S3D_TURBB,TRAV1,TRAV2,TRAV3,S,MESH3D,IELM3,NPOIN2,NPOIN3,NPLAN,
     &   NTRAC,MSK,MASKEL,UETCAR,TA,HN,S3D_FLOC, S3D_FLOC_TYPE,
     &   S3D_HINDER,S3D_HIND_TYPE,S3D_CGEL,S3D_CINI)
          USE BIEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
      TYPE(BIEF_MESH),INTENT(INOUT) :: MESH3D
      TYPE(BIEF_OBJ), INTENT(INOUT) :: S3D_WCHU,TRAV1,TRAV2,TRAV3
      TYPE(BIEF_OBJ), INTENT(IN)    :: MASKEL,S,HN,U,V
      TYPE(BIEF_OBJ), INTENT(IN)    :: TA,UETCAR
      LOGICAL, INTENT(IN)           :: MSK,S3D_HINDER
      LOGICAL, INTENT(IN)           :: S3D_FLOC
      INTEGER, INTENT(IN)           :: NPOIN2,NPOIN3,NPLAN,IELM3
      INTEGER, INTENT(IN)           :: NTRAC,S3D_HIND_TYPE
      INTEGER, INTENT(IN)           :: S3D_FLOC_TYPE
      DOUBLE PRECISION, INTENT(IN)  :: S3D_WCHU0,S3D_TURBA,S3D_TURBB
      DOUBLE PRECISION, INTENT(IN)  :: S3D_CGEL,S3D_CINI
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE WAVE_EQUATION(ISOUSI)
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          INTEGER, INTENT(IN) :: ISOUSI
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE WCHIND
     &(WCHU,C,CINI,CGEL,NPOIN3,HIND_TYPE)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      TYPE(BIEF_OBJ), INTENT(INOUT) :: C
      INTEGER, INTENT(IN)           :: HIND_TYPE, NPOIN3
      DOUBLE PRECISION, INTENT(INOUT) :: WCHU(NPOIN3)
      DOUBLE PRECISION, INTENT(IN)  :: CINI, CGEL
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE WCTURB
     &(WCHU, WCHU0, U, V, TRAV1, TRAV2,TRAV3,
     & S, MESH3, IELM3, NPOIN2, NPLAN, TURBA, TURBB, MSK, MASKEL,
     & UETCAR)
      USE BIEF_DEF
      USE DECLARATIONS_SPECIAL
      IMPLICIT NONE
      INTEGER, INTENT(IN)           :: NPOIN2,NPLAN,IELM3
      DOUBLE PRECISION, INTENT(IN)  :: WCHU0,TURBA, TURBB
      LOGICAL, INTENT(IN)           :: MSK
      TYPE(BIEF_MESH), INTENT(INOUT):: MESH3
      TYPE(BIEF_OBJ), INTENT(INOUT) :: WCHU,TRAV1,TRAV2,TRAV3
      TYPE(BIEF_OBJ), INTENT(IN)    :: MASKEL,S,UETCAR,U,V
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE WSTARW(WW,WSS,WUP,WDOWN,SOMMEW)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          TYPE(BIEF_OBJ), INTENT(IN) :: WSS
          TYPE(BIEF_OBJ), INTENT(INOUT) :: WW
          DOUBLE PRECISION,INTENT(INOUT) :: WUP(*),WDOWN(*),SOMMEW(*)
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE WSTAR(WS,HWSTAR,Z,NPOIN2,NPLAN)
          USE BIEF_DEF
          USE DECLARATIONS_SPECIAL
          IMPLICIT NONE
          TYPE(BIEF_OBJ),    INTENT(IN   ) :: HWSTAR
          TYPE(BIEF_OBJ),    INTENT(INOUT) :: WS
          DOUBLE PRECISION,  INTENT(IN   ) :: Z(*)
          INTEGER,           INTENT(IN   ) :: NPOIN2,NPLAN
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TELEMAC3D(PASS,NIT_ORI)
        IMPLICIT NONE
        INTEGER,          INTENT(IN) :: PASS
        INTEGER,          INTENT(IN) :: NIT_ORI
        END SUBROUTINE
      END INTERFACE
!
!-----------------------------------------------------------------------
!
      INTERFACE
        SUBROUTINE TELEMAC3D_INIT
        IMPLICIT NONE
        END SUBROUTINE
      END INTERFACE
!
!=======================================================================
!
      END MODULE INTERFACE_TELEMAC3D
