<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>MED fichier: Concepts et fonctionnalit&eacute;s avanc&eacute;s sur les champs de r&eacute;sultat</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MED fichier
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Documentation&#160;MED</span></a></li>
      <li class="current"><a href="pages.html"><span>Guides&#160;d'utilisation</span></a></li>
      <li><a href="modules.html"><span>Guides&#160;de&#160;référence</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Concepts et fonctionnalit&eacute;s avanc&eacute;s sur les champs de r&eacute;sultat </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="____Concepts et fonctionnalit&eacute;s avanc&eacute;s sur les champs de r&eacute;sultat____"></a>  <a href="#1.">Cr&eacute;er et lire des champs avec gestion des profils</a> </p>
<p><a href="#2.">Lire des champs cr&eacute;&eacute;s avec MED 2.x et d&eacute;finis sur plusieurs maillages</a> </p>
<p><a href="#3.">Cr&eacute;er et lire un champ aux points d'int&eacute;gration des &eacute;l&eacute;ments</a> </p>
<p><a href="#4.">Cr&eacute;er et lire un champ aux noeuds des &eacute;l&eacute;ments</a> </p>
<p><a href="#5.">Cr&eacute;er et lire un champ li&eacute; &agrave; un maillage contenant des &eacute;l&eacute;ments de structure </a> </p>
<p><a href="#6.">Ecrire et lire un maillage ou un champ en filtrant les donn&eacute;es</a> </p>
<p><a href="#7.">Ecriture et lecture en parall&egrave;le dans un seul fichier</a> </p>
<h3><a class="anchor" id="1."></a>Cr&eacute;er et lire des champs avec gestion des profils </h3>
<p>Au m&ecirc;me titre que pour un maillage &eacute;volutif, il est possible d'utiliser les profils pour s&eacute;lectionner les valeurs des champs de r&eacute;sultats. Les champs ne peuvent &ecirc;tre definis que sur une partie du maillage. Le profil d'un champ indique sur quelles entit&eacute;s du maillage se trouvent les valeurs.</p>
<p>A l'&eacute;criture des champs, l'utilisation des profils est possible pour l'&eacute;criture des valeurs du champ avec les routines <a class="el" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a> / <a class="el" href="a00618_a3e49d45076713d2d77de749dd166b9f8.html#a3e49d45076713d2d77de749dd166b9f8">mfdrpw</a>, <a class="el" href="a00618_a5078f5a9b967e74da8eff4d25a467d99.html#a5078f5a9b967e74da8eff4d25a467d99">mfdipw</a>.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 7 : write a field with computing steps and profiles</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMPERATURE_FIELD&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentname[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMPERATURE&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;C&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tria3values_step1_profile1[3] = {1000.,               4000.,                      8000.};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tria3values_step2_profile1[8] = {1500.,    0.,    0., 4500.,    0.,    0.,    0., 8500.};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tria3values_step2_profile2[8] = {   0., 2500., 3500.,    0., 5500., 6500., 7500.,    0.};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> quad4values_step1[4] = {10000., 20000., 30000., 40000.};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> quad4values_step2[4] = {15000., 25000., 35000., 45000.};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> profile1name[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MED_TRIA3_PROFILE1&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile1[3] = {1, 4, 8};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile1size = 3;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> profile2name[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MED_TRIA3_PROFILE2&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile2[5] = {2, 3, 5, 6, 7};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile2size = 5;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ntria3 = 8;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nquad4 = 4;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* file creation */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_7.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create mesh link */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01053_ga08d1c8b15fbab77a11c6b59a0c600c4e.html#ga08d1c8b15fbab77a11c6b59a0c600c4e">MEDlinkWr</a>(fid,meshname,<span class="stringliteral">&quot;./UsesCase_MEDmesh_1.med&quot;</span>) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create mesh link ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create the profiles in the file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01057_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1">MEDprofileWr</a>(fid, profile1name, profile1size, profile1 ) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create profile ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01057_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1">MEDprofileWr</a>(fid, profile2name, profile2size, profile2 ) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create profile ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* field creation : temperature field  : 1 component in celsius degree</span></div>
<div class="line"><span class="comment">   *                  the mesh is the 2D unstructured mesh of UsecaseMEDmesh_1.c</span></div>
<div class="line"><span class="comment">   *                  use case.</span></div>
<div class="line"><span class="comment">   *                  Computation step unit in &#39;ms&#39;</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_ga8f73c6eb1a1b85f5e1e8bc1823c01ab9.html#ga8f73c6eb1a1b85f5e1e8bc1823c01ab9">MEDfieldCr</a>(fid, fieldname, <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>, ncomponent,</div>
<div class="line">                 componentname, componentunit,<span class="stringliteral">&quot;ms&quot;</span>, meshname) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create field&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* two computation steps */</span></div>
<div class="line">  <span class="comment">/* write values at cell centers : 8 MED_TRIA3 and 4 MED_QUAD4 */</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* STEP 1 : dt1 = 5.5, it = 1*/</span></div>
<div class="line">  <span class="comment">/* MED_TRIA3 : with a profile of 3 values in compact memory storage mode */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 1, 1, 5.5, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profile1name, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, ntria3,</div>
<div class="line">                                 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tria3values_step1_profile1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_TRIA3&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">   <span class="comment">/* MED_QUAD4  : with no profile */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 1, 1, 5.5, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, nquad4,</div>
<div class="line">                                 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) quad4values_step1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_QUAD4 &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* STEP 2 : dt2 = 8.9, it = 1*/</span></div>
<div class="line">  <span class="comment">/* MED_TRIA3 : with a profile of 3 values then a profile of 5 values in global memory storage mode */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 2 , 1 , 8.9 , <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a>, profile1name, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, ntria3,</div>
<div class="line">                                 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tria3values_step2_profile1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_TRIA3 ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 2 , 1 , 8.9 , <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a>, profile2name, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, ntria3,</div>
<div class="line">                                 (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tria3values_step2_profile2) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_TRIA3 ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* MED_QUAD4 : with no profile */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 2, 1, 8.9, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,</div>
<div class="line">                      <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                      <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, nquad4,</div>
<div class="line">                      (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) quad4values_step2) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_QUAD4 ... &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --><p>A la lecture, la routine <a class="el" href="a01048_gab8ce8c33cfe01cbccbde8474a4c433ba.html#gab8ce8c33cfe01cbccbde8474a4c433ba">MEDfieldnProfile</a> / <a class="el" href="a00618_a1bfc80fc41bb1c9c11a4a946b199452f.html#a1bfc80fc41bb1c9c11a4a946b199452f">mfdnpf</a> permet de lire le nombre de profil dans un champ pour une s&eacute;quence de calcul donn&eacute;e. La routine <a class="el" href="a01048_gaa45f3d32332f8410c35c51a77ee20740.html#gaa45f3d32332f8410c35c51a77ee20740">MEDfieldnValueWithProfile</a> / <a class="el" href="a00618_afe5dacbacc6af9e74473c018e0e70f8a.html#afe5dacbacc6af9e74473c018e0e70f8a">mfdnvp</a> permet de lire le nombre de valeurs &agrave; lire en tenant compte du profil et mode de stockage des donn&eacute;es en m&eacute;moire (<a class="el" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a> ou <a class="el" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>). Les routines <a class="el" href="a01048_ga85cf40e4f76b7f6e6036445a6c6108b4.html#ga85cf40e4f76b7f6e6036445a6c6108b4">MEDfieldValueWithProfileRd</a> / <a class="el" href="a00618_a58433c346e2147cfa2724f0b1b15cb80.html#a58433c346e2147cfa2724f0b1b15cb80">mfdrpr</a>, <a class="el" href="a00618_a5258c859a394de1bcba468966b74b07d.html#a5258c859a394de1bcba468966b74b07d">mfdipr</a> permettent de lire les valeurs du champ avec ou sans profil.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 9 : read a field with computing steps and profiles (generic approach)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> nfield, i, j;</div>
<div class="line">  <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> localmesh;</div>
<div class="line">  <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a> fieldtype;</div>
<div class="line">  <span class="keywordtype">char</span> *componentname = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> *componentunit = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *values = NULL;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep, nvalues;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> csit, numit, numdt, it;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotypes = <a class="code" href="a00690_a54c2e34174a890046d0a204fa1a918a8.html#a54c2e34174a890046d0a204fa1a918a8">MED_GET_CELL_GEOMETRY_TYPE</a>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nprofile, pit, profilesize;</div>
<div class="line">  <span class="keywordtype">char</span> profilename[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nintegrationpoint;</div>
<div class="line">  <span class="keywordtype">char</span> localizationname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* open file */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_7.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * generic approach : how many fields in the file and identification</span></div>
<div class="line"><span class="comment">   * of each field.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((nfield = <a class="code" href="a01048_ga0d8be6c1b6b24ff150a5adcb58831d93.html#ga0d8be6c1b6b24ff150a5adcb58831d93">MEDnField</a>(fid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : How many fields in the file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * read values for each field</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;nfield; i++) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((ncomponent = <a class="code" href="a01048_gabe6258ebc74592af81c9b51379b7b7af.html#gabe6258ebc74592af81c9b51379b7b7af">MEDfieldnComponent</a>(fid,i+1)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of field component ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentname = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentunit = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01048_gaf2169b6d6505a28d7ee5f8599d2fb25e.html#gaf2169b6d6505a28d7ee5f8599d2fb25e">MEDfieldInfo</a>(fid, i+1, fieldname, meshname, &amp;localmesh, &amp;fieldtype,</div>
<div class="line">                     componentname, componentunit, dtunit, &amp;nstep) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Field info ...&quot;</span>);</div>
<div class="line">      free(componentname);</div>
<div class="line">      free(componentunit);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    free(componentname);</div>
<div class="line">    free(componentunit);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Read field values for each computing step</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">for</span> (csit=0; csit&lt;nstep; csit++) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01048_ga5b0031d3002518f1b2e134ff8c03dbc5.html#ga5b0031d3002518f1b2e134ff8c03dbc5">MEDfieldComputingStepInfo</a>(fid, fieldname, csit+1, &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">/*</span></div>
<div class="line"><span class="comment">       * ... In our case, we suppose that the field values are only defined on cells ...</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keywordflow">for</span> (it=1; it&lt;=<a class="code" href="a00577_abd42d91233c317ca8eb9b592e4502053.html#abd42d91233c317ca8eb9b592e4502053">MED_N_CELL_FIXED_GEO</a>; it++) {</div>
<div class="line"></div>
<div class="line">        geotype = geotypes[it];</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * How many profile for each geometry type ?</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((nprofile = <a class="code" href="a01048_gab8ce8c33cfe01cbccbde8474a4c433ba.html#gab8ce8c33cfe01cbccbde8474a4c433ba">MEDfieldnProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, geotype,</div>
<div class="line">                                         profilename, localizationname)) &lt; 0) {</div>
<div class="line">          <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of profile &quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Read values for each profile</span></div>
<div class="line"><span class="comment">         * We suppose that we have no localization name</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">for</span> (pit=0; pit&lt;nprofile; pit++) {</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> ((nvalues = <a class="code" href="a01048_gaa45f3d32332f8410c35c51a77ee20740.html#gaa45f3d32332f8410c35c51a77ee20740">MEDfieldnValueWithProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, geotype,</div>
<div class="line">                                                   pit+1, <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename, &amp;profilesize,</div>
<div class="line">                                                   localizationname, &amp;nintegrationpoint)) &lt; 0) {</div>
<div class="line">            <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of values with a profile ...&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">          }</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> (nvalues) {</div>
<div class="line">            <span class="keywordflow">if</span> ((values = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nvalues*ncomponent)) == NULL) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">              <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a01048_ga85cf40e4f76b7f6e6036445a6c6108b4.html#ga85cf40e4f76b7f6e6036445a6c6108b4">MEDfieldValueWithProfileRd</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, geotype,</div>
<div class="line">                                           <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename,</div>
<div class="line">                                           <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)values) &lt; 0) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read fields values for cells ...&quot;</span>);</div>
<div class="line">              free(values);</div>
<div class="line">              <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            free(values);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="2."></a>Lire des champs cr&eacute;&eacute;s avec MED 2.x et d&eacute;finis sur plusieurs maillages</h3>
<p>Dans MED 2.x, les champs pouvaient &ecirc;tre d&eacute;finis sur plusieurs maillages. Cette possibilit&eacute; dispara&icirc;t avec MED 3.0 et l'apparition des maillages &eacute;volutifs. MED 3.0 fournit n&eacute;anmoins des routines permettant la lecture de fichier MED 2.x pouvant contenir des champs d&eacute;finis sur plusieurs maillages. Ces routines sp&eacute;cifiques sont &agrave; utiliser en lieu et place de celles utilis&eacute;es dans le cas d'utilisation pr&eacute;c&eacute;dent (ces routines peuvent &eacute;videmment &eacute;galement lire des champs dans des fichiers MED 3.0), il s'agit de <a class="el" href="a01048_gac2f9fe6595887efff5412c2ed16b087b.html#gac2f9fe6595887efff5412c2ed16b087b">MEDfield23ComputingStepMeshInfo</a> / <a class="el" href="a00618_a502b35eb4a896c2e15fe53ce80794334.html#a502b35eb4a896c2e15fe53ce80794334">mfdoci</a>, <a class="el" href="a01048_gab551e1d90598c42819083eea1c71f6de.html#gab551e1d90598c42819083eea1c71f6de">MEDfield23nValueWithProfile</a> / <a class="el" href="a00618_a50dd292a5958620cac2fd65a7552dea6.html#a50dd292a5958620cac2fd65a7552dea6">mfdonv</a>, <a class="el" href="a01048_gab65a0b4b722065772868058d8a99b4a9.html#gab65a0b4b722065772868058d8a99b4a9">MEDfield23ValueWithProfileRd</a> / <a class="el" href="a00618_a411356660c436b498d00405b3938442a.html#a411356660c436b498d00405b3938442a">mfdorr</a>, <a class="el" href="a00618_aafef8aaa1135e366f1aeab67d526c43a.html#aafef8aaa1135e366f1aeab67d526c43a">mfdoir</a>.</p>
<p>Le cas d'utilisation suivant propose une approche g&eacute;n&eacute;rique pour lire les champs d'un fichier MED, bas&eacute;s sur un ou plusieurs maillages.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment"> * - Nom du fichier : test11b.c</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * - Description : lecture de champs de resultats MED (API23)</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *****************************************************************************/</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00591.html">med_utils.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef DEF_LECT_ECR</span></div>
<div class="line"><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span></div>
<div class="line"><span class="preprocessor">#elif DEF_LECT_AJOUT</span></div>
<div class="line"><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef USER_INTERLACE</span></div>
<div class="line"><span class="preprocessor">#define USER_INTERLACE MED_FULL_INTERLACE</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define USER_MODE MED_COMPACT_STMODE</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="a00577_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> <a class="code" href="a00859_a04f094649b2e322a80036f52a4e866a1.html#a04f094649b2e322a80036f52a4e866a1">getFieldsOn</a>(<a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid, <span class="keywordtype">char</span> * nomcha, <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a> typcha, <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomp,</div>
<div class="line">                    <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> entite, <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37d">med_switch_mode</a> stockage, <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncstp);</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a00577_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> ret,lret;</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <span class="keywordtype">char</span> * fichier = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> maa[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> desc[<a class="code" href="a00577_ab69710ecf9f5257080a943579852d0f0.html#ab69710ecf9f5257080a943579852d0f0">MED_COMMENT_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> pflname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>,nomlien[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> _meshname [<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> _dtunit [<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> locname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> * lien = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> *comp= NULL, *unit= NULL;</div>
<div class="line">  <span class="keywordtype">char</span> nomcha  [<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> mdim=0,sdim=0,ncomp,ncha,npro,nln,pflsize,*pflval,nval;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> _ncstp=0,ngauss=0,nloc=0,locsdim=0,lnsize=0;</div>
<div class="line">  <span class="keywordtype">int</span> t1,t2,t3;</div>
<div class="line">  <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a>    typcha;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> type_geo;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *refcoo, *gscoo, *wg;</div>
<div class="line">  <span class="keywordtype">int</span> i,j;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> _local;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> nomcoo[3*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> unicoo[3*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> geointerpname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> ipointstructmeshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1">med_mesh_type</a> type;</div>
<div class="line">  <a class="code" href="a00577_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798">med_sorting_type</a> sort;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep=0;</div>
<div class="line">  <a class="code" href="a00577_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204d">med_axis_type</a> rep;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nsectionmeshcell;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> sectiongeotype;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (argc != 2) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Aucun nom de fichier precise, fichier test10.med utilise &quot;</span>);</div>
<div class="line">    fichier = <span class="stringliteral">&quot;test10.med&quot;</span>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fichier = argv[1];</div>
<div class="line">  };</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Ouverture du fichier med */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(fichier,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>)) &lt; 0){</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a l&#39;ouverture du fichier : &quot;</span>);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(fichier);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret = 0;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"> <span class="comment">/* Lecture des infos concernant le premier maillage */</span></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01055_ga71e0d79fbb40abdc9c20bc5be01441ac.html#ga71e0d79fbb40abdc9c20bc5be01441ac">MEDmeshInfo</a>( fid, 1,  maa, &amp;sdim, &amp;mdim, &amp;type, desc, dtunit, &amp;sort,</div>
<div class="line">                    &amp;nstep,  &amp;rep, nomcoo,unicoo) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des informations sur le maillage : &quot;</span>);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(maa);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Maillage de nom : |%s| , de dimension : &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; , et de type %d\n&quot;</span>,maa,mdim,type);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t -Dimension de l&#39;espace : &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;\n&quot;</span>,sdim);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t -Description du maillage : %s\n&quot;</span>,desc);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t -Noms des axes : |%s|\n&quot;</span>,nomcoo);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t -Unités des axes : |%s|\n&quot;</span>,unicoo);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t -Type de repère : %d\n&quot;</span>,rep);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t -Nombre d&#39;étapes de calcul : &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;\n&quot;</span>,nstep);</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t -Unité des dates : |%s|\n&quot;</span>,dtunit);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* combien de champs dans le fichier */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((ncha = <a class="code" href="a01048_ga0d8be6c1b6b24ff150a5adcb58831d93.html#ga0d8be6c1b6b24ff150a5adcb58831d93">MEDnField</a>(fid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Impossible de lire le nombre de champs : &quot;</span>);<a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(ncha);</div>
<div class="line">    <span class="keywordflow">return</span> ncha;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;Nombre de champs : &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; \n&quot;</span>,ncha);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* lecture de tous les champs  */</span></div>
<div class="line">  <span class="keywordflow">for</span> (i =0;i&lt;ncha;i++) {</div>
<div class="line">    lret = 0;</div>
<div class="line">    printf(<span class="stringliteral">&quot;\nChamp numero : %d \n&quot;</span>,i+1);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Lecture du nombre de composantes */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((ncomp = <a class="code" href="a01048_gabe6258ebc74592af81c9b51379b7b7af.html#gabe6258ebc74592af81c9b51379b7b7af">MEDfieldnComponent</a>(fid,i+1)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de composantes : &quot;</span>); <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(ncomp);</div>
<div class="line">      ret = -1; <span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Lecture du type du champ, des noms des composantes et du nom de l&#39;unite*/</span></div>
<div class="line">    comp = (<span class="keywordtype">char</span>*) malloc(ncomp*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1);</div>
<div class="line">    <a class="code" href="a00591_a1490910810b7b26086f3df4911027426.html#a1490910810b7b26086f3df4911027426">EXIT_IF</a>(comp == NULL,NULL,NULL);</div>
<div class="line">    unit = (<span class="keywordtype">char</span>*) malloc(ncomp*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1);</div>
<div class="line">    <a class="code" href="a00591_a1490910810b7b26086f3df4911027426.html#a1490910810b7b26086f3df4911027426">EXIT_IF</a>(unit == NULL,NULL,NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01048_gaf2169b6d6505a28d7ee5f8599d2fb25e.html#gaf2169b6d6505a28d7ee5f8599d2fb25e">MEDfieldInfo</a>(fid,i+1,nomcha,_meshname,&amp;_local,&amp;typcha,comp,unit,_dtunit,&amp;_ncstp) &lt; 0 ) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la demande d&#39;information sur les champs : &quot;</span>);</div>
<div class="line">      <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(i+1);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(nomcha);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(typcha);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(comp);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(unit);</div>
<div class="line">      <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(ncomp);</div>
<div class="line">      ret = -1; <span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    printf(<span class="stringliteral">&quot;Nom du champ : |%s| de type %d\n&quot;</span>,nomcha,typcha);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Nom des composantes : |%s|\n&quot;</span>,comp);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Unites des composantes : |%s| \n&quot;</span>,unit);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Unites des dates  : |%s| \n&quot;</span>,_dtunit);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Le maillage associé est |%s|\n&quot;</span>,_meshname);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Nombre de séquences de calcul |&quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;|\n&quot;</span>,_ncstp);</div>
<div class="line"></div>
<div class="line">      <span class="comment">/* Le maillage reference est-il porte par un autre fichier */</span></div>
<div class="line">    <span class="keywordflow">if</span> ( !_local ) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> ( (lnsize=<a class="code" href="a01053_ga8b2e785cb3126e02569c8b4f5564cd3d.html#ga8b2e785cb3126e02569c8b4f5564cd3d">MEDlinkInfoByName</a>(fid,_meshname) ) &lt; 0 )  {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture de la taille du lien : &quot;</span>);</div>
<div class="line">        <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(_meshname);</div>
<div class="line">        ret = -1;</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line"></div>
<div class="line">        lien = malloc((lnsize+1)*<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line">          <a class="code" href="a00591_a1490910810b7b26086f3df4911027426.html#a1490910810b7b26086f3df4911027426">EXIT_IF</a>(lien == NULL,NULL,NULL);</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> ( <a class="code" href="a01053_gabdf9a46ed125db6ae1df407e7bf1342d.html#gabdf9a46ed125db6ae1df407e7bf1342d">MEDlinkRd</a>(fid,_meshname, lien) &lt; 0 )  {</div>
<div class="line">            <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du lien : &quot;</span>);</div>
<div class="line">            <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(_meshname);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(lien);</div>
<div class="line">            ret = -1;</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            printf(<span class="stringliteral">&quot;\tLe maillage |%s| est porte par un fichier distant |%s|\n&quot;</span>,_meshname,lien);</div>
<div class="line">          }</div>
<div class="line">          free(lien);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    </div>
<div class="line">    free(comp);</div>
<div class="line">    free(unit);</div>
<div class="line">    </div>
<div class="line">      </div>
<div class="line">    lret = <a class="code" href="a00859_a04f094649b2e322a80036f52a4e866a1.html#a04f094649b2e322a80036f52a4e866a1">getFieldsOn</a>(fid, nomcha, typcha, ncomp, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a>, <a class="code" href="a00853_ac09b07847abc434cc4a161e367e6b9b0.html#ac09b07847abc434cc4a161e367e6b9b0">USER_INTERLACE</a>,_ncstp );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (lret == 0) lret = <a class="code" href="a00859_a04f094649b2e322a80036f52a4e866a1.html#a04f094649b2e322a80036f52a4e866a1">getFieldsOn</a>(fid, nomcha, typcha, ncomp, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00853_ac09b07847abc434cc4a161e367e6b9b0.html#ac09b07847abc434cc4a161e367e6b9b0">USER_INTERLACE</a>,_ncstp );</div>
<div class="line">    <span class="keywordflow">else</span> { <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des champs aux noeuds &quot;</span>); ret = -1; <span class="keywordflow">continue</span>;}</div>
<div class="line">   </div>
<div class="line">    <span class="keywordflow">if</span> (lret == 0) lret = <a class="code" href="a00859_a04f094649b2e322a80036f52a4e866a1.html#a04f094649b2e322a80036f52a4e866a1">getFieldsOn</a>(fid, nomcha, typcha, ncomp, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a9168c75d6fb79842aeb30740f5146d25">MED_DESCENDING_FACE</a>,<a class="code" href="a00853_ac09b07847abc434cc4a161e367e6b9b0.html#ac09b07847abc434cc4a161e367e6b9b0">USER_INTERLACE</a>,_ncstp);</div>
<div class="line">    <span class="keywordflow">else</span> { <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des champs aux mailles &quot;</span>); ret = -1; <span class="keywordflow">continue</span>;}</div>
<div class="line">   </div>
<div class="line">    <span class="keywordflow">if</span> (lret == 0) lret = <a class="code" href="a00859_a04f094649b2e322a80036f52a4e866a1.html#a04f094649b2e322a80036f52a4e866a1">getFieldsOn</a>(fid, nomcha, typcha, ncomp, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470aecea01a443c5512ff49ddba9f992aa0e">MED_DESCENDING_EDGE</a>,<a class="code" href="a00853_ac09b07847abc434cc4a161e367e6b9b0.html#ac09b07847abc434cc4a161e367e6b9b0">USER_INTERLACE</a>,_ncstp);</div>
<div class="line">    <span class="keywordflow">else</span> {<a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des champs aux faces &quot;</span>); ret = -1; <span class="keywordflow">continue</span>;}</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (lret == 0) lret = <a class="code" href="a00859_a04f094649b2e322a80036f52a4e866a1.html#a04f094649b2e322a80036f52a4e866a1">getFieldsOn</a>(fid, nomcha, typcha, ncomp, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a>,<a class="code" href="a00853_ac09b07847abc434cc4a161e367e6b9b0.html#ac09b07847abc434cc4a161e367e6b9b0">USER_INTERLACE</a>,_ncstp);</div>
<div class="line">    <span class="keywordflow">else</span> {<a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des champs aux aretes&quot;</span>); ret = -1; <span class="keywordflow">continue</span>;}</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/*TODO */</span></div>
<div class="line"><span class="comment">/*     if (lret == 0) lret = getFieldsOn(fid, nomcha, typcha, ncomp, MED_STRUCT_ELEMENT,USER_INTERLACE,_ncstp); */</span></div>
<div class="line"><span class="comment">/*     else {MESSAGE(&quot;Erreur a la lecture des champs aux éléments de structure&quot;); ret = -1; continue;} */</span></div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span>  (lret != 0) {<a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des champs aux noeuds des mailles &quot;</span>); ret = -1;};</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Interrogation des profils */</span></div>
<div class="line">  npro = <a class="code" href="a01057_ga984674c8806c7374a95cd451219f8e81.html#ga984674c8806c7374a95cd451219f8e81">MEDnProfile</a>(fid);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;\nNombre de profils stockes : &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;\n\n&quot;</span>,npro);</div>
<div class="line">  <span class="keywordflow">for</span> (i=1 ; i &lt;= npro ; i++ ) {</div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01057_ga58f36a5e3b4fb4a2e510b421c6608102.html#ga58f36a5e3b4fb4a2e510b421c6608102">MEDprofileInfo</a>(fid, i, pflname, &amp;nval) &lt; 0)  {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la demande d&#39;information sur le profil n° : &quot;</span>); <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(i);</div>
<div class="line">      ret = -1;<span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t- Profil n°%i de nom |%s| et de taille &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;\n&quot;</span>,i,pflname,nval);</div>
<div class="line">    pflval = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nval);</div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01057_ga93bec578fad63ceaaae0d7ea511d7a3e.html#ga93bec578fad63ceaaae0d7ea511d7a3e">MEDprofileRd</a>(fid, pflname, pflval) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des valeurs du profil : &quot;</span>);</div>
<div class="line">      <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(pflname);</div>
<div class="line">      ret = -1;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      printf(<span class="stringliteral">&quot;\t&quot;</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (j=0;j&lt;nval;j++) printf(<span class="stringliteral">&quot; &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; &quot;</span>,*(pflval+j));</div>
<div class="line">      printf(<span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    free(pflval);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Interrogation des liens */</span></div>
<div class="line">  nln = <a class="code" href="a01053_gafa53d1b44d84d4253e83af686857715d.html#gafa53d1b44d84d4253e83af686857715d">MEDnLink</a>(fid);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;\nNombre de liens stockes : &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;\n\n&quot;</span>,nln);</div>
<div class="line">  <span class="keywordflow">for</span> (i=1 ; i &lt;= nln ; i++ ) {</div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01053_ga01f23204f72d19459c7c96b4b91b018e.html#ga01f23204f72d19459c7c96b4b91b018e">MEDlinkInfo</a>(fid, i, nomlien, &amp;nval) &lt; 0)  {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la demande d&#39;information sur le lien n° : &quot;</span>); <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(i);</div>
<div class="line">      ret = -1;<span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t- Lien n°%i de nom |%s| et de taille &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;\n&quot;</span>,i,nomlien,nval);</div>
<div class="line"></div>
<div class="line">    lien = (<span class="keywordtype">char</span> * ) malloc((nval+1)*<span class="keyword">sizeof</span>(char));</div>
<div class="line">    <a class="code" href="a00591_a1490910810b7b26086f3df4911027426.html#a1490910810b7b26086f3df4911027426">EXIT_IF</a>(lien == NULL,NULL,NULL);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01053_gabdf9a46ed125db6ae1df407e7bf1342d.html#gabdf9a46ed125db6ae1df407e7bf1342d">MEDlinkRd</a>(fid, nomlien, lien ) &lt; 0 )  {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du lien : &quot;</span>);</div>
<div class="line">      <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(nomlien);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(lien);</div>
<div class="line">      ret = -1;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      lien[nval] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">      printf(<span class="stringliteral">&quot;\t\t|%s|\n\n&quot;</span>,lien);</div>
<div class="line">    }</div>
<div class="line">    free(lien);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Interrogation des localisations des points de GAUSS */</span></div>
<div class="line">  nloc = <a class="code" href="a01054_ga20dffbd06dc5272536b66fc6071be154.html#ga20dffbd06dc5272536b66fc6071be154">MEDnLocalization</a>(fid);</div>
<div class="line"></div>
<div class="line">  printf(<span class="stringliteral">&quot;\nNombre de localisations stockees : &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;\n\n&quot;</span>,nloc);</div>
<div class="line">  <span class="keywordflow">for</span> (i=1 ; i &lt;= nloc ; i++ ) {</div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01054_gac03d0ad34b8c2263d77795919fd0f1a3.html#gac03d0ad34b8c2263d77795919fd0f1a3">MEDlocalizationInfo</a>(fid, i, locname, &amp;type_geo, &amp;locsdim,&amp;ngauss,</div>
<div class="line">                             geointerpname, ipointstructmeshname,&amp;nsectionmeshcell,</div>
<div class="line">                             &amp;sectiongeotype) &lt; 0)  {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la demande d&#39;information sur la localisation n° : &quot;</span>); <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(i);</div>
<div class="line">      ret = -1;<span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line">    printf(<span class="stringliteral">&quot;\t- Loc. n°%i de nom |%s| de dimension &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; avec &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; pts de GAUSS \n&quot;</span>,i,locname,locsdim,ngauss);</div>
<div class="line">    t1 = (type_geo%100)*(type_geo/100);</div>
<div class="line">    t2 = ngauss*(type_geo/100);</div>
<div class="line">    t3 = ngauss;</div>
<div class="line">    refcoo = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*t1 );</div>
<div class="line">    gscoo  = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*t2 );</div>
<div class="line">    wg     = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*t3 );</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01054_ga613df7c12919f60dc27d49ff8f1f35a3.html#ga613df7c12919f60dc27d49ff8f1f35a3">MEDlocalizationRd</a>(fid, locname, <a class="code" href="a00853_ac09b07847abc434cc4a161e367e6b9b0.html#ac09b07847abc434cc4a161e367e6b9b0">USER_INTERLACE</a>, refcoo, gscoo, wg  ) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des valeurs de la localisation : &quot;</span>);</div>
<div class="line">      <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(locname);</div>
<div class="line">      ret = -1;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      printf(<span class="stringliteral">&quot;\t  Coordonnees de l&#39;element de reference de type %i :\n\t\t&quot;</span>,type_geo);</div>
<div class="line">      <span class="keywordflow">for</span> (j=0;j&lt;t1;j++) printf(<span class="stringliteral">&quot; %f &quot;</span>,*(refcoo+j));</div>
<div class="line">      printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">      printf(<span class="stringliteral">&quot;\t  Localisation des points de GAUSS : \n\t\t&quot;</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (j=0;j&lt;t2;j++) printf(<span class="stringliteral">&quot; %f &quot;</span>,*(gscoo+j));</div>
<div class="line">      printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">      printf(<span class="stringliteral">&quot;\t  Poids associes aux points de GAUSS :\n\t\t&quot;</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (j=0;j&lt;t3;j++) printf(<span class="stringliteral">&quot; %f &quot;</span>,*(wg+j));</div>
<div class="line">      printf(<span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    free(refcoo);</div>
<div class="line">    free(gscoo);</div>
<div class="line">    free(wg);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* fermeture du fichier */</span></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) <span class="keywordflow">return</span> -1;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><a class="code" href="a00577_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> <a class="code" href="a00859_a04f094649b2e322a80036f52a4e866a1.html#a04f094649b2e322a80036f52a4e866a1">getFieldsOn</a>(<a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid, <span class="keywordtype">char</span> * nomcha, <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a> typcha, <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomp,</div>
<div class="line">                    <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> entite, <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37d">med_switch_mode</a> stockage, <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncstp) {</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> i,j,k,l,m,n,nb_geo=0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nbpdtnor=0,pflsize,*pflval,ngauss=0,ngroup,*vale=NULL,nval;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> numdt=0,numo=0,_nprofile;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> meshnumdt=0,meshnumit=0;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *valr=NULL,dt=0.0;</div>
<div class="line">  <a class="code" href="a00577_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> ret=0;</div>
<div class="line">  <span class="keywordtype">char</span> pflname [<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> locname [<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> meshname [<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> * lien = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> dt_unit [<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> localmesh;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmesh=0;</div>
<div class="line"></div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> * type_geo;</div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> * AFF;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> * AFF_ENT=<a class="code" href="a00690_ad72c4ec2628b95b86e62e893bdfc4d3a.html#ad72c4ec2628b95b86e62e893bdfc4d3a">MED_GET_ENTITY_TYPENAME</a>+1;</div>
<div class="line">  <span class="keywordflow">switch</span> (entite) {</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a074507163b07b6d764823a78c5c07f0f">MED_NODE</a> :</div>
<div class="line">    type_geo = <a class="code" href="a00690_a9afaa32b2a595015d236efffd6a6b8f1.html#a9afaa32b2a595015d236efffd6a6b8f1">MED_GET_NODE_GEOMETRY_TYPE</a>;</div>
<div class="line">    nb_geo   = <a class="code" href="a00577_a94482e307ec77322dcfd9bde0e8f705f.html#a94482e307ec77322dcfd9bde0e8f705f">MED_N_NODE_FIXED_GEO</a>;</div>
<div class="line">    AFF      = <a class="code" href="a00690_a80fceccb749c149ed5226f53596182e2.html#a80fceccb749c149ed5226f53596182e2">MED_GET_NODE_GEOMETRY_TYPENAME</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span>  <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a> :</div>
<div class="line">  <span class="keywordflow">case</span>  <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a> :</div>
<div class="line">    type_geo = <a class="code" href="a00690_a54c2e34174a890046d0a204fa1a918a8.html#a54c2e34174a890046d0a204fa1a918a8">MED_GET_CELL_GEOMETRY_TYPE</a>;</div>
<div class="line">    nb_geo   = <a class="code" href="a00577_abd42d91233c317ca8eb9b592e4502053.html#abd42d91233c317ca8eb9b592e4502053">MED_N_CELL_FIXED_GEO</a>;</div>
<div class="line">    AFF      = <a class="code" href="a00690_af132d1ce1d5887f7a690eae70010a9e6.html#af132d1ce1d5887f7a690eae70010a9e6">MED_GET_CELL_GEOMETRY_TYPENAME</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span>  <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a9168c75d6fb79842aeb30740f5146d25">MED_DESCENDING_FACE</a> :</div>
<div class="line">    type_geo = <a class="code" href="a00690_afd26706c57b29262890b417e48a360e6.html#afd26706c57b29262890b417e48a360e6">MED_GET_FACE_GEOMETRY_TYPE</a>;</div>
<div class="line">    nb_geo   = <a class="code" href="a00577_ab0fae842b07280cb7fb20f10a68076ee.html#ab0fae842b07280cb7fb20f10a68076ee">MED_N_FACE_FIXED_GEO</a>;</div>
<div class="line">    AFF      = <a class="code" href="a00690_ab2c7c692304448d9b705889ade145e56.html#ab2c7c692304448d9b705889ade145e56">MED_GET_FACE_GEOMETRY_TYPENAME</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span>  <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470aecea01a443c5512ff49ddba9f992aa0e">MED_DESCENDING_EDGE</a> :</div>
<div class="line">    type_geo = <a class="code" href="a00690_a824a6a6383128fcc9df409d0d12cfef0.html#a824a6a6383128fcc9df409d0d12cfef0">MED_GET_EDGE_GEOMETRY_TYPE</a>;</div>
<div class="line">    nb_geo   = <a class="code" href="a00577_abc947dde9b1b8982162dde8888a79ab4.html#abc947dde9b1b8982162dde8888a79ab4">MED_N_EDGE_FIXED_GEO</a>;</div>
<div class="line">    AFF      = <a class="code" href="a00690_ac7b61e15c064e78b7cec77aeabd7532e.html#ac7b61e15c064e78b7cec77aeabd7532e">MED_GET_EDGE_GEOMETRY_TYPENAME</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (k=1;k&lt;=nb_geo;k++) {</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Combien de (PDT,NOR) a lire */</span></div>
<div class="line">    nbpdtnor = ncstp;</div>
<div class="line">    <span class="keywordflow">if</span> (nbpdtnor &lt; 1 ) <span class="keywordflow">continue</span>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (j=0;j&lt;nbpdtnor;j++) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> ( <a class="code" href="a01048_gac2f9fe6595887efff5412c2ed16b087b.html#gac2f9fe6595887efff5412c2ed16b087b">MEDfield23ComputingStepMeshInfo</a>(fid,nomcha,j+1, &amp;numdt, &amp;numo, &amp;dt,</div>
<div class="line">                                           &amp;nmesh, meshname,&amp;localmesh, &amp;meshnumdt, &amp;meshnumit ) &lt;0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la demande d&#39;information sur (pdt,nor) : &quot;</span>);</div>
<div class="line">        <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numdt); <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numo);<a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(nmesh);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(meshname);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(localmesh);</div>
<div class="line">        <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(meshnumdt);<a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(meshnumit);</div>
<div class="line">        ret = -1; <span class="keywordflow">continue</span>;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">for</span> (i=0;i&lt; nmesh;++i) {</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> ( (_nprofile = <a class="code" href="a01048_gaaafce3aa29614e7102335e3a908da118.html#gaaafce3aa29614e7102335e3a908da118">MEDfield23nProfile</a>(fid,nomcha,numdt,numo,entite,type_geo[k],i+1,meshname,</div>
<div class="line">                                                pflname,locname   ) ) &lt; 0 ) {</div>
<div class="line">          <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la demande du nombre de profils referencés par le champ : &quot;</span>);</div>
<div class="line">          <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(nomcha); <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numdt); <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numo);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(meshname);</div>
<div class="line">          <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(entite);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(type_geo[k]);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(pflname);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(locname);</div>
<div class="line">          <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(AFF_ENT[(<span class="keywordtype">int</span>)entite]);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(AFF[k]);</div>
<div class="line">          ret = -1; <span class="keywordflow">continue</span>;</div>
<div class="line">        };</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (l=0;l&lt;_nprofile;l++) {</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> ( (nval = <a class="code" href="a01048_gab551e1d90598c42819083eea1c71f6de.html#gab551e1d90598c42819083eea1c71f6de">MEDfield23nValueWithProfile</a>(fid, nomcha, numdt, numo,  entite, type_geo[k],meshname,</div>
<div class="line">                                                   l+1,  <a class="code" href="a00853_a4590bc240c9d6d928eecc7484553c2e7.html#a4590bc240c9d6d928eecc7484553c2e7">USER_MODE</a>, pflname,&amp;pflsize,</div>
<div class="line">                                                   locname, &amp;ngauss) ) &lt; 0 ) {</div>
<div class="line">            <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de valeurs du champ : &quot;</span>);</div>
<div class="line">            <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(nomcha);<a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numdt);<a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numo);<a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(meshname);</div>
<div class="line">            <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(entite);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(type_geo[k]);</div>
<div class="line">            <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(<a class="code" href="a00853_a4590bc240c9d6d928eecc7484553c2e7.html#a4590bc240c9d6d928eecc7484553c2e7">USER_MODE</a>);</div>
<div class="line">            ret = -1; <span class="keywordflow">continue</span>;</div>
<div class="line">          };</div>
<div class="line"></div>
<div class="line">          printf(<span class="stringliteral">&quot;\n  +Pas de Temps n.&quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; (%f) [%s], n. d&#39;ordre &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot;, avec &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; valeur(s) par entité.\n&quot;</span>,numdt,dt,dt_unit,numo,ngauss);</div>
<div class="line">          printf(<span class="stringliteral">&quot;\t- Il y a &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; entités qui portent des valeurs en mode %i. Chaque entite %s\</span></div>
<div class="line"><span class="stringliteral"> de type geometrique %s associes au profile |%s| a &quot;</span><a class="code" href="a00591_ad1c568efb9ee28e7f3b0e20bf7e79ff4.html#ad1c568efb9ee28e7f3b0e20bf7e79ff4">IFORMAT</a><span class="stringliteral">&quot; valeurs associées \n&quot;</span>,</div>
<div class="line">                 nval,<a class="code" href="a00853_a4590bc240c9d6d928eecc7484553c2e7.html#a4590bc240c9d6d928eecc7484553c2e7">USER_MODE</a>,AFF_ENT[(<span class="keywordtype">int</span>)entite],AFF[k],pflname,ngauss);</div>
<div class="line">          printf(<span class="stringliteral">&quot;\t- Le maillage associé est |%s|\n&quot;</span>,meshname);</div>
<div class="line"></div>
<div class="line">          <span class="comment">/*Lecture des valeurs du champ */</span></div>
<div class="line">          <span class="keywordflow">if</span> (typcha == <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>) {</div>
<div class="line"></div>
<div class="line">            valr = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) calloc(ncomp*nval*ngauss,<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>));</div>
<div class="line">            <a class="code" href="a00591_a1490910810b7b26086f3df4911027426.html#a1490910810b7b26086f3df4911027426">EXIT_IF</a>(valr == NULL,NULL,NULL);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a01048_gab65a0b4b722065772868058d8a99b4a9.html#gab65a0b4b722065772868058d8a99b4a9">MEDfield23ValueWithProfileRd</a>(fid, nomcha, numdt,numo, entite,type_geo[k],meshname,</div>
<div class="line">                                             <a class="code" href="a00853_a4590bc240c9d6d928eecc7484553c2e7.html#a4590bc240c9d6d928eecc7484553c2e7">USER_MODE</a>, pflname, stockage,<a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                           (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) valr) &lt; 0 ) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des valeurs du champ : &quot;</span>);</div>
<div class="line">              <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(nomcha);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(entite);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(type_geo[k]);</div>
<div class="line">              <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numdt);<a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numo);</div>
<div class="line">              ret = -1;</div>
<div class="line">            }</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line"></div>
<div class="line">            vale = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) calloc(ncomp*nval*ngauss,<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>));</div>
<div class="line">            <a class="code" href="a00591_a1490910810b7b26086f3df4911027426.html#a1490910810b7b26086f3df4911027426">EXIT_IF</a>(vale == NULL,NULL,NULL);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a01048_gab65a0b4b722065772868058d8a99b4a9.html#gab65a0b4b722065772868058d8a99b4a9">MEDfield23ValueWithProfileRd</a>(fid, nomcha, numdt,numo, entite,type_geo[k],meshname,</div>
<div class="line">                                           <a class="code" href="a00853_a4590bc240c9d6d928eecc7484553c2e7.html#a4590bc240c9d6d928eecc7484553c2e7">USER_MODE</a>, pflname, stockage,<a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                           (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) vale) &lt; 0 ) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des valeurs du champ : &quot;</span>);</div>
<div class="line">              <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(nomcha);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(entite);<a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(type_geo[k]);</div>
<div class="line">              <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numdt);<a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(numo);</div>
<div class="line">              ret = -1;</div>
<div class="line">            };</div>
<div class="line">          }</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> ( strlen(locname) )</div>
<div class="line">            printf(<span class="stringliteral">&quot;\t- Modèle de localisation des points de Gauss de nom |%s|\n&quot;</span>,locname);</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> (entite == <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a>)</div>
<div class="line">            ngroup = (type_geo[k] % 100);</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            ngroup = ngauss;</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">switch</span> (stockage) {</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a> :</div>
<div class="line">            printf(<span class="stringliteral">&quot;\t- Valeurs :\n\t&quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (m=0;m&lt;(nval*ngauss)/ngroup;m++) {</div>
<div class="line">              printf(<span class="stringliteral">&quot;|&quot;</span>);</div>
<div class="line">              <span class="keywordflow">for</span> (n=0;n&lt;ngroup*ncomp;n++)</div>
<div class="line">                <span class="keywordflow">if</span> (typcha == <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>)</div>
<div class="line">                  printf(<span class="stringliteral">&quot; %f &quot;</span>,*(valr+(m*ngroup*ncomp)+n));</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                  printf(<span class="stringliteral">&quot; &quot;</span>IFORMAT<span class="stringliteral">&quot; &quot;</span>,*(vale+(m*ngroup*ncomp)+n));</div>
<div class="line"></div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line">            <span class="comment">/*Affichage en fonction du profil à traiter*/</span></div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da5c7f85d1c271fe5dbaf9e9f1d3211fea">MED_NO_INTERLACE</a> :</div>
<div class="line">            printf(<span class="stringliteral">&quot;\t- Valeurs :\n\t&quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (m=0;m&lt;ncomp;m++) {</div>
<div class="line">              printf(<span class="stringliteral">&quot;|&quot;</span>);</div>
<div class="line">              <span class="keywordflow">for</span> (n=0;n&lt;(nval*ngauss);n++)</div>
<div class="line">                <span class="keywordflow">if</span> (typcha == <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>)</div>
<div class="line">                  printf(<span class="stringliteral">&quot; %f &quot;</span>,*(valr+(m*nval)+n));</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                  printf(<span class="stringliteral">&quot; &quot;</span>IFORMAT<span class="stringliteral">&quot; &quot;</span>,*(vale+(m*nval)+n));</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"></div>
<div class="line">          printf(<span class="stringliteral">&quot;|\n&quot;</span>);</div>
<div class="line">          <span class="keywordflow">if</span> (typcha == <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>) {</div>
<div class="line">            <span class="keywordflow">if</span> ( valr ) {free(valr);valr = NULL;}}</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">if</span> (vale) { free(vale);vale = NULL; }</div>
<div class="line"></div>
<div class="line">          <span class="comment">/*Lecture du profil associe */</span></div>
<div class="line">          <span class="keywordflow">if</span> (strcmp(pflname,<a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>) == 0 )</div>
<div class="line">            printf(<span class="stringliteral">&quot;\t- Profil : MED_NO_PROFILE\n&quot;</span>);</div>
<div class="line">          <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">if</span> ( (pflsize = <a class="code" href="a01057_ga2871de707744621f6a29a29633cc2e7b.html#ga2871de707744621f6a29a29633cc2e7b">MEDprofileSizeByName</a>(fid,pflname)) &lt;0 )  {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture du nombre de valeurs du profil : &quot;</span>);</div>
<div class="line">              <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(pflname);</div>
<div class="line">              ret = -1; <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            printf(<span class="stringliteral">&quot;\t- Profil : |%s| de taille &quot;</span>IFORMAT<span class="stringliteral">&quot;\n&quot;</span>,pflname,pflsize);</div>
<div class="line"></div>
<div class="line">            pflval = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*pflsize);</div>
<div class="line">            <a class="code" href="a00591_a1490910810b7b26086f3df4911027426.html#a1490910810b7b26086f3df4911027426">EXIT_IF</a>(pflval == NULL,NULL,NULL);</div>
<div class="line">            <span class="keywordflow">if</span> ( <a class="code" href="a01057_ga93bec578fad63ceaaae0d7ea511d7a3e.html#ga93bec578fad63ceaaae0d7ea511d7a3e">MEDprofileRd</a>(fid,pflname,pflval) &lt;0) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Erreur a la lecture des valeurs du profil : &quot;</span>);</div>
<div class="line">              <a class="code" href="a00591_a257959db0a78623caa051d11ceb2f8cb.html#a257959db0a78623caa051d11ceb2f8cb">SSCRUTE</a>(pflname);</div>
<div class="line">              ret = -1;</div>
<div class="line">            }</div>
<div class="line">            printf(<span class="stringliteral">&quot;\t&quot;</span>);</div>
<div class="line">            <span class="keywordflow">for</span> (m=0;m&lt;pflsize;m++) printf(<span class="stringliteral">&quot; &quot;</span>IFORMAT<span class="stringliteral">&quot; &quot;</span>,*(pflval+m));</div>
<div class="line">            printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">            free(pflval);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  } <span class="comment">/* fin for sur les mailles*/</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --><h3><a class="anchor" id="3."></a>Cr&eacute;er et lire un champ aux points d'int&eacute;gration des &eacute;l&eacute;ments </h3>
<p>MED fournit la possibilit&eacute; d'exprimer les champs de r&eacute;sultat sur les points de Gauss (ou points d'int&eacute;gration) des &eacute;l&eacute;ments d'un maillage. Dans ce cadre, il est possible de localiser ces points sur des &eacute;l&eacute;ments de r&eacute;f&eacute;rence en des lieux diff&eacute;rents selon la mod&eacute;lisation num&eacute;rique choisie. Pour chaque type de mod&eacute;lisation, il est possible de sp&eacute;cifier cette localisation sur des &eacute;l&eacute;ments de r&eacute;f&eacute;rence. On distingue diff&eacute;rentes familles de points de Gauss en fonction du nombre de points d'int&eacute;gration. Chaque point d'int&eacute;gration est localis&eacute; au sein d'un &eacute;l&eacute;ment de r&eacute;f&eacute;rence par ses coordonn&eacute;es et se voit associer un poids. </p>
<p>La localisation des points de Gauss pour un &eacute;l&eacute;ment de r&eacute;f&eacute;rence n&eacute;cessite donc de conna&icirc;tre le type g&eacute;om&eacute;trique de l'&eacute;l&eacute;ment, les coordonn&eacute;es des noeuds de l'&eacute;l&eacute;ment, les coordonn&eacute;es et le poids de chaque point de Gauss. L'expression des coordonn&eacute;es d'un &eacute;l&eacute;ment de r&eacute;f&eacute;rence peut se faire dans un rep&egrave;re de coordonn&eacute;es dont la dimension est sup&eacute;rieure &agrave; celle de l'&eacute;l&eacute;ment de r&eacute;f&eacute;rence. La r&eacute;f&eacute;rence &agrave; un &eacute;l&eacute;ment de r&eacute;f&eacute;rence se fait &agrave; l'appel des routines d'&eacute;criture et lecture des valeurs des champs. </p>
<p>Si les points de Gauss se confondent avec les noeuds de l'&eacute;l&eacute;ment, il est inutile de cr&eacute;er une localisation factice avec des poids qui ne signifient rien et des coordonn&eacute;es des points de Gauss identiques &agrave; celles des noeuds. Dans ce cas de figure, il faut utiliser le mot cl&eacute; r&eacute;serv&eacute; <a class="el" href="a00577_a873a5b8b6a795c0bb74a9a7a6f964645.html#a873a5b8b6a795c0bb74a9a7a6f964645">MED_GAUSS_ELNO</a> &agrave; l'&eacute;criture des valeurs d'un champ pour indiquer le type de localisation.</p>
<p>Il est possible pour une m&ecirc;me type g&eacute;om&eacute;trique d'&eacute;l&eacute;ment d'associer plusieurs &eacute;l&eacute;ments de r&eacute;f&eacute;rence. Il suffit pour cela d'associer chaque localisation avec un profil lors de l'appel d'&eacute;criture et lecture des valeurs des champs.</p>
<p>MED permet &eacute;galement la prise en compte des fonctions de forme et des familles d'interpolation. Une famille d'interpolation est l'ensemble d'interpolations disponibles pour un champ donn&eacute;. Chacune des interpolations est d&eacute;crite par des fonctions de forme polynomiales. Le nombre de variable des fonctions de forme est &eacute;gale &agrave; la dimension de l'espace de la maille de r&eacute;f&eacute;rence utilis&eacute;e pour le construire. Il est donc possible d'associer &agrave; un champ plusieurs interpolations d&eacute;finies sur des mailles de r&eacute;f&eacute;rence des diff&eacute;rents types g&eacute;om&eacute;triques du maillage de calcul sur lequel repose le champ de r&eacute;sultat.</p>
<p>L'&eacute;criture des fonctions de forme et des familles d'interpolation est optionnelle pour &eacute;changer des champs aux points d'int&eacute;gration. </p>
<p>A l'&eacute;criture, la cr&eacute;ation d'un &eacute;l&eacute;ment de r&eacute;f&eacute;rence se fait avec la routine <a class="el" href="a01054_ga77e9d9cfe12058f20762fe61fbf14172.html#ga77e9d9cfe12058f20762fe61fbf14172">MEDlocalizationWr</a> / <a class="el" href="a00708_a3e3019bacad60cb167ad43a7d6b2fc22.html#a3e3019bacad60cb167ad43a7d6b2fc22">mlclow</a>. Un &eacute;l&eacute;ment de r&eacute;f&eacute;rence peut &ecirc;tre associ&eacute; &agrave; une famille d'interpolation. La cr&eacute;ation d'une fonction d'interpolation se fait avec la routine <a class="el" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a> / <a class="el" href="a00681_a6043fb74b17a756d1cb0e0130560db67.html#a6043fb74b17a756d1cb0e0130560db67">mipcre</a>. L'&eacute;criture d'une fonction de forme se fait avec la routine <a class="el" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a> / <a class="el" href="a00681_a47fb2995a1a920e720901127669bddc8.html#a47fb2995a1a920e720901127669bddc8">mipbfw</a>. La routine <a class="el" href="a01048_ga7343635c63494754d239b4be551e76da.html#ga7343635c63494754d239b4be551e76da">MEDfieldInterpWr</a> / <a class="el" href="a00618_aff326bd7f644131b28f5a568b7809933.html#aff326bd7f644131b28f5a568b7809933">mfdinw</a> permet d'associer une famille d'interpolation &agrave; un champ r&eacute;sultat.</p>
<p>Le cas d'utilisation suivant montre un exemple d'&eacute;criture des valeurs des champs aux points de Gauss avec d&eacute;finition des &eacute;l&eacute;ments de r&eacute;f&eacute;rence et r&eacute;f&eacute;rence &agrave; une famille d'interpolation. </p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 10 : write a field in a MED file with computing steps,</span></div>
<div class="line"><span class="comment"> *                     profiles, integration points and interpolation families</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMPERATURE_FIELD&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentname[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMPERATURE&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;C&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tria3values_step1_profile1[9] = {1000.,1010.,1020.,</div>
<div class="line">                                                   4000.,4010.,4020.,</div>
<div class="line">                                                   8000.,8010.,8020. };</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tria3values_step2_profile1[24] = {1500.,1510.,1520.,</div>
<div class="line">                                                    0.,   0.,   0.,</div>
<div class="line">                                                    0.,   0.,   0.,</div>
<div class="line">                                                    4500.,4510,4520.,</div>
<div class="line">                                                    0.,   0.,   0.,</div>
<div class="line">                                                    0.,   0.,   0.,</div>
<div class="line">                                                    0.,   0.,   0.,</div>
<div class="line">                                                    8500., 8510, 8520 };</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tria3values_step2_profile2[32] = {   0.,   0.,   0.,  0.,</div>
<div class="line">                                                       2500.,2510.,2520,2530.,</div>
<div class="line">                                                       3500.,3510.,3520.,3530.,</div>
<div class="line">                                                       0.,   0.,   0.,  0.,</div>
<div class="line">                                                       5500.,5510.,5520.,5530.,</div>
<div class="line">                                                       6500.,6510.,6520.,6530.,</div>
<div class="line">                                                       7500.,7510.,7520.,7530.,</div>
<div class="line">                                                       0.,   0.,   0.,   0. };</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ntria3 = 8;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nquad4 = 4;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> quad4values_step1[4] = {10000., 20000., 30000., 40000.};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> quad4values_step2[4] = {15000., 25000., 35000., 45000.};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> profile1name[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MED_TRIA3_PROFILE1&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile1[3] = {1, 4, 8};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile1size = 3;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> profile2name[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MED_TRIA3_PROFILE2&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile2[5] = {2, 3, 5, 6, 7};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> profile2size = 5;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> localization1name[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;TRIA3_INTEGRATION_POINTS_3&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> weight1[3] = {1.0/6, 1.0/6, 1.0/6};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> elementcoordinate[6] = {0.0, 0.0,  1.0, 0.0,  0.0,1.0};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> ipoint1coordinate[6] = {1.0/6, 1.0/6,  2.0/3, 1.0/6,  1.0/6, 2.0/6};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> localization2name[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;TRIA3_INTEGRATION_POINTS_4&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> weight2[6] = {25.0/(24*4), 25.0/(24*4), 25.0/(24*4), -27.0/(24*4)};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> ipoint2coordinate[8] = {1.0/5, 1.0/5,  3.0/5, 1.0/5,  1.0/5, 3.0/5,  1.0/3, 1.0/3};</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nipoint, spacedim;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> interpname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MED_TRIA3 interpolation family&quot;</span>;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* file creation */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_10.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create mesh link */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01053_ga08d1c8b15fbab77a11c6b59a0c600c4e.html#ga08d1c8b15fbab77a11c6b59a0c600c4e">MEDlinkWr</a>(fid,meshname,<span class="stringliteral">&quot;./UsesCase_MEDmesh_1.med&quot;</span>) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create mesh link ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create the profiles in the file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01057_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1">MEDprofileWr</a>(fid, profile1name, profile1size, profile1 ) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create profile ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01057_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1">MEDprofileWr</a>(fid, profile2name, profile2size, profile2 ) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create profile ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create the localization elements for integration points */</span></div>
<div class="line">  spacedim = 2;</div>
<div class="line">  nipoint = 3;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01054_ga77e9d9cfe12058f20762fe61fbf14172.html#ga77e9d9cfe12058f20762fe61fbf14172">MEDlocalizationWr</a>(fid, localization1name, <a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>, spacedim,</div>
<div class="line">                        elementcoordinate, <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,</div>
<div class="line">                        nipoint, ipoint1coordinate, weight1,</div>
<div class="line">                        <a class="code" href="a00577_a3e7915fabbbc5946451ebbb836ca0816.html#a3e7915fabbbc5946451ebbb836ca0816">MED_NO_INTERPOLATION</a>, <a class="code" href="a00577_aeb44e16b6ecf0f5f8aeefab3e60a1a2c.html#aeb44e16b6ecf0f5f8aeefab3e60a1a2c">MED_NO_MESH_SUPPORT</a>) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create famlily of integration points ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  spacedim = 2;</div>
<div class="line">  nipoint = 4;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01054_ga77e9d9cfe12058f20762fe61fbf14172.html#ga77e9d9cfe12058f20762fe61fbf14172">MEDlocalizationWr</a>(fid, localization2name, <a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>, spacedim,</div>
<div class="line">                        elementcoordinate, <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>,</div>
<div class="line">                        nipoint, ipoint2coordinate, weight2,</div>
<div class="line">                        <a class="code" href="a00577_a3e7915fabbbc5946451ebbb836ca0816.html#a3e7915fabbbc5946451ebbb836ca0816">MED_NO_INTERPOLATION</a>, <a class="code" href="a00577_aeb44e16b6ecf0f5f8aeefab3e60a1a2c.html#aeb44e16b6ecf0f5f8aeefab3e60a1a2c">MED_NO_MESH_SUPPORT</a>) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create famlily of integration points ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Temperature field  creation :</span></div>
<div class="line"><span class="comment">   * - 1 component</span></div>
<div class="line"><span class="comment">   * - component unit : celsius degree</span></div>
<div class="line"><span class="comment">   * - mesh is the 2D unstructured mesh of UsecaseMEDmesh_1.c use case.</span></div>
<div class="line"><span class="comment">   * - computation step unit in &#39;ms&#39;</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_ga8f73c6eb1a1b85f5e1e8bc1823c01ab9.html#ga8f73c6eb1a1b85f5e1e8bc1823c01ab9">MEDfieldCr</a>(fid, fieldname, <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>,</div>
<div class="line">                 ncomponent, componentname, componentunit,</div>
<div class="line">                 <span class="stringliteral">&quot;ms&quot;</span>, meshname) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create field&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* write interpolation family name for MED_TRIA3 cell type */</span></div>
<div class="line">  <span class="comment">/* The interpolation family &quot;interpname&quot; is created in the UsesCase_MEDinterp_1</span></div>
<div class="line"><span class="comment">     use case */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_ga7343635c63494754d239b4be551e76da.html#ga7343635c63494754d239b4be551e76da">MEDfieldInterpWr</a>(fid,fieldname,interpname) &lt;0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field interpolation family name ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* two computation steps */</span></div>
<div class="line">  <span class="comment">/* write values at cell centers : 8 MED_TRIA3 and 4 MED_QUAD4 */</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* STEP 1 : dt1 = 5.5, it = 1*/</span></div>
<div class="line">  <span class="comment">/* MED_TRIA3 : with a profile of 3 values in compact memory storage mode</span></div>
<div class="line"><span class="comment">     and a family of 3 integration points */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 1, 1, 5.5, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>,<a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profile1name, localization1name,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 ntria3, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tria3values_step1_profile1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_TRIA3&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">   <span class="comment">/* MED_QUAD4  : with no profile */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 1, 1, 5.5, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 nquad4, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) quad4values_step1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_QUAD4 &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* STEP 2 : dt2 = 8.9, it = 1*/</span></div>
<div class="line">  <span class="comment">/* MED_TRIA3 : with a profile of 3 values then a profile of 5 values in global memory storage mode</span></div>
<div class="line"><span class="comment">   * For each profile, a family of 3 and then 4 integration points */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 2 , 1 , 8.9 , <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a>, profile1name, localization1name,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 ntria3, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tria3values_step2_profile1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_TRIA3 ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 2 , 1 , 8.9 , <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a>, profile2name, localization2name,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 ntria3, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tria3values_step2_profile2) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_TRIA3 ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* MED_QUAD4 : with no profile */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 2, 1, 8.9, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, <a class="code" href="a00577_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 nquad4, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) quad4values_step2) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_QUAD4 ... &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --><p>A la lecture, la routine <a class="el" href="a01054_gad851cf003d23c5eb44d6486a33704611.html#gad851cf003d23c5eb44d6486a33704611">MEDlocalizationInfoByName</a> / <a class="el" href="a00708_a6683562b497f7f70bc268f59ff01cbd2.html#a6683562b497f7f70bc268f59ff01cbd2">mlclni</a> permet de lire les informations relatives &agrave; un &eacute;l&eacute;ment de r&eacute;f&eacute;rence dont on conna&icirc;t le nom. Une autre possibilit&eacute; est de lire le nombre d'&eacute;l&eacute;ment de r&eacute;f&eacute;rence avec la routine <a class="el" href="a01054_ga20dffbd06dc5272536b66fc6071be154.html#ga20dffbd06dc5272536b66fc6071be154">MEDnLocalization</a> / <a class="el" href="a00708_a3349b77eb4a864520044d01ab79c5aa2.html#a3349b77eb4a864520044d01ab79c5aa2">mlcnlc</a> et d'it&eacute;rer afin de r&eacute;cup&eacute;rer &agrave; chaque it&eacute;ration les informations relatives &agrave; l'&eacute;l&eacute;ment de r&eacute;f&eacute;rence avec la routine <a class="el" href="a01054_gac03d0ad34b8c2263d77795919fd0f1a3.html#gac03d0ad34b8c2263d77795919fd0f1a3">MEDlocalizationInfo</a> / <a class="el" href="a00708_ab36033ae8452e632f1f97703f115f60e.html#ab36033ae8452e632f1f97703f115f60e">mlclci</a> et lire l'&eacute;l&eacute;ment de r&eacute;f&eacute;rence avec la routine <a class="el" href="a01054_ga613df7c12919f60dc27d49ff8f1f35a3.html#ga613df7c12919f60dc27d49ff8f1f35a3">MEDlocalizationRd</a> / <a class="el" href="a00708_abf223114658bfda32dd18b4bdf7363a5.html#abf223114658bfda32dd18b4bdf7363a5">mlclor</a>.</p>
<p>Pour les fonctions d'interpolation, la routine <a class="el" href="a01051_ga06976d46210f848ccf7f8b79b82fa516.html#ga06976d46210f848ccf7f8b79b82fa516">MEDinterpInfoByName</a> / <a class="el" href="a00681_aa7dc205e0c8064ecfa76afaf828bb42e.html#aa7dc205e0c8064ecfa76afaf828bb42e">mipiin</a> informe des caract&eacute;ristiques de la fonction d'interpolation dont on conna&icirc;t le nom. Il est &eacute;galement possible de lire le nombre de famille d'interpolation avec la routine <a class="el" href="a01051_ga926e9c439534535a36ab17ed0d531f4c.html#ga926e9c439534535a36ab17ed0d531f4c">MEDnInterp</a> / <a class="el" href="a01066_gab0bc5d8a91ff9decf980673eba3850f2.html#gab0bc5d8a91ff9decf980673eba3850f2">mipnip</a> et d'it&eacute;rer sur ces familles. Ces deux fonctions renvoie le nombre de fonctions de forme. Il reste donc &agrave; it&eacute;rer sur chacune d'entre elles et d'appeler la routine <a class="el" href="a01051_ga9bb3fc51617d624614d76cdcb309bff0.html#ga9bb3fc51617d624614d76cdcb309bff0">MEDinterpBaseFunctionRd</a> / <a class="el" href="a00681_affcbfcdc12ace78e5fdfa3d3162f8785.html#affcbfcdc12ace78e5fdfa3d3162f8785">mipbfr</a> pour lire chaque polyn&ocirc;me.</p>
<p>Dans un champ de r&eacute;sultat, il est possible de lire le nombre de famille d'interpolation associ&eacute; aux champ avec la routine <a class="el" href="a01048_gaf79d5c62ad21a6d3adeed536010c7f34.html#gaf79d5c62ad21a6d3adeed536010c7f34">MEDfieldnInterp</a> / <a class="el" href="a00618_a77ca99515e8c5a7c63dd93be92524378.html#a77ca99515e8c5a7c63dd93be92524378">mfdnin</a> . En it&eacute;rant sur toutes ces familles, on peut lire le nom de chacune d'entre elles avec la routine <a class="el" href="a01048_ga228bd9b86d5139ffb7dc622a18c27ec4.html#ga228bd9b86d5139ffb7dc622a18c27ec4">MEDfieldInterpInfo</a> / <a class="el" href="a00618_a5f118efae9186210e83f2347eddd81eb.html#a5f118efae9186210e83f2347eddd81eb">mfdini</a>.</p>
<p>Le cas d'utilisation suivant propose une approche g&eacute;n&eacute;rique pour lire des champs aux points de Gauss d&eacute;finies sur les mailles d'un maillage.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 12 : read a field (generic approach) in a MED file with computing steps,</span></div>
<div class="line"><span class="comment"> *                     profiles, integration points and interpolation families</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> nfield, i, j;</div>
<div class="line">  <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> localmesh;</div>
<div class="line">  <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a> fieldtype;</div>
<div class="line">  <span class="keywordtype">char</span> *componentname = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> *componentunit = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *values = NULL;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep, nvalues;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> csit, numit, numdt, it;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotypes = <a class="code" href="a00690_a54c2e34174a890046d0a204fa1a918a8.html#a54c2e34174a890046d0a204fa1a918a8">MED_GET_CELL_GEOMETRY_TYPE</a>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nprofile, pit, profilesize;</div>
<div class="line">  <span class="keywordtype">char</span> profilename[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nintegrationpoint;</div>
<div class="line">  <span class="keywordtype">char</span> localizationname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">int</span> k;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ninterp;</div>
<div class="line">  <span class="keywordtype">char</span> interpname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* open file */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_10.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * generic approach : how many fields in the file and identification</span></div>
<div class="line"><span class="comment">   * of each field.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((nfield = <a class="code" href="a01048_ga0d8be6c1b6b24ff150a5adcb58831d93.html#ga0d8be6c1b6b24ff150a5adcb58831d93">MEDnField</a>(fid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : How many fields in the file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * read values for each field</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;nfield; i++) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((ncomponent = <a class="code" href="a01048_gabe6258ebc74592af81c9b51379b7b7af.html#gabe6258ebc74592af81c9b51379b7b7af">MEDfieldnComponent</a>(fid,i+1)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of field component ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentname = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentunit = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01048_gaf2169b6d6505a28d7ee5f8599d2fb25e.html#gaf2169b6d6505a28d7ee5f8599d2fb25e">MEDfieldInfo</a>(fid, i+1, fieldname, meshname, &amp;localmesh, &amp;fieldtype,</div>
<div class="line">                     componentname, componentunit, dtunit, &amp;nstep) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Field info ...&quot;</span>);</div>
<div class="line">      free(componentname);</div>
<div class="line">      free(componentunit);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    free(componentname);</div>
<div class="line">    free(componentunit);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Read how many interpolation family name in the field ?</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((ninterp = <a class="code" href="a01048_gaf79d5c62ad21a6d3adeed536010c7f34.html#gaf79d5c62ad21a6d3adeed536010c7f34">MEDfieldnInterp</a>(fid, fieldname)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Read how many interpolation functions for the field ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* - Read each interlolation family name</span></div>
<div class="line"><span class="comment">     * - The way to read an interploation family and it&#39;s basis functions</span></div>
<div class="line"><span class="comment">     *  is described in UsesCase_MEDinterp_2 and UsesCase_MEDinterp_3 uses case</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">for</span> (it=0; it&lt;ninterp; it++) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01048_ga228bd9b86d5139ffb7dc622a18c27ec4.html#ga228bd9b86d5139ffb7dc622a18c27ec4">MEDfieldInterpInfo</a>(fid,fieldname,it+1,interpname) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read interpolation family name ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Read field values for each computing step</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">for</span> (csit=0; csit&lt;nstep; csit++) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01048_ga5b0031d3002518f1b2e134ff8c03dbc5.html#ga5b0031d3002518f1b2e134ff8c03dbc5">MEDfieldComputingStepInfo</a>(fid, fieldname, csit+1, &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">/*</span></div>
<div class="line"><span class="comment">       * ... In our case, we suppose that the field values are only defined on cells ...</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keywordflow">for</span> (it=1; it&lt;=<a class="code" href="a00577_abd42d91233c317ca8eb9b592e4502053.html#abd42d91233c317ca8eb9b592e4502053">MED_N_CELL_FIXED_GEO</a>; it++) {</div>
<div class="line"></div>
<div class="line">        geotype = geotypes[it];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * How many profile for each geometry type ?</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((nprofile = <a class="code" href="a01048_gab8ce8c33cfe01cbccbde8474a4c433ba.html#gab8ce8c33cfe01cbccbde8474a4c433ba">MEDfieldnProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, geotype,</div>
<div class="line">                                         profilename, localizationname)) &lt; 0) {</div>
<div class="line">          <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of profile &quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Read values for each profile</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">for</span> (pit=0; pit&lt;nprofile; pit++) {</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> ((nvalues = <a class="code" href="a01048_gaa45f3d32332f8410c35c51a77ee20740.html#gaa45f3d32332f8410c35c51a77ee20740">MEDfieldnValueWithProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, geotype,</div>
<div class="line">                                                   pit+1, <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename, &amp;profilesize,</div>
<div class="line">                                                   localizationname, &amp;nintegrationpoint)) &lt; 0) {</div>
<div class="line">            <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of values with a profile ...&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">          }</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> (nvalues) {</div>
<div class="line">            <span class="keywordflow">if</span> ((values = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nvalues*ncomponent*nintegrationpoint)) == NULL) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">              <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a01048_ga85cf40e4f76b7f6e6036445a6c6108b4.html#ga85cf40e4f76b7f6e6036445a6c6108b4">MEDfieldValueWithProfileRd</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, geotype,</div>
<div class="line">                                           <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename,</div>
<div class="line">                                           <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                           (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) values) &lt; 0) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read fields values for cells ...&quot;</span>);</div>
<div class="line">              free(values);</div>
<div class="line">              <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            free(values);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Le cas d'utilisation suivant montre un exemple de cr&eacute;ation d'une famille d'interpolation.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Interp use case 1 : write an interpolation family</span></div>
<div class="line"><span class="comment"> * In this example, the interpolation family can be used with</span></div>
<div class="line"><span class="comment"> * the TEMPERATURE field of UsesCase_MEDfield_10 use case</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <span class="keywordtype">char</span> interpname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MED_TRIA3 interpolation family&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nvariable=2;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> maxdegree=1;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmaxcoefficient=3;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>         ncoefficient1_1 = 3;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>   <span class="keyword">const</span> power1_1[]         = {0,0,1,0,0,1};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> <span class="keyword">const</span> coefficient1_1[]   = {1,-1,-1};</div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>         ncoefficient1_2 = 1;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>   <span class="keyword">const</span> power1_2[]         = {1,0};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> <span class="keyword">const</span> coefficient1_2[]   = {1};</div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>         ncoefficient1_3 = 1;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>   <span class="keyword">const</span> power1_3[]         = {0,1};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> <span class="keyword">const</span> coefficient1_3[]   = {1};</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* file creation */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDinterp_1.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* Family interpolation creation :</span></div>
<div class="line"><span class="comment">     - reference element = MED_TRIA3 </span></div>
<div class="line"><span class="comment">     - integration points of UsesCase_MEDfield_10 use case </span></div>
<div class="line"><span class="comment">     are used to build the interpolation                 </span></div>
<div class="line"><span class="comment">     - basis functions are P1(X)= 1-X1-X2, P2(X)= X1, P3(X)= X2 </span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga0ce117ef792d8e10af325a57158bf58c.html#ga0ce117ef792d8e10af325a57158bf58c">MEDinterpCr</a>(fid, interpname, <a class="code" href="a00577_a4a1eb7ba296742a6f5eb8b5b23b39670.html#a4a1eb7ba296742a6f5eb8b5b23b39670">MED_TRIA3</a>, <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>, nvariable, maxdegree, nmaxcoefficient) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : interpolation family creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Basis functions creation */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a>(fid,interpname,1,ncoefficient1_1,power1_1,coefficient1_1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : first base function creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a>(fid,interpname,2,ncoefficient1_2,power1_2,coefficient1_2) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : second base function creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a>(fid,interpname,3,ncoefficient1_3,power1_3,coefficient1_3) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : third base function creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);             </div>
<div class="line">    ret=-1; </div>
<div class="line">  } </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Le cas d'utilisation suivant montre un exemple de lecture de famille d'interpolation dont on conna&icirc;t le nom.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Interp use case 2 : read an interpolation family with a direct access by name</span></div>
<div class="line"><span class="comment"> * In this example, the interpolation family can be used with</span></div>
<div class="line"><span class="comment"> * the TEMPERATURE field of UsesCase_MEDfield_10 use case</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> interpname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;MED_TRIA3 interpolation family&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype                    =<a class="code" href="a00577_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a>          cellnodes                  =<a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           nbasisfunc              =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           nvariable               =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           maxdegree                  =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           nmaxcoefficient            =0;</div>
<div class="line">  <span class="keywordtype">int</span>               basisfuncit                =0;</div>
<div class="line">  <span class="keywordtype">int</span>               powerit                    =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           ncoefficient            =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*          power                      =NULL;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*        coefficient                =NULL;</div>
<div class="line">  <span class="keywordtype">int</span>               coefficientit              =0;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* file creation */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDinterp_1.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* with direct access by the family name */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga06976d46210f848ccf7f8b79b82fa516.html#ga06976d46210f848ccf7f8b79b82fa516">MEDinterpInfoByName</a>(fid,interpname,&amp;geotype,&amp;cellnodes,&amp;nbasisfunc,</div>
<div class="line">                          &amp;nvariable,&amp;maxdegree,&amp;nmaxcoefficient) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : interpolation function information ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read each basis function */</span></div>
<div class="line">  <span class="keywordflow">for</span> ( basisfuncit=1; basisfuncit&lt;= nbasisfunc; ++basisfuncit) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((ncoefficient = <a class="code" href="a01051_ga39b5f9f4822173655561a8e558bc9745.html#ga39b5f9f4822173655561a8e558bc9745">MEDinterpBaseFunctionCoefSize</a>(fid,interpname,basisfuncit) ) &lt;0 ) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of coefficient in the base function ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    coefficient = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) calloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>),ncoefficient);</div>
<div class="line">    power       = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*)   calloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>),nvariable*ncoefficient);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01051_ga9bb3fc51617d624614d76cdcb309bff0.html#ga9bb3fc51617d624614d76cdcb309bff0">MEDinterpBaseFunctionRd</a>(fid,interpname,basisfuncit,&amp;ncoefficient,power,coefficient) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read base function ...&quot;</span>);</div>
<div class="line">      free(coefficient); free(power);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    free(coefficient);</div>
<div class="line">    free(power);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);             </div>
<div class="line">    ret=-1; </div>
<div class="line">  } </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Le cas d'utilisation suivant montre un exemple de lecture de famille d'interpolation par une approche it&eacute;rative.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Interp use case 1 : read an interpolation family with a generic access by an iterator.</span></div>
<div class="line"><span class="comment"> * In this example, the interpolation family can be used with</span></div>
<div class="line"><span class="comment"> * the TEMPERATURE field of UsesCase_MEDfield_10 use case</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <span class="keywordtype">char</span>              interpname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           ninterp                    =0;</div>
<div class="line">  <span class="keywordtype">int</span>               it                         =0;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype                    =<a class="code" href="a00577_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a>          cellnodes                  =<a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           nbasisfunc              =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           nvariable               =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           maxdegree                  =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           nmaxcoefficient            =0;</div>
<div class="line">  <span class="keywordtype">int</span>               basisfuncit                =0;</div>
<div class="line">  <span class="keywordtype">int</span>               powerit                    =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>           ncoefficient            =0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*          power                      =NULL;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*        coefficient                =NULL;</div>
<div class="line">  <span class="keywordtype">int</span>               coefficientit              =0;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* file creation */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDinterp_1.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* how many interpolation family in the file ? */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((ninterp = <a class="code" href="a01051_ga926e9c439534535a36ab17ed0d531f4c.html#ga926e9c439534535a36ab17ed0d531f4c">MEDnInterp</a>(fid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of interpolation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* read each interpolation family */</span></div>
<div class="line">  <span class="comment">/* with an access by an iterator */</span></div>
<div class="line">  <span class="keywordflow">for</span> (it=1; it&lt;= ninterp; it++) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01051_ga9627e71ada4bcf04274dce8b0c0d0c7a.html#ga9627e71ada4bcf04274dce8b0c0d0c7a">MEDinterpInfo</a>(fid,it,interpname,&amp;geotype,&amp;cellnodes,&amp;nbasisfunc,</div>
<div class="line">                      &amp;nvariable,&amp;maxdegree,&amp;nmaxcoefficient) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : interpolation function information ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* read each basis function */</span></div>
<div class="line">    <span class="keywordflow">for</span> ( basisfuncit=1; basisfuncit&lt;= nbasisfunc; ++basisfuncit) {</div>
<div class="line">      <span class="keywordflow">if</span> ((ncoefficient = <a class="code" href="a01051_ga39b5f9f4822173655561a8e558bc9745.html#ga39b5f9f4822173655561a8e558bc9745">MEDinterpBaseFunctionCoefSize</a>(fid,interpname,basisfuncit) ) &lt;0 ) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of coefficient in the base function ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line">      </div>
<div class="line">      coefficient = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) calloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>),ncoefficient);</div>
<div class="line">      power       = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*)   calloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>),nvariable*ncoefficient);</div>
<div class="line">      </div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01051_ga9bb3fc51617d624614d76cdcb309bff0.html#ga9bb3fc51617d624614d76cdcb309bff0">MEDinterpBaseFunctionRd</a>(fid,interpname,basisfuncit,&amp;ncoefficient,power,coefficient) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read base function ...&quot;</span>);</div>
<div class="line">        free(coefficient); free(power);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      free(coefficient);</div>
<div class="line">      free(power);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line">  </div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);             </div>
<div class="line">    ret=-1; </div>
<div class="line">  } </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="4."></a>Cr&eacute;er et lire un champ aux noeuds des &eacute;l&eacute;ments</h3>
<p>MED permet d'&eacute;crire et lire des champs aux noeuds des &eacute;l&eacute;ments d'un maillage. Pour cela, il suffit d'indiquer le mot cl&eacute; <a class="el" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a> comme type d'entit&eacute; lors de l'appel des routines d'&eacute;criture / lecture des valeurs des champs comme le montrent les deux cas d'utilisation suivants.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 13 : write a field on nodes elements in a MED file</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;2D unstructured mesh&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMPERATURE_FIELD&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent = 1;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentname[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMPERATURE&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;C&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nquad4 = 4;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> quad4values_step1[4*4] = { 10000.,  20000.,  30000.,  40000.,</div>
<div class="line">                                             50000.,  60000.,  70000.,  80000.,</div>
<div class="line">                                             90000., 100000., 110000., 120000.,</div>
<div class="line">                                             130000., 140000., 150000., 160000. };</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> quad4values_step2[4*4] = { 100.,  200.,  300.,  400.,</div>
<div class="line">                                             500.,  600.,  700.,  800.,</div>
<div class="line">                                             900., 1000., 1100., 1200.,</div>
<div class="line">                                             1300., 1400., 1500., 1600. };</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* file creation */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_13.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create mesh link */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01053_ga08d1c8b15fbab77a11c6b59a0c600c4e.html#ga08d1c8b15fbab77a11c6b59a0c600c4e">MEDlinkWr</a>(fid,meshname,<span class="stringliteral">&quot;./UsesCase_MEDmesh_1.med&quot;</span>) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create mesh link ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Temperature field  creation :</span></div>
<div class="line"><span class="comment">   * - 1 component</span></div>
<div class="line"><span class="comment">   * - component unit : celsius degree</span></div>
<div class="line"><span class="comment">   * - mesh is the 2D unstructured mesh of UsecaseMEDmesh_1.c use case.</span></div>
<div class="line"><span class="comment">   * - computation step unit in &#39;ms&#39;</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_ga8f73c6eb1a1b85f5e1e8bc1823c01ab9.html#ga8f73c6eb1a1b85f5e1e8bc1823c01ab9">MEDfieldCr</a>(fid, fieldname, <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>,</div>
<div class="line">                 ncomponent, componentname, componentunit,</div>
<div class="line">                 <span class="stringliteral">&quot;ms&quot;</span>, meshname) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create field&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* two computation steps */</span></div>
<div class="line">  <span class="comment">/* write values at nodes elements : 4 MED_QUAD4 */</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* STEP 1 : dt1 = 5.5, it = 1*/</span></div>
<div class="line">  <span class="comment">/* MED_QUAD4  : with no profile */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 1, 1, 5.5, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a>, <a class="code" href="a00577_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 nquad4, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) quad4values_step1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_QUAD4 &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* STEP 2 : dt2 = 8.9, it = 1*/</span></div>
<div class="line">  <span class="comment">/* MED_QUAD4 : with no profile */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, 2, 1, 8.9, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a>, <a class="code" href="a00577_a24ea9c52f5bde41d9a072925249ec06c.html#a24ea9c52f5bde41d9a072925249ec06c">MED_QUAD4</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 nquad4, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) quad4values_step2) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_QUAD4 ... &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 14 : read a field on nodes elements (generic approach) in a MED file</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid;</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> nfield, i, j;</div>
<div class="line">  <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> localmesh;</div>
<div class="line">  <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a> fieldtype;</div>
<div class="line">  <span class="keywordtype">char</span> *componentname = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> *componentunit = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *values = NULL;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep, nvalues;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> csit, numit, numdt, it;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotypes = <a class="code" href="a00690_a54c2e34174a890046d0a204fa1a918a8.html#a54c2e34174a890046d0a204fa1a918a8">MED_GET_CELL_GEOMETRY_TYPE</a>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nprofile, pit, profilesize;</div>
<div class="line">  <span class="keywordtype">char</span> profilename[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nintegrationpoint;</div>
<div class="line">  <span class="keywordtype">char</span> localizationname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">int</span> k;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* open file */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_13.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * generic approach : how many fields in the file and identification</span></div>
<div class="line"><span class="comment">   * of each field.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((nfield = <a class="code" href="a01048_ga0d8be6c1b6b24ff150a5adcb58831d93.html#ga0d8be6c1b6b24ff150a5adcb58831d93">MEDnField</a>(fid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : How many fields in the file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * read values for each field</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;nfield; i++) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((ncomponent = <a class="code" href="a01048_gabe6258ebc74592af81c9b51379b7b7af.html#gabe6258ebc74592af81c9b51379b7b7af">MEDfieldnComponent</a>(fid,i+1)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of field component ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentname = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentunit = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01048_gaf2169b6d6505a28d7ee5f8599d2fb25e.html#gaf2169b6d6505a28d7ee5f8599d2fb25e">MEDfieldInfo</a>(fid, i+1, fieldname, meshname, &amp;localmesh, &amp;fieldtype,</div>
<div class="line">                     componentname, componentunit, dtunit, &amp;nstep) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Field info ...&quot;</span>);</div>
<div class="line">      free(componentname);</div>
<div class="line">      free(componentunit);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    free(componentname);</div>
<div class="line">    free(componentunit);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Read field values for each computing step</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">for</span> (csit=0; csit&lt;nstep; csit++) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01048_ga5b0031d3002518f1b2e134ff8c03dbc5.html#ga5b0031d3002518f1b2e134ff8c03dbc5">MEDfieldComputingStepInfo</a>(fid, fieldname, csit+1, &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">/*</span></div>
<div class="line"><span class="comment">       * ... In our case, we suppose that the field values are only defined on nodes element ...</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keywordflow">for</span> (it=1; it&lt;= <a class="code" href="a00577_abd42d91233c317ca8eb9b592e4502053.html#abd42d91233c317ca8eb9b592e4502053">MED_N_CELL_FIXED_GEO</a>; it++) {</div>
<div class="line"></div>
<div class="line">        geotype = geotypes[it];</div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * How many profile for each geometry type ?</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((nprofile = <a class="code" href="a01048_gab8ce8c33cfe01cbccbde8474a4c433ba.html#gab8ce8c33cfe01cbccbde8474a4c433ba">MEDfieldnProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a>, geotype,</div>
<div class="line">                                         profilename, localizationname)) &lt; 0) {</div>
<div class="line">          <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of profile &quot;</span>);</div>
<div class="line">          <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * Read values for each profile</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">for</span> (pit=0; pit&lt;nprofile; pit++) {</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> ((nvalues = <a class="code" href="a01048_gaa45f3d32332f8410c35c51a77ee20740.html#gaa45f3d32332f8410c35c51a77ee20740">MEDfieldnValueWithProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a>, geotype,</div>
<div class="line">                                                   pit+1, <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename, &amp;profilesize,</div>
<div class="line">                                                   localizationname, &amp;nintegrationpoint)) &lt; 0) {</div>
<div class="line">            <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of values with a profile ...&quot;</span>);</div>
<div class="line">            <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">          }</div>
<div class="line"></div>
<div class="line">          <span class="keywordflow">if</span> (nvalues) {</div>
<div class="line">            <span class="keywordflow">if</span> ((values = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nvalues*ncomponent*nintegrationpoint)) == NULL) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">              <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a01048_ga85cf40e4f76b7f6e6036445a6c6108b4.html#ga85cf40e4f76b7f6e6036445a6c6108b4">MEDfieldValueWithProfileRd</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a809ee1b85589bf7c0cf796b7212abc25">MED_NODE_ELEMENT</a>, geotype,</div>
<div class="line">                                           <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename,</div>
<div class="line">                                           <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                           (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) values) &lt; 0) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read fields values for node elements ...&quot;</span>);</div>
<div class="line">              free(values);</div>
<div class="line">              <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">            }</div>
<div class="line">            free(values);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><h3 style="page-break-before: always"><a class="anchor" id="5."></a>Cr&eacute;er et lire un champ li&eacute; &agrave; un maillage contenant des &eacute;l&eacute;ments de structure </h3>
<p>Au m&ecirc;me titre que pour types d'&eacute;l&eacute;ments pr&eacute;-d&eacute;finis dans le mod&egrave;le MED, MED permet l'&eacute;criture et la lecture de champs sur les &eacute;l&eacute;ments de structure. Pour cela, il suffit d'indiquer le mot cl&eacute; <a class="el" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a> comme type d'entit&eacute; lors de l'appel des routines d'&eacute;criture / lecture des valeurs des champs comme le montrent les deux cas d'utilisation suivants.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 15 : write a field in a MED file with</span></div>
<div class="line"><span class="comment"> * values defined on struct elements</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid=0,mfid=0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;COMPUT_MESH&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;SPEED&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent = 3;</div>
<div class="line">  <span class="comment">/*                                              123456789012345612345678901234561234567890123456 */</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentname[3*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;Vx              Vy              Vz&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentunit[3*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;m/s             m/s             m/s&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype=<a class="code" href="a00577_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> npart = 3;</div>
<div class="line">  <span class="keywordtype">char</span> structelementname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> part_speed1[3*3] = { 1.1, 2.2, 3.3,</div>
<div class="line">                                 4.4, 5.5, 6.6,</div>
<div class="line">                                 7.7, 8.8, 9.9 };</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* File creation to write the field */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_15.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Create mesh link */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01053_ga08d1c8b15fbab77a11c6b59a0c600c4e.html#ga08d1c8b15fbab77a11c6b59a0c600c4e">MEDlinkWr</a>(fid,meshname,<span class="stringliteral">&quot;./UsesCase_MEDstructElement_1.med&quot;</span>) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create mesh link ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Read struct element geometric type</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> (( mfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  strcpy(structelementname,<a class="code" href="a00577_a786e7850e4d89a31047496e6fd48476d.html#a786e7850e4d89a31047496e6fd48476d">MED_PARTICLE_NAME</a>);</div>
<div class="line">  geotype = <a class="code" href="a01058_gaf49779dbddeb78a562de0f913d3d087c.html#gaf49779dbddeb78a562de0f913d3d087c">MEDstructElementGeotype</a>(fid,structelementname);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Speed field  creation for particles :</span></div>
<div class="line"><span class="comment">   * - 3 component</span></div>
<div class="line"><span class="comment">   * - component unit : m/s</span></div>
<div class="line"><span class="comment">   * - mesh is the 3D computation mesh of UsesCase_MEDstructElement_1 use case.</span></div>
<div class="line"><span class="comment">   * - computation step unit in &#39;ms&#39;</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_ga8f73c6eb1a1b85f5e1e8bc1823c01ab9.html#ga8f73c6eb1a1b85f5e1e8bc1823c01ab9">MEDfieldCr</a>(fid, fieldname, <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>,</div>
<div class="line">                 ncomponent, componentname, componentunit,</div>
<div class="line">                 <span class="stringliteral">&quot;ms&quot;</span>, meshname) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create field&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, <a class="code" href="a00577_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00577_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00577_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype,</div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, <a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 npart, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) part_speed1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_PARTICLE &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, mfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* </span></div>
<div class="line"><span class="comment"> * Field use case 16 : read a field (generic approach) in a MED file with </span></div>
<div class="line"><span class="comment"> * - values defined on struct elements</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid,mfid,sfid;</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> nfield, i, j;</div>
<div class="line">  <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> localmesh;</div>
<div class="line">  <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a> fieldtype;</div>
<div class="line">  <span class="keywordtype">char</span> *componentname = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> *componentunit = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *values = NULL;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep, nvalues;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> csit, numit, numdt, it;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotypes, geotype;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmodels;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nprofile, pit, profilesize;</div>
<div class="line">  <span class="keywordtype">char</span> profilename[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nintegrationpoint;</div>
<div class="line">  <span class="keywordtype">char</span> localizationname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">int</span> k;</div>
<div class="line">  <span class="keywordtype">char</span> elementname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];</div>
<div class="line">  <span class="keywordtype">char</span> supportmeshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];</div>
<div class="line">  <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> entitype;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> elementdim;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnode,ncell;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geocelltype;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> anyprofile=0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nconstatt, *nvaratt;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* open file */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_15.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85ab53f10a6b700d1087d7a50710fe29f00">MED_ACC_RDWR</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (( mfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648aacc8c82fc9fded29cf134979f0379a06">MED_MESH_SUPPORT</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (( sfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* How many struct element models ? */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((nmodels =  <a class="code" href="a01058_ga09f7085855b24af662c32291d0816a59.html#ga09f7085855b24af662c32291d0816a59">MEDnStructElement</a>(mfid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of struct element models ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">  geotypes = (<a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a>)*nmodels);</div>
<div class="line">  nvaratt = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nmodels);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (it=0; it&lt;nmodels; it++) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01058_ga6caf4937712d2a1d39ab1fd1482f61a3.html#ga6caf4937712d2a1d39ab1fd1482f61a3">MEDstructElementInfo</a>(mfid, it+1, elementname, geotypes+it, &amp;elementdim,</div>
<div class="line">                             supportmeshname, &amp;entitype, &amp;nnode, &amp;ncell,</div>
<div class="line">                             &amp;geocelltype, &amp;nconstatt, &amp;anyprofile, nvaratt+it) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : struct element models information ...&quot;</span>);</div>
<div class="line">      free(nvaratt);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  free(nvaratt);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * generic approach : how many fields in the file and identification</span></div>
<div class="line"><span class="comment">   * of each field.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((nfield = <a class="code" href="a01048_ga0d8be6c1b6b24ff150a5adcb58831d93.html#ga0d8be6c1b6b24ff150a5adcb58831d93">MEDnField</a>(fid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : How many fields in the file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * read values for each field</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;nfield; i++) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((ncomponent = <a class="code" href="a01048_gabe6258ebc74592af81c9b51379b7b7af.html#gabe6258ebc74592af81c9b51379b7b7af">MEDfieldnComponent</a>(fid,i+1)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of field component ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ((componentname = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentunit = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01048_gaf2169b6d6505a28d7ee5f8599d2fb25e.html#gaf2169b6d6505a28d7ee5f8599d2fb25e">MEDfieldInfo</a>(fid, i+1, fieldname, meshname, &amp;localmesh, &amp;fieldtype,</div>
<div class="line">                     componentname, componentunit, dtunit, &amp;nstep) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Field info ...&quot;</span>);</div>
<div class="line">      free(componentname);</div>
<div class="line">      free(componentunit);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    free(componentname);</div>
<div class="line">    free(componentunit);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Read field values for each computing step </span></div>
<div class="line"><span class="comment">     */</span> </div>
<div class="line">    <span class="keywordflow">for</span> (csit=0; csit&lt;nstep; csit++) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01048_ga5b0031d3002518f1b2e134ff8c03dbc5.html#ga5b0031d3002518f1b2e134ff8c03dbc5">MEDfieldComputingStepInfo</a>(fid, fieldname, csit+1, &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">/* </span></div>
<div class="line"><span class="comment">       * ... In our case, we suppose that the field values are only defined on struct element ... </span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keywordflow">for</span> (it=0; it&lt;nmodels; it++) {</div>
<div class="line"></div>
<div class="line">        geotype = *(geotypes+it);</div>
<div class="line">     </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * How many profile for each geometry type ? </span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((nprofile = <a class="code" href="a01048_gab8ce8c33cfe01cbccbde8474a4c433ba.html#gab8ce8c33cfe01cbccbde8474a4c433ba">MEDfieldnProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype,</div>
<div class="line">                                         profilename, localizationname)) &lt; 0) {</div>
<div class="line">          <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of profile &quot;</span>);</div>
<div class="line">          <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">        }</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* </span></div>
<div class="line"><span class="comment">         * Read values for each profile</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">for</span> (pit=0; pit&lt;nprofile; pit++) {</div>
<div class="line">          </div>
<div class="line">          <span class="keywordflow">if</span> ((nvalues = <a class="code" href="a01048_gaa45f3d32332f8410c35c51a77ee20740.html#gaa45f3d32332f8410c35c51a77ee20740">MEDfieldnValueWithProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype,</div>
<div class="line">                                                   pit+1, <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename, &amp;profilesize,</div>
<div class="line">                                                   localizationname, &amp;nintegrationpoint)) &lt; 0) {</div>
<div class="line">            <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of values with a profile ...&quot;</span>);</div>
<div class="line">            <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">          } </div>
<div class="line">          </div>
<div class="line">          <span class="keywordflow">if</span> (nvalues) {</div>
<div class="line">            <span class="keywordflow">if</span> ((values = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nvalues*ncomponent*nintegrationpoint)) == NULL) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">              <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a01048_ga85cf40e4f76b7f6e6036445a6c6108b4.html#ga85cf40e4f76b7f6e6036445a6c6108b4">MEDfieldValueWithProfileRd</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype,</div>
<div class="line">                                           <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename,</div>
<div class="line">                                           <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, </div>
<div class="line">                                           (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) values) &lt; 0) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read fields values for cells ...&quot;</span>); </div>
<div class="line">              <span class="keywordflow">goto</span> ERROR; </div>
<div class="line">              free(values);</div>
<div class="line">            }  </div>
<div class="line">            free(values);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR :</div>
<div class="line"></div>
<div class="line">  free(geotypes);</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, sfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, mfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648aacc8c82fc9fded29cf134979f0379a06">MED_MESH_SUPPORT</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    ret= -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);             </div>
<div class="line">    ret= -1; </div>
<div class="line">  } </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Il est &eacute;galement possible de d&eacute;finir des champs aux points d'int&eacute;gration des &eacute;l&eacute;ments de structure. Dans ce cas l&agrave;, l'&eacute;l&eacute;ment de r&eacute;f&eacute;rence est d&eacute;j&agrave; d&eacute;crit &agrave; la d&eacute;finition de l'&eacute;l&eacute;ment de structure. Les coordonn&eacute;es des points d'int&eacute;gration y sont relatives. Il est possible d'indiquer l'utilisation d'un maillage support d&eacute;finissant une section du mod&egrave;le d'&eacute;l&eacute;ment de structure. Ce maillage support est alors utilis&eacute; comme section de l'&eacute;l&eacute;ment de structure &agrave; chaque point d'int&eacute;gration. Auquel cas un champ utilisant cette localisation d&eacute;finira autant de valeur par &eacute;l&eacute;ment qu'il y a de maille dans le maillage section de chaque point d'int&eacute;gration comme montrent les deux cas d'utilisation suivants.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Field use case 17 : write a field in a MED file with </span></div>
<div class="line"><span class="comment"> *                     values defined on integration points</span></div>
<div class="line"><span class="comment"> *                     on struct elements </span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid=0,mfid=0,sfid=0;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> spacedim = 3;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;COMPUT_MESH&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMPERATURE&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent = 1;</div>
<div class="line">  <span class="comment">/*                                      1234567890123456123456*/</span>   </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentname[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;TEMP            &quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> componentunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;CELSIUS         &quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geotype=<a class="code" href="a00577_a9a2843c7d6eacffdd9377b5bfb8a6de3.html#a9a2843c7d6eacffdd9377b5bfb8a6de3">MED_NONE</a>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nbeam = 1;</div>
<div class="line">  <span class="keywordtype">char</span> structelementname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> tempvalue[3*1*4] = { 1.1, 2.2, 3.3, 4.4, </div>
<div class="line">                                       5.5, 6.6, 7.7, 8.8, </div>
<div class="line">                                       9.9, 10.1,11.11, 12.12};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> localization[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;BEAM_INTEGRATION_POINTS&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> localization2[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;BEAM_INTEGRATION_TRANSF&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> elementcoordinate[3*3] = { 0.0,0.0,0.0,</div>
<div class="line">                                             0.0,0.0,0.0,</div>
<div class="line">                                             0.0,0.0,0.0,};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> ipointcoordinate[3*3] = { 0.0,0.0,2.5,</div>
<div class="line">                                            0.0,0.0,3.5,</div>
<div class="line">                                            0.0,0.0,4.5};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> weight[4] = {1.0/4, 1.0/4, 1.0/4, 1.0/4};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> beamsectionname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;BEAM_SECTION_MESH&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nipoint = 3;</div>
<div class="line">  <span class="keywordtype">char</span> interpname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1] = <span class="stringliteral">&quot;geometrical transformation&quot;</span>;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nvariable=2;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> maxdegree=1;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmaxcoefficient=3;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>         ncoefficient1_1 = 3;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>   <span class="keyword">const</span> power1_1[]         = {0,0,1,0,0,1};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> <span class="keyword">const</span> coefficient1_1[]   = {1,-1,-1};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>         ncoefficient1_2 = 1;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>   <span class="keyword">const</span> power1_2[]         = {1,0};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> <span class="keyword">const</span> coefficient1_2[]   = {1};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>         ncoefficient1_3 = 1;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>   <span class="keyword">const</span> power1_3[]         = {0,1};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> <span class="keyword">const</span> coefficient1_3[]   = {1};</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Open file to write the field */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_17.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85aa23dd1c18b596924d5f50c8402b84c8e">MED_ACC_CREAT</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (( mfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648aacc8c82fc9fded29cf134979f0379a06">MED_MESH_SUPPORT</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (( sfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Create mesh link */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01053_ga08d1c8b15fbab77a11c6b59a0c600c4e.html#ga08d1c8b15fbab77a11c6b59a0c600c4e">MEDlinkWr</a>(fid,meshname,<span class="stringliteral">&quot;./UsesCase_MEDstructElement_1.med&quot;</span>) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create mesh link ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Read struct element geometric type</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  strcpy(structelementname,<a class="code" href="a00577_a738baa2a243efa4f2e957c2a75b616c1.html#a738baa2a243efa4f2e957c2a75b616c1">MED_BEAM_NAME</a>);</div>
<div class="line">  geotype = <a class="code" href="a01058_gaf49779dbddeb78a562de0f913d3d087c.html#gaf49779dbddeb78a562de0f913d3d087c">MEDstructElementGeotype</a>(fid,structelementname);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create a geometrical transformation fonction */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga0ce117ef792d8e10af325a57158bf58c.html#ga0ce117ef792d8e10af325a57158bf58c">MEDinterpCr</a>(fid, interpname, geotype, <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190deea30b70cc2a253ed4141db9a78ba696046">MED_FALSE</a>, nvariable, maxdegree, nmaxcoefficient) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : interpolation family creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">/* Basis functions creation */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a>(fid,interpname,1,ncoefficient1_1,power1_1,coefficient1_1) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : first base function creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a>(fid,interpname,2,ncoefficient1_2,power1_2,coefficient1_2) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : second base function creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01051_ga092f59b381b4374b4225e947ca64a31d.html#ga092f59b381b4374b4225e947ca64a31d">MEDinterpBaseFunctionWr</a>(fid,interpname,3,ncoefficient1_3,power1_3,coefficient1_3) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : third base function creation ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* create the families of integration points </span></div>
<div class="line"><span class="comment">     for the struct element */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01054_ga77e9d9cfe12058f20762fe61fbf14172.html#ga77e9d9cfe12058f20762fe61fbf14172">MEDlocalizationWr</a>(fid, localization, geotype, spacedim, </div>
<div class="line">                        elementcoordinate, <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, </div>
<div class="line">                        nipoint, ipointcoordinate, weight, </div>
<div class="line">                        <a class="code" href="a00577_a3e7915fabbbc5946451ebbb836ca0816.html#a3e7915fabbbc5946451ebbb836ca0816">MED_NO_INTERPOLATION</a>, beamsectionname) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create famlily of integration points ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR; </div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01054_ga77e9d9cfe12058f20762fe61fbf14172.html#ga77e9d9cfe12058f20762fe61fbf14172">MEDlocalizationWr</a>(fid, localization2, geotype, spacedim, </div>
<div class="line">                        elementcoordinate, <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, </div>
<div class="line">                        nipoint, ipointcoordinate, weight, </div>
<div class="line">                        interpname, beamsectionname) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create famlily of integration points ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR; </div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * Temperature  field creation for beam struct element :</span></div>
<div class="line"><span class="comment">   * - 1 component, 3 integration points, 4 cells in the support mesh for each </span></div>
<div class="line"><span class="comment">   *   the section of each integration point </span></div>
<div class="line"><span class="comment">   * - mesh is the 3D computation mesh of UsesCase_MEDstructElement_1 use case.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_ga8f73c6eb1a1b85f5e1e8bc1823c01ab9.html#ga8f73c6eb1a1b85f5e1e8bc1823c01ab9">MEDfieldCr</a>(fid, fieldname, <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>,</div>
<div class="line">                 ncomponent, componentname, componentunit,</div>
<div class="line">                 <span class="stringliteral">&quot;ms&quot;</span>, meshname) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : create field&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, <a class="code" href="a00577_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00577_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00577_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>, </div>
<div class="line">                                 <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype, </div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, localization,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 nbeam, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tempvalue) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_BEAM &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01048_gac369c1fc64c95923cadfc39e41ea8f8d.html#gac369c1fc64c95923cadfc39e41ea8f8d">MEDfieldValueWithProfileWr</a>(fid, fieldname, <a class="code" href="a00577_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, 1, <a class="code" href="a00577_a609885580ce660eb5b7c80074d64f93f.html#a609885580ce660eb5b7c80074d64f93f">MED_UNDEF_DT</a>, </div>
<div class="line">                                 <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype, </div>
<div class="line">                                 <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, <a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>, localization2,</div>
<div class="line">                                 <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>,</div>
<div class="line">                                 nbeam, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) tempvalue) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : write field values on MED_BEAM &quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* unmount file objects */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, mfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648aacc8c82fc9fded29cf134979f0379a06">MED_MESH_SUPPORT</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, sfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  ret=0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00591.html">med_utils.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* </span></div>
<div class="line"><span class="comment"> * Field use case 18 : read a field (generic approach) in a MED file with</span></div>
<div class="line"><span class="comment"> *                     values defined on integration points on struct elements</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> fid,mfid,sfid,cmfid;</div>
<div class="line">  <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a> nfield, i, j;</div>
<div class="line">  <span class="keywordtype">char</span> meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> localmesh;</div>
<div class="line">  <span class="keywordtype">char</span> fieldname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cd">med_field_type</a> fieldtype;</div>
<div class="line">  <span class="keywordtype">char</span> *componentname = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> *componentunit = NULL;</div>
<div class="line">  <span class="keywordtype">char</span> dtunit[<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *values = NULL;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nstep, nvalues;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> ncomponent;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> csit, numit, numdt, it;</div>
<div class="line">  <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> dt;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *geotypes=NULL, geotype;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nmodels;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nprofile, pit, profilesize;</div>
<div class="line">  <span class="keywordtype">char</span> profilename[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nintegrationpoint;</div>
<div class="line">  <span class="keywordtype">char</span> localizationname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">int</span> k;</div>
<div class="line">  <span class="keywordtype">char</span> elementname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <span class="keywordtype">char</span> supportmeshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470">med_entity_type</a> entitype;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> elementdim;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nnode,ncell;</div>
<div class="line">  <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> geocelltype;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> anyprofile=0;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nconstatt, *nvaratt=NULL;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> coordinatechangement;</div>
<div class="line">  <a class="code" href="a00577_a23f7fa6d76886ed3c91dc33b59190dee.html#a23f7fa6d76886ed3c91dc33b59190dee">med_bool</a> geotransformation;</div>
<div class="line">  <span class="keywordtype">int</span> ret=-1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* open file */</span></div>
<div class="line">  fid = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(<span class="stringliteral">&quot;UsesCase_MEDfield_17.med&quot;</span>,<a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85ab53f10a6b700d1087d7a50710fe29f00">MED_ACC_RDWR</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (fid &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : open file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (( mfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648aacc8c82fc9fded29cf134979f0379a06">MED_MESH_SUPPORT</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (( sfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (( cmfid=<a class="code" href="a01049_ga48b7eb3761d58928eb0e0b12d481e05a.html#ga48b7eb3761d58928eb0e0b12d481e05a">MEDfileObjectsMount</a>(fid,  <span class="stringliteral">&quot;UsesCase_MEDstructElement_1.med&quot;</span>,<a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a741065b9e55fc3dc2ca055b74461adc9">MED_MESH</a>)) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file mounting ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * generic approach : how many fields in the file and identification</span></div>
<div class="line"><span class="comment">   * of each field.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">if</span> ((nfield = <a class="code" href="a01048_ga0d8be6c1b6b24ff150a5adcb58831d93.html#ga0d8be6c1b6b24ff150a5adcb58831d93">MEDnField</a>(fid)) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : How many fields in the file ...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*</span></div>
<div class="line"><span class="comment">   * read values for each field</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keywordflow">for</span> (i=0; i&lt;nfield; i++) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((ncomponent = <a class="code" href="a01048_gabe6258ebc74592af81c9b51379b7b7af.html#gabe6258ebc74592af81c9b51379b7b7af">MEDfieldnComponent</a>(fid,i+1)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of field component ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span> ((componentname = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ((componentunit = (<span class="keywordtype">char</span> *) malloc(ncomponent*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)) == NULL) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01048_gaf2169b6d6505a28d7ee5f8599d2fb25e.html#gaf2169b6d6505a28d7ee5f8599d2fb25e">MEDfieldInfo</a>(fid, i+1, fieldname, meshname, &amp;localmesh, &amp;fieldtype,</div>
<div class="line">                     componentname, componentunit, dtunit, &amp;nstep) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Field info ...&quot;</span>);</div>
<div class="line">      free(componentname);</div>
<div class="line">      free(componentunit);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    free(componentname);</div>
<div class="line">    free(componentunit);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* read how many struct element models in the mesh ? */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((nmodels = <a class="code" href="a01055_ga45758103360dacf7b8a6c53ebfa4d7e5.html#ga45758103360dacf7b8a6c53ebfa4d7e5">MEDmeshnEntity</a>(fid, meshname, <a class="code" href="a00577_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>, <a class="code" href="a00577_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, <a class="code" href="a00577_ad9a7aaf0f9d302fa8e22f98cb8fe0371.html#ad9a7aaf0f9d302fa8e22f98cb8fe0371">MED_GEO_ALL</a>,</div>
<div class="line">                                  <a class="code" href="a00577_a25ee4b3675737fc23511b28b3245c61b.html#a25ee4b3675737fc23511b28b3245c61bab36865870154d1aa71cda04491911275">MED_UNDEF_DATATYPE</a>, <a class="code" href="a00577_afcd26ca66a179b9aa82f5c90602c4ed8.html#afcd26ca66a179b9aa82f5c90602c4ed8a2b1e772016688b78b808e96a44d1ee02">MED_NO_CMODE</a>,&amp;coordinatechangement,</div>
<div class="line">                                  &amp;geotransformation)) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : number of nodes ...&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    geotypes = (<a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a>)*nmodels);</div>
<div class="line">    nvaratt = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>)*nmodels);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span> (it=0; it&lt;nmodels; it++) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01058_ga6caf4937712d2a1d39ab1fd1482f61a3.html#ga6caf4937712d2a1d39ab1fd1482f61a3">MEDstructElementInfo</a>(mfid, it+1, elementname, geotypes+it, &amp;elementdim,</div>
<div class="line">                               supportmeshname, &amp;entitype, &amp;nnode, &amp;ncell,</div>
<div class="line">                               &amp;geocelltype, &amp;nconstatt, &amp;anyprofile, nvaratt+it) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : struct element models information ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * Read field values for each computing step </span></div>
<div class="line"><span class="comment">     */</span> </div>
<div class="line">    <span class="keywordflow">for</span> (csit=0; csit&lt;nstep; csit++) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01048_ga5b0031d3002518f1b2e134ff8c03dbc5.html#ga5b0031d3002518f1b2e134ff8c03dbc5">MEDfieldComputingStepInfo</a>(fid, fieldname, csit+1, &amp;numdt, &amp;numit, &amp;dt) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : Computing step info ...&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">/* </span></div>
<div class="line"><span class="comment">       * ... In our case, we suppose that the field values are only defined on struct element ... </span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keywordflow">for</span> (it=0; it&lt;nmodels; it++) {</div>
<div class="line">        geotype = *(geotypes+it);</div>
<div class="line">        </div>
<div class="line">        <span class="comment">/*</span></div>
<div class="line"><span class="comment">         * How many profile for each geometry type ? </span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">if</span> ((nprofile = <a class="code" href="a01048_gab8ce8c33cfe01cbccbde8474a4c433ba.html#gab8ce8c33cfe01cbccbde8474a4c433ba">MEDfieldnProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype,</div>
<div class="line">                                         profilename, localizationname)) &lt; 0) {</div>
<div class="line">          <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of profile &quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* </span></div>
<div class="line"><span class="comment">         * Read values for each profile</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        <span class="keywordflow">for</span> (pit=0; pit&lt;nprofile; pit++) {</div>
<div class="line">          </div>
<div class="line">          <span class="keywordflow">if</span> ((nvalues = <a class="code" href="a01048_gaa45f3d32332f8410c35c51a77ee20740.html#gaa45f3d32332f8410c35c51a77ee20740">MEDfieldnValueWithProfile</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype,</div>
<div class="line">                                                   pit+1, <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename, &amp;profilesize,</div>
<div class="line">                                                   localizationname, &amp;nintegrationpoint)) &lt; 0) {</div>
<div class="line">            <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read number of values with a profile ...&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">          } </div>
<div class="line">          </div>
<div class="line">          <span class="keywordflow">if</span> (nvalues) {</div>
<div class="line">            <span class="keywordflow">if</span> ((values = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) malloc(<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>)*nvalues*ncomponent*nintegrationpoint)) == NULL) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : memory allocation ...&quot;</span>);</div>
<div class="line">              <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="a01048_ga85cf40e4f76b7f6e6036445a6c6108b4.html#ga85cf40e4f76b7f6e6036445a6c6108b4">MEDfieldValueWithProfileRd</a>(fid, fieldname, numdt, numit, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470abdd6b14142920f599bbe4e97c4bb921e">MED_STRUCT_ELEMENT</a>, geotype,</div>
<div class="line">                                           <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>, profilename,</div>
<div class="line">                                           <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>, <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, </div>
<div class="line">                                           (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*) values) &lt; 0) {</div>
<div class="line">              <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : read fields values for cells ...&quot;</span>); </div>
<div class="line">              free(values);</div>
<div class="line">              <span class="keywordflow">return</span> -1; </div>
<div class="line">            }  </div>
<div class="line">            free(values);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    ret=0;</div>
<div class="line">  ERROR:</div>
<div class="line">    <span class="keywordflow">if</span> (nvaratt)</div>
<div class="line">      free(nvaratt);</div>
<div class="line">    <span class="keywordflow">if</span> (geotypes)</div>
<div class="line">      free(geotypes);</div>
<div class="line"></div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, mfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648aacc8c82fc9fded29cf134979f0379a06">MED_MESH_SUPPORT</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, sfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a422c5a461a7ab3dba706091e79863ea1">MED_ELSTRUCT</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01049_ga73ad912a369c3da7f22caf482093e47b.html#ga73ad912a369c3da7f22caf482093e47b">MEDfileObjectsUnmount</a>(fid, cmfid, <a class="code" href="a00577_a5e06cfaa421118c530bd15f0628dc648.html#a5e06cfaa421118c530bd15f0628dc648a741065b9e55fc3dc2ca055b74461adc9">MED_MESH</a>) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : file unmounting ...&quot;</span>);</div>
<div class="line">    ret=-1;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* close file */</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(fid) &lt; 0) {</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;ERROR : close file ...&quot;</span>);             </div>
<div class="line">    ret=-1; </div>
<div class="line">  } </div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="6."></a>Ecrire et lire un maillage ou un champ en filtrant les donn&eacute;es</h3>
<p>Dans MED, un filtre de donn&eacute;es peut &ecirc;tre utilis&eacute; pour contr&ocirc;ler un sous-ensemble d'entit&eacute;s concern&eacute;es par un appel &agrave; l'API. </p>
<p>En mode s&eacute;quentiel, la routine <a class="el" href="a01050_ga6135c77f29ccc73c1a77e2108ace9900.html#ga6135c77f29ccc73c1a77e2108ace9900">MEDfilterEntityCr</a> / <a class="el" href="a00665_aa66afba0490f4d46eb35bdca621a7a8c.html#aa66afba0490f4d46eb35bdca621a7a8c">mfrcre</a> permet de cr&eacute;er un filtre &eacute;l&eacute;mentaire en s&eacute;lectionnant les entit&eacute;s pour lesquelles on veut lire/&eacute;crire des valeurs. Cette s&eacute;lection permet une lecture/&eacute;criture avanc&eacute;e vers/depuis les emplacements m&eacute;moire s&eacute;lectionn&eacute;s. Elle s'utilise uniquement en mode s&eacute;quentiel (un seul processus).</p>
<p>Une fois cr&eacute;&eacute; un filtre peut &ecirc;tre pass&eacute; en arguments aux routines avanc&eacute;es de l'API. Ces routines ne manipuleront que les donn&eacute;es filtr&eacute;es. Ces routines avanc&eacute;es sont celles qui permettent d'&eacute;crire et lire les coordonn&eacute;es des noeuds, la connectivit&eacute; des &eacute;l&eacute;ments d'un maillage non structur&eacute;, les valeurs des champs de r&eacute;sultats : <a class="el" href="a01048_ga9e55366753425d010b8d1e95b1a53025.html#ga9e55366753425d010b8d1e95b1a53025">MEDfieldValueAdvancedWr</a> / <a class="el" href="a00618_a6af39493ffe1cdd1a2fe98c99bd685e5.html#a6af39493ffe1cdd1a2fe98c99bd685e5">mfdraw</a>, <a class="el" href="a00618_acb21099bf05bbd8e18fc3f74d0342628.html#acb21099bf05bbd8e18fc3f74d0342628">mfdiaw</a>, <a class="el" href="a01048_ga404dad06b207dace4270b18140f173e0.html#ga404dad06b207dace4270b18140f173e0">MEDfieldValueAdvancedRd</a> / <a class="el" href="a00618_ab4468903e0aad8b5dce0e88b0c350de1.html#ab4468903e0aad8b5dce0e88b0c350de1">mfdrar</a>, <a class="el" href="a00618_aa8ed6b6531344aa1e68469ba7591070f.html#aa8ed6b6531344aa1e68469ba7591070f">mfdiar</a>, <a class="el" href="a01055_gac5b9136db8c5f8a3c347eae677ad31d6.html#gac5b9136db8c5f8a3c347eae677ad31d6">MEDmeshElementConnectivityAdvancedWr</a> / <a class="el" href="a00716_ad04a514acf2f731eb17303fcc6f72a67.html#ad04a514acf2f731eb17303fcc6f72a67">mmhyaw</a>, <a class="el" href="a01055_gae9c0d58eebecdf274724ffd0d9d1bb5d.html#gae9c0d58eebecdf274724ffd0d9d1bb5d">MEDmeshElementConnectivityAdvancedRd</a> / <a class="el" href="a00716_aebb66b7b0a1f85931387438c94d45a64.html#aebb66b7b0a1f85931387438c94d45a64">mmhyar</a>, <a class="el" href="a01055_gaef211b5f4d84a8a4aae211f94034d85f.html#gaef211b5f4d84a8a4aae211f94034d85f">MEDmeshNodeCoordinateAdvancedWr</a> / <a class="el" href="a00716_ae186bc0012adc043d3244adca5b87f7a.html#ae186bc0012adc043d3244adca5b87f7a">mmhcaw</a>, <a class="el" href="a01055_gaf417124265009d6860705965fa651dfc.html#gaf417124265009d6860705965fa651dfc">MEDmeshNodeCoordinateAdvancedRd</a> / <a class="el" href="a00716_aa6f7c63cba6b1ae9eccc7600bc3c0f41.html#aa6f7c63cba6b1ae9eccc7600bc3c0f41">mmhcar</a>.</p>
<p>Il est possible d'allouer un tableau de filtre avec la routine <a class="el" href="a01050_ga47410be6d049065e980828936de3324a.html#ga47410be6d049065e980828936de3324a">MEDfilterAllocate</a> / <a class="el" href="a01065_gabc69b90f5af8c5aca1dbd4b685b5a953.html#gabc69b90f5af8c5aca1dbd4b685b5a953">mfrall</a>, puis de le d&eacute;-allouer avec la routine <a class="el" href="a01050_ga6c987c612fe52678b0c90f6d713634e7.html#ga6c987c612fe52678b0c90f6d713634e7">MEDfilterDeAllocate</a> / <a class="el" href="a01065_gad95791e5fe16d7d6c7b99ef5f39923e2.html#gad95791e5fe16d7d6c7b99ef5f39923e2">mfrdea</a>. </p>
<h3><a class="anchor" id="7."></a>Ecriture et lecture en parall&egrave;le dans un seul fichier</h3>
<p>En mode parall&egrave;le, le filtre est un moyen de d&eacute;finir le domaine concern&eacute; par chacun des processeurs. Les &eacute;critures et lectures peuvent donc se faire en parall&egrave;le entre plusieurs processeurs dans un seul et m&ecirc;me fichier MED. </p>
<p>La routine <a class="el" href="a01050_ga9ceeb4d2bf17d106d7dc41b921962ec6.html#ga9ceeb4d2bf17d106d7dc41b921962ec6">MEDfilterBlockOfEntityCr</a> / <a class="el" href="a00665_a160e0f69194873d2265bc7eed58cf74c.html#a160e0f69194873d2265bc7eed58cf74c">mfrblc</a> permet de cr&eacute;er un filtre en s&eacute;lectionnant les entit&eacute;s par blocs continus de taille constante pour lesquelles on veut lire/&eacute;crire des valeurs. Cette s&eacute;lection permet une lecture/&eacute;criture avanc&eacute;e vers/depuis les emplacements m&eacute;moire s&eacute;lectionn&eacute;s. Elle s'utilise aussi bien en mode s&eacute;quentiel qu'en mode parall&egrave;le (un ou plusieurs processus).</p>
<p>Dans ce cadre d'utilisation, le fichier doit &ecirc;tre ouvert avec la routine <a class="el" href="a01049_gad5a6655e312d3e5146f358c42c7c904f.html#gad5a6655e312d3e5146f358c42c7c904f">MEDparFileOpen</a> / mfipfo.</p>
<p>L'exemple suivant montre un cas d'utilisation en parall&egrave;le en &eacute;criture et lecture de champs de r&eacute;sultats.</p>
<div class="fragment"><div class="line"><span class="comment">/*  This file is part of MED.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  COPYRIGHT (C) 1999 - 2019  EDF R&amp;D, CEA/DEN</span></div>
<div class="line"><span class="comment"> *  MED is free software: you can redistribute it and/or modify</span></div>
<div class="line"><span class="comment"> *  it under the terms of the GNU Lesser General Public License as published by</span></div>
<div class="line"><span class="comment"> *  the Free Software Foundation, either version 3 of the License, or</span></div>
<div class="line"><span class="comment"> *  (at your option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  MED is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><span class="comment"> *  GNU Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with MED.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define MAX(a,b) ((a) &gt; (b) ? (a) : (b))</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="a00577.html">med.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#define MESGERR 1</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00591.html">med_utils.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00581.html">med_config.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#if TIME_WITH_SYS_TIME</span></div>
<div class="line"><span class="preprocessor"># include &lt;sys/time.h&gt;</span></div>
<div class="line"><span class="preprocessor"># include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor"># if HAVE_SYS_TIME_H</span></div>
<div class="line"><span class="preprocessor">#  include &lt;sys/time.h&gt;</span></div>
<div class="line"><span class="preprocessor"># else</span></div>
<div class="line"><span class="preprocessor">#  include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor"># endif</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef HAVE_UNISTD_H</span></div>
<div class="line"><span class="preprocessor">#error &quot;unistd.h required.&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00560.html">getBlocksOfEntitiesPartition.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00556.html">generateDatas.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="a00558.html">generateFilterArray.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#ifdef DEF_LECT_ECR</span></div>
<div class="line"><span class="preprocessor">#define MODE_ACCES MED_ACC_RDWR</span></div>
<div class="line"><span class="preprocessor">#elif DEF_LECT_AJOUT</span></div>
<div class="line"><span class="preprocessor">#define MODE_ACCES MED_ACC_RDEXT</span></div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">#define MODE_ACCES MED_ACC_CREAT</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*Valeur de l&#39;enum dans med.h.in*/</span></div>
<div class="line"><span class="comment">/* #define MED_NO_INTERLACE 2 */</span></div>
<div class="line"><span class="comment">/* #define MED_FULL_INTERLACE 1 */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* #ifndef USER_INTERLACE */</span></div>
<div class="line"><span class="comment">/* #define USER_INTERLACE MED_FULL_INTERLACE */</span></div>
<div class="line"><span class="comment">/* #warning &quot;Defining MED_FULL_INTERLACE mode...&quot; */</span></div>
<div class="line"><span class="comment">/* #endif */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* #if USER_INTERLACE == MED_NO_INTERLACE */</span></div>
<div class="line"><span class="comment">/* #define generateDatas generateNoIDatas */</span></div>
<div class="line"><span class="comment">/* #warning &quot;Using generateNoIDatas...&quot; */</span></div>
<div class="line"><span class="comment">/* #elif USER_INTERLACE == MED_FULL_INTERLACE */</span></div>
<div class="line"><span class="comment">/* #define generateDatas generateFullIDatas */</span></div>
<div class="line"><span class="comment">/* #warning &quot;Using generateFullIDatas...&quot; */</span></div>
<div class="line"><span class="comment">/* #else */</span></div>
<div class="line"><span class="comment">/* #error &quot;The USER_INTERLACE macro value match neither MED_NO_INTERLACE nor MED_FULL_INTERLACE&quot; */</span></div>
<div class="line"><span class="comment">/* #endif */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* #define USER_MODE MED_COMPACT */</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">  MPI_Info info;</div>
<div class="line">  MPI_Comm comm;</div>
<div class="line">  <span class="keywordtype">int</span>      mpi_size;</div>
<div class="line">  <span class="keywordtype">int</span>      mpi_rank;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>  nentitiesfiltered;</div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> *filterarray;</div>
<div class="line">} <a class="code" href="a00529.html">COM_info</a>;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><a class="code" href="a00577_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> <a class="code" href="a00554_a82ffe860a77620850697b19f9efa6964.html#a82ffe860a77620850697b19f9efa6964">generateFieldFile</a>( <span class="keyword">const</span> <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a> nentities, <span class="keyword">const</span> <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a> nvaluesperentity, <span class="keyword">const</span> <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a> nconstituentpervalue,</div>
<div class="line">                           <span class="keyword">const</span> <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37d">med_switch_mode</a> constituentmode,<a class="code" href="a00560_a0840a3697d10d765b337ab481cd77c75.html#a0840a3697d10d765b337ab481cd77c75">GetBlocksOfEntitiesType</a> getBlockOfEntities, <span class="keyword">const</span> <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a> nbblocksperproc,</div>
<div class="line">                           <a class="code" href="a00556_a5b9bda3997e43cc099fcdaaba5d688ac.html#a5b9bda3997e43cc099fcdaaba5d688ac">GenerateDataType</a> generateDatas,</div>
<div class="line">                           <span class="keyword">const</span> <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8d">med_storage_mode</a> storagemode, <span class="keyword">const</span> <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a> profilearraysize,  <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> fieldnameprefix,  <a class="code" href="a00529.html">COM_info</a> * <span class="keyword">const</span> cominfo ) {</div>
<div class="line"></div>
<div class="line"><span class="comment">/*     static int   _fileno=0; */</span></div>
<div class="line">    <a class="code" href="a00577_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a>      _ret=-1;</div>
<div class="line">    <span class="keywordtype">char</span>         _filename   [255]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">    <span class="keywordtype">char</span>         _meshname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;Empty mesh&quot;</span>;</div>
<div class="line">    <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>      _meshdim=3;</div>
<div class="line">    <span class="keywordtype">char</span>         _meshcomponentname[3*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;x               y               z               &quot;</span>;</div>
<div class="line">    <span class="keywordtype">char</span>         _meshcomponentunit[3*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1] = <span class="stringliteral">&quot;cm              cm              cm              &quot;</span>;</div>
<div class="line">    <span class="keywordtype">char</span>         _fieldname  [<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">    <span class="keywordtype">char</span>         *componentname,*componentunit;</div>
<div class="line">    <span class="keywordtype">char</span>         _profilename[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1]=<a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>;</div>
<div class="line">    <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>       *_profilearray=0;</div>
<div class="line">    <span class="keywordtype">int</span>          _i=0,_j=0,_k=0, _lastusedrank=0;</div>
<div class="line">    <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>     _blocksize=0,_lastblocksize=0,_count=0,_stride=0,_start=0,_index=0;</div>
<div class="line">    <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>    *_arrayvalues;</div>
<div class="line">    <a class="code" href="a00536.html">med_filter</a>   filter = <a class="code" href="a00577_a12fb4e45273e33fdbad01821ca0d3ea8.html#a12fb4e45273e33fdbad01821ca0d3ea8">MED_FILTER_INIT</a>;</div>
<div class="line">    <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>     _nusedentities        = nentities;</div>
<div class="line">    <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>     _io_count                = nbblocksperproc;</div>
<div class="line">    <a class="code" href="a00577_afa4ec8284026c8c5545e5333475fb65a.html#afa4ec8284026c8c5545e5333475fb65a">med_idt</a>      _fidseq,_fid;</div>
<div class="line"></div>
<div class="line">    MPI_Info info     = cominfo-&gt;<a class="code" href="a00529_a6d873d39a04ed982d89943f523c1faa9.html#a6d873d39a04ed982d89943f523c1faa9">info</a>;     </div>
<div class="line">    MPI_Comm comm     = cominfo-&gt;<a class="code" href="a00529_ab048c6f9fcbcfaa57ce68b00263dbebe.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a>;</div>
<div class="line">    <span class="keywordtype">int</span>      mpi_size = cominfo-&gt;<a class="code" href="a00529_a2f546674d230b2c614985d2bb8c4aa15.html#a2f546674d230b2c614985d2bb8c4aa15">mpi_size</a>;</div>
<div class="line">    <span class="keywordtype">int</span>      mpi_rank = cominfo-&gt;<a class="code" href="a00529_aefd71fc39dbf5bf0b8b7cb4deb5c946a.html#aefd71fc39dbf5bf0b8b7cb4deb5c946a">mpi_rank</a>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">char</span>         *_MED_MODE_SWITCH_MSG[3]={<span class="stringliteral">&quot;MED_FULL_INTERLACE&quot;</span>, <span class="stringliteral">&quot;MED_NO_INTERLACE&quot;</span>,<span class="stringliteral">&quot;MED_UNDEF_INTERLACE&quot;</span>,};</div>
<div class="line">    <span class="keywordtype">char</span>         *_MED_STORAGE_MODE_MSG[3]={<span class="stringliteral">&quot;MED_NO_STMODE&quot;</span>,<span class="stringliteral">&quot;MED_GLOBAL_STMODE&quot;</span>, <span class="stringliteral">&quot;MED_COMPACT_STMODE&quot;</span>};</div>
<div class="line"></div>
<div class="line">    <a class="code" href="a00577_a1043613afc3cd2e24785dfc7c0452ab8.html#a1043613afc3cd2e24785dfc7c0452ab8">med_geometry_type</a>     _geotype       = <a class="code" href="a00577_a85970ad0ffaf58419c2afa36e43b1ea3.html#a85970ad0ffaf58419c2afa36e43b1ea3">MED_TRIA6</a>;</div>
<div class="line">    <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>               _geodim        = _geotype/100;</div>
<div class="line">    <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>               _geonnodes     = _geotype%100;</div>
<div class="line">    <span class="keywordtype">char</span>       _ipointname[<a class="code" href="a00577_a0ae989cbbfeecbb5296b3ceba8dab886.html#a0ae989cbbfeecbb5296b3ceba8dab886">MED_NAME_SIZE</a>+1];</div>
<div class="line">    <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>* _ipointrefcoo = 0;</div>
<div class="line">    <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>    _ipoint       = nvaluesperentity;</div>
<div class="line">    <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>* _ipointcoo    = 0;</div>
<div class="line">    <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>* _ipointwg     = 0;</div>
<div class="line"></div>
<div class="line">    sprintf(_filename,<span class="stringliteral">&quot;%s_CPU-%03d_@_%s_%s.med&quot;</span>,fieldnameprefix,mpi_size,_MED_MODE_SWITCH_MSG[constituentmode],_MED_STORAGE_MODE_MSG[storagemode]);</div>
<div class="line"><span class="comment">/*     SSCRUTE(_filename); */</span></div>
<div class="line">    <span class="comment">/* Ouverture du fichier en mode parallel */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((_fid = <a class="code" href="a01049_gad5a6655e312d3e5146f358c42c7c904f.html#gad5a6655e312d3e5146f358c42c7c904f">MEDparFileOpen</a>(_filename, <a class="code" href="a00853_a29a43500a889d39744e184ece0d749be.html#a29a43500a889d39744e184ece0d749be">MODE_ACCES</a> ,comm, info)) &lt; 0){</div>
<div class="line">      <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a0bbda4699e6c5e9a9c3189b702e6f6e6.html#a0bbda4699e6c5e9a9c3189b702e6f6e6">MED_ERR_OPEN</a>,<a class="code" href="a00582_a768428f78b9f7416a35939e54404fca7.html#a768428f78b9f7416a35939e54404fca7">MED_ERR_FILE</a>,_filename);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"><span class="comment">/*     SSCRUTE(_meshname); */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="a01055_ga6007c3f1a62732e7a46c5eca232be78a.html#ga6007c3f1a62732e7a46c5eca232be78a">MEDmeshCr</a>( _fid,_meshname,_meshdim,_meshdim, <a class="code" href="a00577_a821a4dd94c5c6b095318432bdec8d8a1.html#a821a4dd94c5c6b095318432bdec8d8a1a3719e53a4838d222f0a58148292fda41">MED_UNSTRUCTURED_MESH</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;Un maillage pour le test parallel&quot;</span>,<span class="stringliteral">&quot;s&quot;</span>, <a class="code" href="a00577_a5b97067a30629cd60470d074691d6798.html#a5b97067a30629cd60470d074691d6798ae896b6adfbde9870b4e875e5167eddd0">MED_SORT_DTIT</a>,</div>
<div class="line">                   <a class="code" href="a00577_a57867e4bed1d104c865cfc9d23c9204d.html#a57867e4bed1d104c865cfc9d23c9204da682ef7f1042079519664eae87f90297e">MED_CARTESIAN</a>, _meshcomponentname, _meshcomponentunit) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a92354d1153d9e053407f2f8c0dedbda7.html#a92354d1153d9e053407f2f8c0dedbda7">MED_ERR_CREATE</a>,<a class="code" href="a00582_a8767f86ed60bd189b0e714b775846f24.html#a8767f86ed60bd189b0e714b775846f24">MED_ERR_MESH</a>,_meshname);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    componentname = (<span class="keywordtype">char</span>*) malloc((nconstituentpervalue*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)*<span class="keyword">sizeof</span>(char));</div>
<div class="line">    componentunit = (<span class="keywordtype">char</span>*) malloc((nconstituentpervalue*<a class="code" href="a00577_a213ecd1a546eb96092b980a870bc386b.html#a213ecd1a546eb96092b980a870bc386b">MED_SNAME_SIZE</a>+1)*<span class="keyword">sizeof</span>(char));</div>
<div class="line">    <span class="comment">/*TODO : Compléter le nom */</span></div>
<div class="line">    strcpy(componentname,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">    strcpy(componentunit,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">    strcpy(_fieldname,fieldnameprefix);</div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01048_ga8f73c6eb1a1b85f5e1e8bc1823c01ab9.html#ga8f73c6eb1a1b85f5e1e8bc1823c01ab9">MEDfieldCr</a>(_fid,_fieldname,<a class="code" href="a00577_a5615eeaf85e0b3f40b74bdd24178f2cd.html#a5615eeaf85e0b3f40b74bdd24178f2cdad44e111629f7a5811626b87c8b42b3ea">MED_FLOAT64</a>,nconstituentpervalue,componentname,componentunit,<span class="stringliteral">&quot;s&quot;</span>,_meshname ) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a92354d1153d9e053407f2f8c0dedbda7.html#a92354d1153d9e053407f2f8c0dedbda7">MED_ERR_CREATE</a>,<a class="code" href="a00582_a56c28cd068a46a59d0692b642a560324.html#a56c28cd068a46a59d0692b642a560324">MED_ERR_FIELD</a>,_fieldname);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    };</div>
<div class="line">    free(componentname);</div>
<div class="line">    free(componentunit);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ( _ipoint &gt; 1 ) {</div>
<div class="line"></div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Creating a localization of integration points...&quot;</span>);</div>
<div class="line">      strcpy(_ipointname,_fieldname);</div>
<div class="line">      strcat(_ipointname,<span class="stringliteral">&quot;_loc&quot;</span>);</div>
<div class="line"></div>
<div class="line">      <span class="comment">/*Attention ancienne spec*/</span></div>
<div class="line">      _ipointrefcoo = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) calloc(_geodim*_geonnodes,<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>));</div>
<div class="line">      _ipointcoo    = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) calloc(_ipoint*_geodim,<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>));</div>
<div class="line">      _ipointwg     = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a> *) calloc(_ipoint,<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>));</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="a01054_ga77e9d9cfe12058f20762fe61fbf14172.html#ga77e9d9cfe12058f20762fe61fbf14172">MEDlocalizationWr</a>(_fid, _ipointname, _geotype, _geotype/100, _ipointrefcoo, constituentmode,</div>
<div class="line">                            _ipoint, _ipointcoo, _ipointwg, <a class="code" href="a00577_a3e7915fabbbc5946451ebbb836ca0816.html#a3e7915fabbbc5946451ebbb836ca0816">MED_NO_INTERPOLATION</a>, <a class="code" href="a00577_aeb44e16b6ecf0f5f8aeefab3e60a1a2c.html#aeb44e16b6ecf0f5f8aeefab3e60a1a2c">MED_NO_MESH_SUPPORT</a> ) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a92354d1153d9e053407f2f8c0dedbda7.html#a92354d1153d9e053407f2f8c0dedbda7">MED_ERR_CREATE</a>,<a class="code" href="a00582_ada54cea0286293e0c155a0dc7e006c4e.html#ada54cea0286293e0c155a0dc7e006c4e">MED_ERR_LOCALIZATION</a>,_ipointname);</div>
<div class="line">        <a class="code" href="a00591_ae7ba0433e91c450cd44c3808c2acb497.html#ae7ba0433e91c450cd44c3808c2acb497">ISCRUTE_int</a>(constituentmode);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line">      free(_ipointrefcoo );</div>
<div class="line">      free(_ipointcoo    );</div>
<div class="line">      free(_ipointwg     );</div>
<div class="line"></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      strcpy(_ipointname,<a class="code" href="a00577_a2acd5f0b336ddb4026fe1dd314fbd1e0.html#a2acd5f0b336ddb4026fe1dd314fbd1e0">MED_NO_LOCALIZATION</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (profilearraysize) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Creating a profile...&quot;</span>);</div>
<div class="line"></div>
<div class="line">      strcpy(_profilename,_fieldname);strcat(_profilename,<span class="stringliteral">&quot;_profile&quot;</span>);</div>
<div class="line"></div>
<div class="line">      _profilearray = (<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>*) calloc(profilearraysize,<span class="keyword">sizeof</span>(<a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>));</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">for</span> (_i=0; _i &lt; profilearraysize; ++_i) _profilearray[_i]=_i;</div>
<div class="line">      <span class="keywordflow">if</span> ( <a class="code" href="a01057_gaf7ec6ed01898dcfe98556f399ed044d1.html#gaf7ec6ed01898dcfe98556f399ed044d1">MEDprofileWr</a>(_fid,_profilename,profilearraysize,_profilearray) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a92354d1153d9e053407f2f8c0dedbda7.html#a92354d1153d9e053407f2f8c0dedbda7">MED_ERR_CREATE</a>,<a class="code" href="a00582_a422b2f1b0d06225813610e0527ab871e.html#a422b2f1b0d06225813610e0527ab871e">MED_ERR_PROFILE</a>,_profilename);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      };</div>
<div class="line">      _nusedentities = profilearraysize;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      strcpy(_profilename,<a class="code" href="a00577_aaa89a5e5e6d32de69614b70cf74e29cc.html#aaa89a5e5e6d32de69614b70cf74e29cc">MED_NO_PROFILE</a>);</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Generating partition...&quot;</span>);</div>
<div class="line">    getBlockOfEntities ( mpi_rank , mpi_size, _nusedentities,</div>
<div class="line">                         &amp;_start, &amp;_stride, &amp;_io_count, &amp;_blocksize,</div>
<div class="line">                         &amp;_lastusedrank, &amp;_lastblocksize);</div>
<div class="line"></div>
<div class="line">    _count=_io_count;</div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Generating filter...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01050_ga9ceeb4d2bf17d106d7dc41b921962ec6.html#ga9ceeb4d2bf17d106d7dc41b921962ec6">MEDfilterBlockOfEntityCr</a>(_fid, nentities, nvaluesperentity, nconstituentpervalue,</div>
<div class="line">                                  <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, constituentmode, storagemode, _profilename,</div>
<div class="line">                                  _start,_stride,_count,_blocksize,_lastblocksize,  &amp;filter) &lt; 0 ) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a92354d1153d9e053407f2f8c0dedbda7.html#a92354d1153d9e053407f2f8c0dedbda7">MED_ERR_CREATE</a>,<a class="code" href="a00582_a2a30a97f3fd5a2961e657aeb19cccfb1.html#a2a30a97f3fd5a2961e657aeb19cccfb1">MED_ERR_FILTER</a>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Generating datas...&quot;</span>);</div>
<div class="line">    generateDatas(mpi_rank, _lastusedrank, <span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>),</div>
<div class="line">                  storagemode, profilearraysize, _profilearray,</div>
<div class="line">                  _start, _stride, _count, _blocksize, _lastblocksize,</div>
<div class="line">                  nentities, nvaluesperentity, nconstituentpervalue,</div>
<div class="line">                  &amp;_arrayvalues );</div>
<div class="line"></div>
<div class="line">    <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Writing field...&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> ( <a class="code" href="a01048_ga9e55366753425d010b8d1e95b1a53025.html#ga9e55366753425d010b8d1e95b1a53025">MEDfieldValueAdvancedWr</a>(_fid,_fieldname,<a class="code" href="a00577_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00577_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>,0.0, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, _geotype,</div>
<div class="line">                                 _ipointname, &amp;filter, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)_arrayvalues ) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_ada9ad358d137c53e288ff59d49e45541.html#ada9ad358d137c53e288ff59d49e45541">MED_ERR_WRITE</a>,<a class="code" href="a00582_a56c28cd068a46a59d0692b642a560324.html#a56c28cd068a46a59d0692b642a560324">MED_ERR_FIELD</a>,_fieldname);</div>
<div class="line">      <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(mpi_rank);</div>
<div class="line">      <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Test de lecture du même fichier avec filtre simple par un seul processeur */</span></div>
<div class="line">    <span class="comment">/* TODO : Créer MEDflush */</span></div>
<div class="line">    H5Fflush(_fid, H5F_SCOPE_GLOBAL );</div>
<div class="line"></div>
<div class="line">    <span class="comment">/*Le flush suffit pas besoin de synchroniser les processus : MPI_Barrier(MPI_COMM_WORLD); */</span></div>
<div class="line">    <span class="keywordflow">if</span> (mpi_rank == 0 ) {</div>
<div class="line">      <a class="code" href="a00591_a3756046b0a6a7e51b8eb544d0d77c17c.html#a3756046b0a6a7e51b8eb544d0d77c17c">MESSAGE</a>(<span class="stringliteral">&quot;Reading field...&quot;</span>);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">      <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>    _nentitiesarrayvalues=0;</div>
<div class="line">      <a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>  *_filteredarrayvalues=NULL;</div>
<div class="line">      <a class="code" href="a00536.html">med_filter</a> filter2=<a class="code" href="a00577_a12fb4e45273e33fdbad01821ca0d3ea8.html#a12fb4e45273e33fdbad01821ca0d3ea8">MED_FILTER_INIT</a>;</div>
<div class="line">      <span class="keywordtype">int</span>        _ind=0;</div>
<div class="line">      FILE *     _asciifile;</div>
<div class="line">      <span class="keywordtype">char</span>       _asciifilename[255]=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> ((_fidseq = <a class="code" href="a01049_ga9376a1654b7bf099c3f8941074c5fdfb.html#ga9376a1654b7bf099c3f8941074c5fdfb">MEDfileOpen</a>(_filename, <a class="code" href="a00577_adcd0322de9fec3b5e199ffeda3f44c85.html#adcd0322de9fec3b5e199ffeda3f44c85a616bf8345c622a34f0787f42eb400f25">MED_ACC_RDONLY</a> )) &lt; 0){</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a0bbda4699e6c5e9a9c3189b702e6f6e6.html#a0bbda4699e6c5e9a9c3189b702e6f6e6">MED_ERR_OPEN</a>,<a class="code" href="a00582_a768428f78b9f7416a35939e54404fca7.html#a768428f78b9f7416a35939e54404fca7">MED_ERR_FILE</a>,_filename);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      sprintf(_asciifilename,<span class="stringliteral">&quot;%s_CPU-%03d_@_%s_%s.ascii&quot;</span>,fieldnameprefix,mpi_size,_MED_MODE_SWITCH_MSG[constituentmode],_MED_STORAGE_MODE_MSG[storagemode]);</div>
<div class="line">      _asciifile=fopen(_asciifilename, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"></div>
<div class="line">      <span class="comment">/*Génère un filtre de selection simple s&#39;il n&#39;a pas déjà été généré lors d&#39;un précédent appel */</span></div>
<div class="line">      <span class="comment">/*TODO : Déplacer cette appel dans le main après avoir externaliser la génération du profile */</span></div>
<div class="line">      <span class="keywordflow">if</span> (!(cominfo-&gt;<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a>))</div>
<div class="line">        <span class="keywordflow">if</span> ( <a class="code" href="a00557_a388c7cc13e2d139b5518828c5979b041.html#a388c7cc13e2d139b5518828c5979b041">generateFilterArray</a>(  nentities,  nvaluesperentity, nconstituentpervalue,</div>
<div class="line">                                   profilearraysize, _profilearray,</div>
<div class="line">                                   &amp;(cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>), &amp;(cominfo-&gt;<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a>) ) &lt; 0 ) {</div>
<div class="line">          <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">      <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>);</div>
<div class="line">      <span class="comment">/*Stocke le filtre utilisé dans le fichier .ascii*/</span></div>
<div class="line">      <span class="keywordflow">for</span> (_i=0; _i &lt; cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>; ++_i ) {</div>
<div class="line"><span class="comment">/*      ISCRUTE(cominfo-&gt;filterarray[_i]); */</span></div>
<div class="line">        fprintf(_asciifile,<span class="stringliteral">&quot;%d &quot;</span>,cominfo-&gt;<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a>[_i]) ;</div>
<div class="line">      }</div>
<div class="line">      fprintf(_asciifile,<span class="stringliteral">&quot;\n&quot;</span>) ;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">      <span class="comment">/*Pas de profile possible (profilearraysize == 0) en MED_GLOBAL_STMODE sur un fichier géré en parallel */</span></div>
<div class="line">      <span class="keywordflow">if</span> ( profilearraysize ) {</div>
<div class="line">        _nentitiesarrayvalues = profilearraysize;</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        _nentitiesarrayvalues = nentities;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">/*Attention allocation mémoire potentiellement grosse car réalisée uniquement par le processus 0</span></div>
<div class="line"><span class="comment">       qui rassemble les données.*/</span></div>
<div class="line">      <span class="comment">/* C&#39;est une taille maxi qui ne prend pas en compte le COMPACT+filter */</span></div>
<div class="line">      <span class="comment">/* TODO : Ajuster la taille au storage_mode*/</span></div>
<div class="line">      _filteredarrayvalues = (<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>*) malloc(_nentitiesarrayvalues*</div>
<div class="line">                                                 nvaluesperentity*</div>
<div class="line">                                                 nconstituentpervalue*<span class="keyword">sizeof</span>(<a class="code" href="a00577_ab1eab99ca56ac95ce5b1c0e4ae0f095a.html#ab1eab99ca56ac95ce5b1c0e4ae0f095a">med_float</a>));</div>
<div class="line"></div>
<div class="line">      <span class="comment">/* Permet de vérifier une erreur d&#39;indiçage après la lecture */</span></div>
<div class="line">      <span class="keywordflow">for</span> (_i=0;_i&lt;_nentitiesarrayvalues*nvaluesperentity*nconstituentpervalue; ++_i)</div>
<div class="line">        _filteredarrayvalues[_i]=-_i;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">      <span class="comment">/*Création d&#39;un filtre de sélection simple, pour une lecture séquentielle par le processys 0*/</span></div>
<div class="line">      <span class="keywordflow">if</span> ( <a class="code" href="a01050_ga6135c77f29ccc73c1a77e2108ace9900.html#ga6135c77f29ccc73c1a77e2108ace9900">MEDfilterEntityCr</a>(_fidseq, nentities, nvaluesperentity, nconstituentpervalue,</div>
<div class="line">                             <a class="code" href="a00577_a65a18ab6db672a2d21312d1813a3bb19.html#a65a18ab6db672a2d21312d1813a3bb19">MED_ALL_CONSTITUENT</a>, constituentmode, storagemode, _profilename,</div>
<div class="line">                             cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>,cominfo-&gt;<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a>, &amp;filter2) &lt; 0 ) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a92354d1153d9e053407f2f8c0dedbda7.html#a92354d1153d9e053407f2f8c0dedbda7">MED_ERR_CREATE</a>,<a class="code" href="a00582_a2a30a97f3fd5a2961e657aeb19cccfb1.html#a2a30a97f3fd5a2961e657aeb19cccfb1">MED_ERR_FILTER</a>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> ( <a class="code" href="a01048_ga404dad06b207dace4270b18140f173e0.html#ga404dad06b207dace4270b18140f173e0">MEDfieldValueAdvancedRd</a>(_fidseq,_fieldname,<a class="code" href="a00577_a8f72b6ceb3b6f5a67f9efd46cb90707a.html#a8f72b6ceb3b6f5a67f9efd46cb90707a">MED_NO_DT</a>,<a class="code" href="a00577_a95919207fd7a18ba26e6e03f04811e3f.html#a95919207fd7a18ba26e6e03f04811e3f">MED_NO_IT</a>, <a class="code" href="a00577_aab0e957294723517d5c3641bb71b0470.html#aab0e957294723517d5c3641bb71b0470a227d14957ec5f221685cb1d6ec3b6c67">MED_CELL</a>, _geotype,</div>
<div class="line">                                   &amp;filter2, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)_filteredarrayvalues ) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_ac3d72eee2022402ffdc5851d2dc98584.html#ac3d72eee2022402ffdc5851d2dc98584">MED_ERR_READ</a>,<a class="code" href="a00582_a56c28cd068a46a59d0692b642a560324.html#a56c28cd068a46a59d0692b642a560324">MED_ERR_FIELD</a>,_fieldname);</div>
<div class="line">        <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(mpi_rank);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">      <span class="comment">/*AFFICHAGE TOUJOURS EN FULL INTERLACE QUELQUES SOIENT LES COMBINAISONS*/</span></div>
<div class="line">      <span class="comment">/*TODO : Externaliser l&#39;affichage*/</span></div>
<div class="line">      <span class="keywordflow">if</span> ( storagemode == <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a> ) {</div>
<div class="line">        <span class="keywordflow">switch</span> (constituentmode) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>:</div>
<div class="line">          <span class="keywordflow">for</span> (_i=0; _i &lt; cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>; ++_i)</div>
<div class="line">            <span class="keywordflow">for</span> (_j=0; _j &lt; nvaluesperentity; ++_j)</div>
<div class="line">              <span class="keywordflow">for</span> (_k=0; _k &lt; nconstituentpervalue; ++_k) {</div>
<div class="line">                _ind = (cominfo-&gt;<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a>[_i]-1)*nvaluesperentity*nconstituentpervalue+ _j*nconstituentpervalue+_k;</div>
<div class="line"><span class="comment">/*              fprintf(stdout,&quot;%s%3d%s = %f\n&quot;,&quot;_filteredarrayvaluesFULLGLB[&quot;,_ind,&quot;]&quot;,_filteredarrayvalues[_ind]) ; */</span></div>
<div class="line">                fprintf(_asciifile,<span class="stringliteral">&quot;%f\n&quot;</span>,_filteredarrayvalues[_ind]) ;</div>
<div class="line">              }</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da5c7f85d1c271fe5dbaf9e9f1d3211fea">MED_NO_INTERLACE</a>:</div>
<div class="line">          <span class="keywordflow">for</span> (_j=0; _j &lt; cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>; ++_j)</div>
<div class="line">            <span class="keywordflow">for</span> (_k=0; _k &lt; nvaluesperentity; ++_k)</div>
<div class="line">              <span class="keywordflow">for</span> (_i=0; _i &lt; nconstituentpervalue; ++_i) {</div>
<div class="line">                _ind =_i*nentities*nvaluesperentity+ (cominfo-&gt;<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a>[_j]-1)*nvaluesperentity +_k;</div>
<div class="line"><span class="comment">/*              fprintf(stdout,&quot;%s%3d%s = %f\n&quot;,&quot;_filteredarrayvaluesNOGLB[&quot;,_ind,&quot;]&quot;,_filteredarrayvalues[_ind]); */</span></div>
<div class="line">                fprintf(_asciifile,<span class="stringliteral">&quot;%f\n&quot;</span>,_filteredarrayvalues[_ind]);</div>
<div class="line">              }</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      }  <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">switch</span> (constituentmode) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a>:</div>
<div class="line">          <span class="keywordflow">for</span> (_i=0; _i &lt; cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>; ++_i )</div>
<div class="line">            <span class="keywordflow">for</span> (_j=0; _j &lt; nvaluesperentity; ++_j)</div>
<div class="line">              <span class="keywordflow">for</span> (_k=0; _k &lt; nconstituentpervalue; ++_k) {</div>
<div class="line">                _ind = _i*nvaluesperentity*nconstituentpervalue+_j*nconstituentpervalue+_k;</div>
<div class="line"><span class="comment">/*              fprintf(stdout,&quot;%s%3d%s = %f\n&quot;,&quot;_filteredarrayvaluesFULLCP[&quot;,_ind,&quot;]&quot;,_filteredarrayvalues[_ind]) ; */</span></div>
<div class="line">                fprintf(_asciifile,<span class="stringliteral">&quot;%f\n&quot;</span>,_filteredarrayvalues[_ind]) ;</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da5c7f85d1c271fe5dbaf9e9f1d3211fea">MED_NO_INTERLACE</a>:</div>
<div class="line">          <span class="keywordflow">for</span> (_j=0; _j &lt; cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>; ++_j)</div>
<div class="line">            <span class="keywordflow">for</span> (_k=0; _k &lt; nvaluesperentity; ++_k)</div>
<div class="line">              <span class="keywordflow">for</span> (_i=0; _i &lt; nconstituentpervalue; ++_i) {</div>
<div class="line">                _ind =_i*cominfo-&gt;<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>*nvaluesperentity+ _j*nvaluesperentity +_k;</div>
<div class="line">                <span class="comment">/* _ind =_i*_nentitiesarrayvalues*nvaluesperentity+ (_filterarray[_j]-1)*nvaluesperentity +_k; */</span></div>
<div class="line"><span class="comment">/*              fprintf(stdout,&quot;%s%3d%s = %f\n&quot;,&quot;_filteredarrayvaluesNOCP[&quot;,_ind,&quot;]&quot;,_filteredarrayvalues[_ind]); */</span></div>
<div class="line">                fprintf(_asciifile,<span class="stringliteral">&quot;%f\n&quot;</span>,_filteredarrayvalues[_ind]);</div>
<div class="line">              }</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">      free(_filteredarrayvalues);</div>
<div class="line"></div>
<div class="line">      fclose(_asciifile);</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> ( <a class="code" href="a01050_ga5e48f17469f18350f3dd1d9bee49e1fb.html#ga5e48f17469f18350f3dd1d9bee49e1fb">MEDfilterClose</a>(&amp;filter2) &lt; 0 ) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a444c5e2cb5b9f60b769909297300ac14.html#a444c5e2cb5b9f60b769909297300ac14">MED_ERR_CLOSE</a>,<a class="code" href="a00582_a2a30a97f3fd5a2961e657aeb19cccfb1.html#a2a30a97f3fd5a2961e657aeb19cccfb1">MED_ERR_FILTER</a>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">    } <span class="comment">/*fin if (mpi_rank == 0) */</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( <a class="code" href="a01050_ga5e48f17469f18350f3dd1d9bee49e1fb.html#ga5e48f17469f18350f3dd1d9bee49e1fb">MEDfilterClose</a>(&amp;filter) &lt; 0 ) {</div>
<div class="line">    <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a444c5e2cb5b9f60b769909297300ac14.html#a444c5e2cb5b9f60b769909297300ac14">MED_ERR_CLOSE</a>,<a class="code" href="a00582_a2a30a97f3fd5a2961e657aeb19cccfb1.html#a2a30a97f3fd5a2961e657aeb19cccfb1">MED_ERR_FILTER</a>,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">    <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    _ret=0;</div>
<div class="line">  ERROR:</div>
<div class="line">    <span class="keywordflow">if</span> (_arrayvalues)     free(_arrayvalues);</div>
<div class="line">    <span class="keywordflow">if</span> (profilearraysize) free(_profilearray);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (  <a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(_fid) &lt; 0) {</div>
<div class="line">      <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a444c5e2cb5b9f60b769909297300ac14.html#a444c5e2cb5b9f60b769909297300ac14">MED_ERR_CLOSE</a>,<a class="code" href="a00582_a768428f78b9f7416a35939e54404fca7.html#a768428f78b9f7416a35939e54404fca7">MED_ERR_FILE</a>,<span class="stringliteral">&quot;&quot;</span>); _ret = -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (mpi_rank == 0 ) {</div>
<div class="line">      <span class="keywordflow">if</span> (  <a class="code" href="a01049_ga12a0e901c376be997a41a073ce426283.html#ga12a0e901c376be997a41a073ce426283">MEDfileClose</a>(_fidseq) &lt; 0) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_a444c5e2cb5b9f60b769909297300ac14.html#a444c5e2cb5b9f60b769909297300ac14">MED_ERR_CLOSE</a>,<a class="code" href="a00582_a768428f78b9f7416a35939e54404fca7.html#a768428f78b9f7416a35939e54404fca7">MED_ERR_FILE</a>,<span class="stringliteral">&quot;&quot;</span>); _ret = -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> _ret;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="a00853_a3c04138a5bfe5d72780bb7e82a18e627.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="a00577_abd29d7c6abaef5da2a5ed1b73464f0ba.html#abd29d7c6abaef5da2a5ed1b73464f0ba">med_err</a> _ret=0;</div>
<div class="line">  <a class="code" href="a00529.html">COM_info</a> _cominfo;</div>
<div class="line">  _cominfo.<a class="code" href="a00529_ab048c6f9fcbcfaa57ce68b00263dbebe.html#ab048c6f9fcbcfaa57ce68b00263dbebe">comm</a> = MPI_COMM_WORLD;</div>
<div class="line">  _cominfo.<a class="code" href="a00529_a6d873d39a04ed982d89943f523c1faa9.html#a6d873d39a04ed982d89943f523c1faa9">info</a> = MPI_INFO_NULL;</div>
<div class="line">  _cominfo.<a class="code" href="a00529_a8392201586c9264367c7faf9f60486e1.html#a8392201586c9264367c7faf9f60486e1">nentitiesfiltered</a>=0;</div>
<div class="line">  _cominfo.<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a>      =NULL;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  MPI_Init(&amp;argc, &amp;argv);</div>
<div class="line">  MPI_Comm_size(MPI_COMM_WORLD, &amp;(_cominfo.<a class="code" href="a00529_a2f546674d230b2c614985d2bb8c4aa15.html#a2f546674d230b2c614985d2bb8c4aa15">mpi_size</a>));</div>
<div class="line">  MPI_Comm_rank(MPI_COMM_WORLD, &amp;(_cominfo.<a class="code" href="a00529_aefd71fc39dbf5bf0b8b7cb4deb5c946a.html#aefd71fc39dbf5bf0b8b7cb4deb5c946a">mpi_rank</a>));</div>
<div class="line"></div>
<div class="line">  <a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>      _nbblocksperproc       = 0;</div>
<div class="line">  <span class="keywordtype">int</span>           _nentities             = 0;</div>
<div class="line">  <span class="keywordtype">int</span>           _nvaluesperentity      = 0;</div>
<div class="line">  <span class="keywordtype">int</span>           _nconstituentpervalue  = 0;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> (_cominfo.<a class="code" href="a00529_aefd71fc39dbf5bf0b8b7cb4deb5c946a.html#aefd71fc39dbf5bf0b8b7cb4deb5c946a">mpi_rank</a> == 0 ) {</div>
<div class="line"></div>
<div class="line">    <span class="keyword">struct </span>tm *_tm ;</div>
<div class="line">    time_t _tt=time(0);</div>
<div class="line">    _tm = localtime(&amp;_tt);</div>
<div class="line"></div>
<div class="line">    srandom((*_tm).tm_sec * (*_tm).tm_min );</div>
<div class="line">    _nbblocksperproc      = 1 + (int) (_cominfo.<a class="code" href="a00529_a2f546674d230b2c614985d2bb8c4aa15.html#a2f546674d230b2c614985d2bb8c4aa15">mpi_size</a> * (random() / (RAND_MAX + 1.0)));</div>
<div class="line">    _nentities            = 1 + (int) (1000.0 * (random() / (RAND_MAX + 1.0)));</div>
<div class="line">    _nvaluesperentity     = 1 + (int) (11.0 * (random() / (RAND_MAX + 1.0)));</div>
<div class="line">    _nconstituentpervalue = 1 + (int) (7.0 * (random() / (RAND_MAX + 1.0)));</div>
<div class="line"><span class="comment">/*     _nbblocksperproc         = 1 + (int) (mpi_size * (random() / (RAND_MAX + 1.0))); */</span></div>
<div class="line"><span class="comment">/*     _nentities            = 1 + (int) (5.0 * (random() / (RAND_MAX + 1.0))); */</span></div>
<div class="line"><span class="comment">/*     _nvaluesperentity     = 1 + (int) (3.0 * (random() / (RAND_MAX + 1.0))); */</span></div>
<div class="line"><span class="comment">/*     _nconstituentpervalue = 1 + (int) (3.0 * (random() / (RAND_MAX + 1.0))); */</span></div>
<div class="line"><span class="comment">/*     _nbblocksperproc         = 2; */</span></div>
<div class="line"><span class="comment">/*     _nentities            = 4; */</span></div>
<div class="line"><span class="comment">/*     _nvaluesperentity     = 1; */</span></div>
<div class="line"><span class="comment">/*     _nconstituentpervalue = 1; */</span></div>
<div class="line"></div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( (<span class="keyword">sizeof</span>(<a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>)%(<span class="keyword">sizeof</span>(MPI_LONG)))==0 ) {</div>
<div class="line"></div>
<div class="line">    MPI_Bcast(&amp;_nbblocksperproc      , <span class="keyword">sizeof</span>(<a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>)/<span class="keyword">sizeof</span>(MPI_LONG), MPI_LONG, 0, MPI_COMM_WORLD);</div>
<div class="line">    MPI_Bcast(&amp;_nentities            , <span class="keyword">sizeof</span>(<a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>)/<span class="keyword">sizeof</span>(MPI_LONG), MPI_LONG, 0, MPI_COMM_WORLD);</div>
<div class="line">    MPI_Bcast(&amp;_nvaluesperentity     , <span class="keyword">sizeof</span>(<a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>)/<span class="keyword">sizeof</span>(MPI_LONG), MPI_LONG, 0, MPI_COMM_WORLD);</div>
<div class="line">    MPI_Bcast(&amp;_nconstituentpervalue , <span class="keyword">sizeof</span>(<a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>)/<span class="keyword">sizeof</span>(MPI_LONG), MPI_LONG, 0, MPI_COMM_WORLD);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    assert(<span class="keyword">sizeof</span>(<a class="code" href="a00577_abc4b2f6b68a545b7b3441b0d3d860629.html#abc4b2f6b68a545b7b3441b0d3d860629">med_size</a>) == (<span class="keyword">sizeof</span>(MPI_LONG)));</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">char</span>                _fieldnameprefix[256] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"></div>
<div class="line">  sprintf(_fieldnameprefix,<span class="stringliteral">&quot;NENT-%03d_NVAL-%03d_NCST-%03d_NBL-%03llu&quot;</span>,_nentities,_nvaluesperentity,</div>
<div class="line">          _nconstituentpervalue,_nbblocksperproc);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="a00556_a5b9bda3997e43cc099fcdaaba5d688ac.html#a5b9bda3997e43cc099fcdaaba5d688ac">GenerateDataType</a> generateDatas = 0;</div>
<div class="line">  <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37d">med_switch_mode</a>  _switchmode  = <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da8c2ff3c323a55ab7c52781f9ca5b9fb4">MED_UNDEF_INTERLACE</a>;</div>
<div class="line">  <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8d">med_storage_mode</a> _storagemode = <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da15a2a29e37e912bca05ed6f60170767c">MED_UNDEF_STMODE</a>;</div>
<div class="line">  <span class="comment">/*Pour que les 4 fichiers générés soient identiques, on désactive l&#39;utilisation des profils</span></div>
<div class="line"><span class="comment">    qui n&#39;est pas utilisable en mode GLOBAL+// */</span></div>
<div class="line">  <a class="code" href="a00577_a88dc15143f934cc7b771bc89f46372dc.html#a88dc15143f934cc7b771bc89f46372dc">med_int</a>          _profilearraysize=0;</div>
<div class="line">  <span class="comment">/* med_int       _profilearraysize=_nentities/2; */</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span> (_switchmode = <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a> ; _switchmode &lt;= <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da5c7f85d1c271fe5dbaf9e9f1d3211fea">MED_NO_INTERLACE</a>; ++_switchmode) {</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> ( _switchmode == <a class="code" href="a00577_a0d451e4036adbb12b14cb16d7db0c37d.html#a0d451e4036adbb12b14cb16d7db0c37da9a1509b3f93e5915a24f555890c73ee1">MED_FULL_INTERLACE</a> ) generateDatas = <a class="code" href="a00555_aacb98bb0155d664e9d8a9626b9144bc3.html#aacb98bb0155d664e9d8a9626b9144bc3">generateFullIDatas</a>;</div>
<div class="line">    <span class="keywordflow">else</span> generateDatas = <a class="code" href="a00555_aa5abc2daa1769bad363d8d7d935a3249.html#aa5abc2daa1769bad363d8d7d935a3249">generateNoIDatas</a>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (_storagemode = <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a> ; _storagemode &lt;= <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8dae0059ae013bcbd618f9d688a4f15354c">MED_COMPACT_STMODE</a>; ++_storagemode) {</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> ( (_storagemode == <a class="code" href="a00577_a3f7b3a3c5ddcaba3fa1741a367503c8d.html#a3f7b3a3c5ddcaba3fa1741a367503c8da75948cc18980c808e34f1c8177207197">MED_GLOBAL_STMODE</a> ) &amp;&amp; (_profilearraysize) ) _profilearraysize=0;</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span> ( <a class="code" href="a00554_a82ffe860a77620850697b19f9efa6964.html#a82ffe860a77620850697b19f9efa6964">generateFieldFile</a>( _nentities,  _nvaluesperentity, _nconstituentpervalue,</div>
<div class="line">                              _switchmode, <a class="code" href="a00559_a9a1191a9ceaa2926cc07e5cdd38339cb.html#a9a1191a9ceaa2926cc07e5cdd38339cb">getCyclicBlocksOfEntities</a>, _nbblocksperproc, generateDatas,</div>
<div class="line">                              _storagemode, _profilearraysize,  _fieldnameprefix, &amp; _cominfo) &lt; 0 ) {</div>
<div class="line">        <a class="code" href="a00591_a07852156956867e0134fc219d370b8d4.html#a07852156956867e0134fc219d370b8d4">MED_ERR_</a>(_ret,<a class="code" href="a00582_ada9ad358d137c53e288ff59d49e45541.html#ada9ad358d137c53e288ff59d49e45541">MED_ERR_WRITE</a>,<a class="code" href="a00582_a56c28cd068a46a59d0692b642a560324.html#a56c28cd068a46a59d0692b642a560324">MED_ERR_FIELD</a>,_fieldnameprefix);</div>
<div class="line">        <a class="code" href="a00591_a818470a84d2ad18a3fbb48170296cd95.html#a818470a84d2ad18a3fbb48170296cd95">ISCRUTE</a>(_cominfo.<a class="code" href="a00529_aefd71fc39dbf5bf0b8b7cb4deb5c946a.html#aefd71fc39dbf5bf0b8b7cb4deb5c946a">mpi_rank</a>);</div>
<div class="line">        <span class="keywordflow">goto</span> ERROR;</div>
<div class="line">      }</div>
<div class="line"></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  _ret = 0;</div>
<div class="line"> ERROR:</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span> ( _cominfo.<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a> = NULL ) free( _cominfo.<a class="code" href="a00529_ac5b2f698a79a32693bd35d6eb02b29d8.html#ac5b2f698a79a32693bd35d6eb02b29d8">filterarray</a> );</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*pour arch. BLueGene : Sync entre GPFS et LSF : sleep(360) */</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/* MPI_Finalize must be called AFTER MEDclose which may use MPI calls */</span></div>
<div class="line">  MPI_Finalize();</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Catcher l&#39;erreur en retour mpirun  et .sh*/</span></div>
<div class="line">  <span class="keywordflow">return</span> _ret;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
</div><!-- fragment --><p><br />
<br />
 </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré le Lundi 10 Décembre 2018 18:40:48 pour MED fichier par &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
